I"§A<h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p>Exchange ActiveSyncæ˜¯ä¸€ç§Microsoft ExchangeåŒæ­¥åè®®ï¼Œç”¨äºåœ¨é‚®ä»¶æœåŠ¡å™¨å’Œç§»åŠ¨è®¾å¤‡ä¹‹é—´åŒæ­¥é‚®ä»¶èµ„æºã€‚</p>

<p>Adam Rutherfordå’ŒDavid Chismonåœ¨ä»–ä»¬çš„æ–‡ç« ä¸­ä»‹ç»äº†é€šè¿‡Exchange ActiveSyncè®¿é—®å†…éƒ¨æ–‡ä»¶å…±äº«çš„æ–¹æ³•</p>

<p>æ–‡ç« åœ°å€ï¼š</p>

<p>https://labs.f-secure.com/archive/accessing-internal-fileshares-through-exchange-activesync/</p>

<p>æœ¬æ–‡å°†è¦åŸºäºä»–ä»¬çš„ç ”ç©¶ï¼Œä»‹ç»é€šè¿‡Exchange ActiveSyncè®¿é—®å†…éƒ¨æ–‡ä»¶å…±äº«çš„ç»†èŠ‚ï¼Œè®°å½•ç ”ç©¶å¿ƒå¾—ã€‚</p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<p>æœ¬æ–‡å°†è¦ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>é€šè¿‡Exchange ActiveSyncéªŒè¯ç”¨æˆ·é‚®ç®±å£ä»¤</li>
  <li>Exchange ActiveSyncå¼€æºä»£ç æµ‹è¯•</li>
  <li>é€šè¿‡Exchange ActiveSyncè®¿é—®å†…éƒ¨æ–‡ä»¶å…±äº«çš„ç»†èŠ‚</li>
  <li>é˜²å¾¡æ£€æµ‹</li>
</ul>

<h2 id="0x02-åŸºç¡€çŸ¥è¯†">0x02 åŸºç¡€çŸ¥è¯†</h2>
<hr />

<p>Exchange ActiveSyncæ˜¯ä¸€ç§Microsoft ExchangeåŒæ­¥åè®®ï¼Œè¯¥åè®®ç»è¿‡ä¼˜åŒ–ï¼Œä»¥é€‚ç”¨äºé«˜å»¶è¿Ÿå’Œä½å®½å¸¦ç½‘ç»œã€‚</p>

<p>è¯¥åè®®åŸºäºHTTPå’ŒXMLï¼Œä½¿ç§»åŠ¨è®¾å¤‡å¯ä»¥è®¿é—®å…¶ç”µå­é‚®ä»¶ã€æ—¥å†ã€è”ç³»äººå’Œä»»åŠ¡ï¼Œå¹¶ä¸”åœ¨è„±æœºå·¥ä½œæ—¶ä»å¯ä»¥ç»§ç»­è®¿é—®è¿™äº›ä¿¡æ¯ã€‚</p>

<p>ç®€å•ç†è§£ï¼Œè®¡ç®—æœºç”¨æˆ·é€šè¿‡owa(Outlook Web Access)è®¿é—®é‚®ä»¶èµ„æºï¼Œæ‰‹æœºç”¨æˆ·é€šè¿‡eas(Exchange ActiveSync)è®¿é—®é‚®ä»¶èµ„æº</p>

<h2 id="0x03-é€šè¿‡exchange-activesyncéªŒè¯ç”¨æˆ·é‚®ç®±å£ä»¤">0x03 é€šè¿‡Exchange ActiveSyncéªŒè¯ç”¨æˆ·é‚®ç®±å£ä»¤</h2>
<hr />

<p>é»˜è®¤å¯¹åº”çš„URLï¼š<code class="language-plaintext highlighter-rouge">/Microsoft-Server-ActiveSync</code></p>

<p>å¯ä»¥ç›´æ¥é€šè¿‡æµè§ˆå™¨è¿›è¡Œè®¿é—®ï¼Œæç¤ºè¾“å…¥ç”¨æˆ·åå’Œå£ä»¤</p>

<p>è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå£ä»¤åï¼Œè¿”å›å†…å®¹å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-6-18/2-1.png" alt="Alt text" /></p>

<p>å¦‚æœæ²¡æœ‰å‡­æ®ï¼Œå¯ç›´æ¥é€šè¿‡wgetå‘½ä»¤è·å¾—æœåŠ¡å™¨ä¿¡æ¯ï¼Œå‘½ä»¤å®ä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://192.168.1.1/Microsoft-Server-ActiveSync --no-check-certificate --debug
</code></pre></div></div>

<p>è¿”å›ç»“æœå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-6-18/2-2.png" alt="Alt text" /></p>

<p>ä¸ºäº†èƒ½å¤Ÿé€šè¿‡è„šæœ¬å®ç°å£ä»¤éªŒè¯ï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨OPTIONSæ–¹æ³•ï¼Œå¦‚æœå‡­æ®æœ‰æ•ˆï¼Œè¿”å›çŠ¶æ€ç 200</p>

<p>headeréƒ¨åˆ†åŠ å…¥HTTPåŸºæœ¬è®¤è¯(Basic Authentication)ï¼Œæ ¼å¼ä¸º<code class="language-plaintext highlighter-rouge">Authorization: Basic &lt;string&gt;</code></p>

<p><code class="language-plaintext highlighter-rouge">&lt;string&gt;</code>ä¸º<code class="language-plaintext highlighter-rouge">"username:password"</code> ç”¨base64ç¼–ç åçš„å­—ç¬¦ä¸²</p>

<p>Pythonå®ç°çš„å®Œæ•´ä»£ç å·²ä¸Šä¼ è‡³githubï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/3gstudent/Homework-of-Python/blob/master/easCheck.py</p>

<h2 id="0x04-exchange-activesyncå¼€æºä»£ç æµ‹è¯•">0x04 Exchange ActiveSyncå¼€æºä»£ç æµ‹è¯•</h2>
<hr />

<h3 id="1httpsgithubcomsolbirnpyactivesync">1.https://github.com/solbirn/pyActiveSync</h3>

<p>éœ€è¦ä½¿ç”¨Python2</p>

<p>ä¸ºäº†èƒ½å¤Ÿæ­£å¸¸æµ‹è¯•ï¼Œè¿˜éœ€è¦å¦‚ä¸‹è®¾ç½®ï¼š</p>

<p>(1)åŒçº§ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶proto_creds.py</p>

<p>å†…å®¹å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>as_server='192.168.1.1'
as_user='user1'
as_pass='password1'
</code></pre></div></div>

<p>(2)å–æ¶ˆå¯¹SSLè¯ä¹¦çš„éªŒè¯</p>

<p>ä¿®æ”¹<code class="language-plaintext highlighter-rouge">pyActiveSync\objects\MSASHTTP.py</code></p>

<p>æ·»åŠ å¼•ç”¨<code class="language-plaintext highlighter-rouge">import ssl</code></p>

<p>å°†<code class="language-plaintext highlighter-rouge">httplib.HTTPSConnection(self.server, self.port)</code>
æ›¿æ¢ä¸º<code class="language-plaintext highlighter-rouge">httplib.HTTPSConnection(self.server, self.port, context=ssl._create_unverified_context())</code></p>

<p>(3)ä¿®æ”¹pyActiveSync/dev_playground.py</p>

<p>å»æ‰â€Suggested Contactsâ€ç›¸å…³ä»£ç </p>

<p>åˆ†åˆ«è¿è¡Œ<code class="language-plaintext highlighter-rouge">dev_playground.py</code>å’Œ<code class="language-plaintext highlighter-rouge">misc_tests.py</code>ï¼Œå¯¹åº”ä¸åŒçš„åŠŸèƒ½</p>

<h3 id="2httpsgithubcomfsecurelabspeas">2.https://github.com/FSecureLABS/peas</h3>

<p>éœ€è¦ä½¿ç”¨Python2</p>

<p>åŸºäº<a href="https://github.com/solbirn/pyActiveSync">pyActiveSync</a>ï¼Œæ·»åŠ äº†å¯¼å‡ºé‚®ä»¶å’Œè®¿é—®å…±äº«æ–‡ä»¶çš„åŠŸèƒ½</p>

<p>å¸¸ç”¨åŠŸèƒ½å¦‚ä¸‹ï¼š</p>

<p>(1)éªŒè¯å‡­æ®</p>

<p>ä»£ç ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import peas
# Create an instance of the PEAS client.
client = peas.Peas()
# Disable certificate verification so self-signed certificates don't cause errors.
client.disable_certificate_verification()
# Set the credentials and server to connect to.
client.set_creds({
    'server': '192.168.1.1',
    'user': 'test1',
    'password': '123456789',
})

# Check the credentials are accepted.
print("Auth result:", client.check_auth())
</code></pre></div></div>

<p>(2)è¯»å–é‚®ä»¶</p>

<p>è¯»å–æ”¶ä»¶ç®±é‚®ä»¶çš„ä»£ç ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import peas
import re
# Create an instance of the PEAS client.
client = peas.Peas()
# Disable certificate verification so self-signed certificates don't cause errors.
client.disable_certificate_verification()
# Set the credentials and server to connect to.
client.set_creds({
    'server': '192.168.1.1',
    'user': 'test1',
    'password': '123456789',
})
# Retrieve emails.
emails = client.extract_emails()
for email in emails :
    print("\r\n")  
    pattern_data = re.compile(r"&lt;email:To&gt;(.*?)&lt;/email:To&gt;")
    data = pattern_data.findall(email)
    print("To:"+data[0])
    pattern_data = re.compile(r"&lt;email:From&gt;(.*?)&lt;/email:From&gt;")
    data = pattern_data.findall(email)
    print("From:"+data[0])
    pattern_data = re.compile(r"&lt;email:Subject&gt;(.*?)&lt;/email:Subject&gt;")
    data = pattern_data.findall(email)
    print("Subject:"+data[0])
    pattern_data = re.compile(r"&lt;email:DateReceived&gt;(.*?)&lt;/email:DateReceived&gt;")
    data = pattern_data.findall(email)
    print("DateReceived:"+data[0])
    pattern_data = re.compile(r"&lt;email:DisplayTo&gt;(.*?)&lt;/email:DisplayTo&gt;")
    data = pattern_data.findall(email)
    print("DisplayTo:"+data[0])
    pattern_data = re.compile(r"&lt;email:ThreadTopic&gt;(.*?)&lt;/email:ThreadTopic&gt;")
    data = pattern_data.findall(email)
    print("ThreadTopic:"+data[0])
    pattern_data = re.compile(r"&lt;email:Importance&gt;(.*?)&lt;/email:Importance&gt;")
    data = pattern_data.findall(email)
    print("Importance:"+data[0])
    pattern_data = re.compile(r"&lt;email:Read&gt;(.*?)&lt;/email:Read&gt;")
    data = pattern_data.findall(email)
    print("Read:"+data[0])
    pattern_data = re.compile(r"&lt;airsyncbase:DisplayName&gt;(.*?)&lt;/airsyncbase:DisplayName&gt;")
    
    data = pattern_data.findall(email)
    for name in data :
        print("Attachment:"+name)
  
    pattern_data = re.compile(r"&lt;email2:ConversationIndex&gt;(.*?)&lt;/email2:ConversationIndex&gt;")
    data = pattern_data.findall(email)
    print("ConversationIndex:"+data[0])

    index1 = email.find('&lt;html&gt;')
    index2 = email.find('&lt;/html&gt;')
    filename = data[0] + ".html"
    print('[+] Save body to %s'%(filename))
    with open(filename, 'w+') as file_object:
            file_object.write(email[index1:index2+7]) 
</code></pre></div></div>

<p>è¿™é‡Œéœ€è¦æ³¨æ„è¿”å›çš„é‚®ä»¶å†…å®¹ä¸­ï¼Œé‚®ä»¶æ­£æ–‡éƒ¨åˆ†çš„æ ¼å¼ä¸ºhtmlï¼Œæˆ‘çš„ä»£ç å®ç°äº†å°†æ­£æ–‡éƒ¨åˆ†æå–å¹¶ä¿å­˜æˆhtmlæ ¼å¼ï¼Œä»¥å”¯ä¸€çš„<code class="language-plaintext highlighter-rouge">ConversationIndex</code>ä½œä¸ºæ–‡ä»¶å</p>

<p>å¦‚æœæƒ³è¦è·å¾—å‘ä»¶ç®±çš„é‚®ä»¶ä¿¡æ¯ï¼Œéœ€è¦ä¿®æ”¹<code class="language-plaintext highlighter-rouge">py_activesync_helper.py</code>ï¼Œä¿®æ”¹çš„ç»†èŠ‚å¯å‚è€ƒhttps://github.com/solbirn/pyActiveSync/blob/master/pyActiveSync/dev_playground.py#L150</p>

<p>(3)è®¿é—®æ–‡ä»¶å…±äº«</p>

<p>åˆ—å‡ºå…±äº«æ–‡ä»¶çš„ä»£ç ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import peas
# Create an instance of the PEAS client.
client = peas.Peas()
# Disable certificate verification so self-signed certificates don't cause errors.
client.disable_certificate_verification()
# Set the credentials and server to connect to.
client.set_creds({
    'server': '192.168.1.1',
    'user': 'test1',
    'password': '123456789',
})
# Retrieve a file share directory listing.
listing = client.get_unc_listing(r'\\dc1\SYSVOL')
for data in listing :
   print("\r\n")
   for key,value in data.items():
      print('{key}:{value}'.format(key = key, value = value))
</code></pre></div></div>

<p>è¯»å–æŒ‡å®šå…±äº«æ–‡ä»¶å†…å®¹çš„ä»£ç ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import peas
# Create an instance of the PEAS client.
client = peas.Peas()
# Disable certificate verification so self-signed certificates don't cause errors.
client.disable_certificate_verification()
# Set the credentials and server to connect to.
client.set_creds({
    'server': '192.168.1.1',
    'user': 'test1',
    'password': '123456789',
})

data=client.get_unc_file(r'\\dc1\SYSVOL\test.com\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\GPT.INI')
print(data)
</code></pre></div></div>

<h2 id="0x05-é€šè¿‡exchange-activesyncè®¿é—®å†…éƒ¨æ–‡ä»¶å…±äº«çš„ç»†èŠ‚">0x05 é€šè¿‡Exchange ActiveSyncè®¿é—®å†…éƒ¨æ–‡ä»¶å…±äº«çš„ç»†èŠ‚</h2>
<hr />

<h3 id="1åˆ—å‡ºå…±äº«æ–‡ä»¶">1.åˆ—å‡ºå…±äº«æ–‡ä»¶</h3>

<p>è®¿é—®çš„URLç¤ºä¾‹ï¼š</p>

<p>https://192.168.1.1/Microsoft-Server-ActiveSync?Cmd=Search&amp;User=test1&amp;DeviceId=123456&amp;DeviceType=Pythonâ€</p>

<p>å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š</p>

<ul>
  <li>Cmd=Searchï¼Œè¡¨ç¤ºå‘½ä»¤ç±»å‹ä¸º<code class="language-plaintext highlighter-rouge">Search</code></li>
  <li>User=test1ï¼Œè¡¨ç¤ºç”¨æˆ·åä¸º<code class="language-plaintext highlighter-rouge">test1</code></li>
  <li>DeviceId=123456ï¼Œè¡¨ç¤ºè®¾å¤‡IDï¼Œä¼šè¢«Exchange ActiveSyncè®°å½•</li>
  <li>DeviceType=Pythonï¼Œè¡¨ç¤ºè®¾å¤‡ç±»å‹ï¼Œä¼šè¢«Exchange ActiveSyncè®°å½•</li>
</ul>

<p>æ–¹æ³•ä¸ºPOSTè¯·æ±‚</p>

<p>headerå†…å®¹ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"Content-Type": "application/vnd.ms-sync.wbxml",
"User-Agent" : ,
"MS-ASProtocolVersion" : "14.1",
"Accept-Language" : "en_us",
"Authorization: Basic dXNlcjElM0FwYXNzd29yZDE="
</code></pre></div></div>

<p>bodyå†…å®¹ç¤ºä¾‹ï¼š</p>

<p>éœ€è¦å°†xmlæ ¼å¼è½¬æ¢ä¸ºWAP Binary XML(WBXML)</p>

<p>xmlæ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;?xml version="1.0" encoding="utf-8"?&gt;
 &lt;Search xmlns="Search:" xmlns:documentlibrary="DocumentLibrary:"&gt;
   &lt;Store&gt;
     &lt;Name&gt;DocumentLibrary&lt;/Name&gt;
     &lt;Query&gt;
       &lt;EqualTo&gt;
         &lt;documentlibrary:LinkId/&gt;
         &lt;Value&gt;\\myserver\myshare&lt;/Value&gt;
       &lt;/EqualTo&gt;
     &lt;/Query&gt;
     &lt;Options&gt;
       &lt;Range&gt;0-999&lt;/Range&gt;
     &lt;/Options&gt;
   &lt;/Store&gt;
 &lt;/Search&gt;
</code></pre></div></div>

<p>xmlæ ¼å¼å‚è€ƒï¼š</p>

<p>https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-asdoc/f8a23578-0ca4-4b36-aa07-3dcac5b83881</p>

<p>WAP Binary XML(WBXML)ç®—æ³•å¯å‚è€ƒï¼š</p>

<p>https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-aswbxml/39973eb1-1e40-4eb5-ac74-42781c5a33bc</p>

<h3 id="2è¯»å–æŒ‡å®šå…±äº«æ–‡ä»¶å†…å®¹">2.è¯»å–æŒ‡å®šå…±äº«æ–‡ä»¶å†…å®¹</h3>

<p>è®¿é—®çš„URLç¤ºä¾‹ï¼šhttps://192.168.1.1/Microsoft-Server-ActiveSync?Cmd=ItemOperations&amp;User=test1&amp;DeviceId=123456&amp;DeviceType=Pythonâ€</p>

<p>å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š</p>

<ul>
  <li>Cmd=ItemOperationsï¼Œè¡¨ç¤ºå‘½ä»¤ç±»å‹ä¸º<code class="language-plaintext highlighter-rouge">ItemOperations</code></li>
  <li>User=test1ï¼Œè¡¨ç¤ºç”¨æˆ·åä¸º<code class="language-plaintext highlighter-rouge">test1</code></li>
  <li>DeviceId=123456ï¼Œè¡¨ç¤ºè®¾å¤‡IDï¼Œä¼šè¢«Exchange ActiveSyncè®°å½•</li>
  <li>DeviceType=Pythonï¼Œè¡¨ç¤ºè®¾å¤‡ç±»å‹ï¼Œä¼šè¢«Exchange ActiveSyncè®°å½•</li>
</ul>

<p>æ–¹æ³•ä¸ºPOSTè¯·æ±‚</p>

<p>headerå†…å®¹ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"Content-Type": "application/vnd.ms-sync.wbxml",
"User-Agent" : ,
"MS-ASProtocolVersion" : "14.1",
"Accept-Language" : "en_us",
"Authorization: Basic dXNlcjElM0FwYXNzd29yZDE="
</code></pre></div></div>

<p>bodyå†…å®¹ç¤ºä¾‹ï¼š</p>

<p>éœ€è¦å°†xmlæ ¼å¼è½¬æ¢ä¸ºWAP Binary XML (WBXML)</p>

<p>xmlæ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
 &lt;ItemOperations xmlns:documentlibrary="DocumentLibrary:" xmlns="ItemOperations:"&gt;
   &lt;Fetch&gt;
       &lt;Store&gt;DocumentLibrary&lt;/Store&gt;
       &lt;documentlibrary:LinkId&gt;\\EXCH-D-810\DocumentShare\Word Document.docx&lt;/documentlibrary:LinkId&gt;
   &lt;/Fetch&gt;
 &lt;/ItemOperations&gt;
</code></pre></div></div>

<p>xmlæ ¼å¼å‚è€ƒï¼š</p>

<p>https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-asdoc/e7a91040-42f1-475c-bac3-d83d7dd9652f</p>

<p>æˆ‘åŸºäº<a href="https://github.com/FSecureLABS/peas">peas</a>çš„ä»£ç ï¼Œæå–å‡ºè®¿é—®å…±äº«æ–‡ä»¶çš„åŠŸèƒ½ï¼Œç”Ÿæˆäº†ä¸€ä¸ªå…å®‰è£…çš„ç‰ˆæœ¬ï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/3gstudent/easBrowseSharefile</p>

<p>ä»£ç æ”¯æŒä¸¤ä¸ªåŠŸèƒ½:</p>

<ol>
  <li>åˆ—å‡ºå…±äº«æ–‡ä»¶</li>
  <li>è¯»å–æŒ‡å®šå…±äº«æ–‡ä»¶å†…å®¹</li>
</ol>

<p><strong>æ³¨ï¼š</strong></p>

<p>è®¿é—®åŸŸå†…å…±äº«ç›®å½•SYSVOLæ—¶ï¼Œè·¯å¾„è¦åŠ ä¸ŠåŸŸæ§åˆ¶å™¨çš„è®¡ç®—æœºåï¼Œè€Œä¸æ˜¯åŸŸå</p>

<p>æ­£ç¡®çš„å†™æ³•ï¼š</p>

<p><code class="language-plaintext highlighter-rouge">\\dc1\SYSVOL\test.com\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\GPT.INI</code></p>

<p>é”™è¯¯çš„å†™æ³•ï¼š</p>

<p><code class="language-plaintext highlighter-rouge">\\test.com\SYSVOL\test.com\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\GPT.INI</code></p>

<p>å¦‚æœæŒæ¡äº†åŸŸæ§åˆ¶å™¨çš„è®¡ç®—æœºåï¼Œå¯ä»¥é€šè¿‡Exchange ActiveSyncä»å¤–ç½‘è®¿é—®åŸŸå†…å…±äº«ç›®å½•SYSVOLä¸­çš„æ–‡ä»¶</p>

<h2 id="0x06-é˜²å¾¡æ£€æµ‹">0x06 é˜²å¾¡æ£€æµ‹</h2>
<hr />

<p>é€šè¿‡Exchange ActiveSyncè¯»å–é‚®ä»¶å’Œè®¿é—®å…±äº«ç›®å½•ä¼šç•™ä¸‹è®¾å¤‡ä¿¡æ¯ï¼Œè®¾å¤‡ä¿¡æ¯å¯¹åº”çš„ä»£ç ä½ç½®ï¼š</p>

<p>https://github.com/FSecureLABS/peas/blob/master/peas/pyActiveSync/objects/MSASHTTP.py#L25</p>

<p>æŸ¥çœ‹è®¾å¤‡ä¿¡æ¯çš„ä¸¤ä¸ªæ–¹æ³•</p>

<p>1.ç™»å½•Exchange Admin Center</p>

<p>é€‰æ‹©é‚®ç®±ç”¨æˆ·-&gt;<code class="language-plaintext highlighter-rouge">Mobile Devices</code>ä¸‹çš„<code class="language-plaintext highlighter-rouge">View details </code>ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-6-18/3-1.png" alt="Alt text" /></p>

<p>2.ä½¿ç”¨Exchange Management Shell</p>

<p>å‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-ActiveSyncDevice|fl UserDisplayName,DeviceId,DeviceType,DeviceUserAgent
</code></pre></div></div>

<p>é€šè¿‡Exchange ActiveSyncè®¿é—®å…±äº«æ–‡ä»¶çš„æ—¥å¿—ä½ç½®ï¼š</p>

<p><code class="language-plaintext highlighter-rouge">%ExchangeInstallPath%Logging\HttpProxy\Eas</code></p>

<p>å…³é—­é€šè¿‡Exchange ActiveSyncè®¿é—®å…±äº«æ–‡ä»¶çš„æ–¹æ³•ï¼š</p>

<p>ä½¿ç”¨Exchange Management Shellï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Set-MobileDeviceMailboxPolicy -Identity:Default -UNCAccessEnabled:$false -WSSAccessEnabled:$false 
</code></pre></div></div>

<p>å‚è€ƒèµ„æ–™ï¼š</p>

<p>https://docs.microsoft.com/en-us/powershell/module/exchange/set-mobiledevicemailboxpolicy?view=exchange-ps</p>

<p>æŸ¥çœ‹é…ç½®çš„å‘½ä»¤ï¼š<code class="language-plaintext highlighter-rouge">Get-MobileDeviceMailboxPolicy |fl</code></p>

<h2 id="0x07-å°ç»“">0x07 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡ä»‹ç»äº†é€šè¿‡Exchange ActiveSyncè®¿é—®å†…éƒ¨æ–‡ä»¶å…±äº«çš„ç»†èŠ‚ï¼ŒåŸºäº<a href="https://github.com/FSecureLABS/peas">peas</a>çš„ä»£ç ï¼Œæå–å‡ºè®¿é—®å…±äº«æ–‡ä»¶çš„åŠŸèƒ½ï¼Œç”Ÿæˆäº†ä¸€ä¸ªå…å®‰è£…çš„ç‰ˆæœ¬ï¼Œç»“åˆåˆ©ç”¨æ€è·¯ç»™å‡ºé˜²å¾¡å»ºè®®ã€‚</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET