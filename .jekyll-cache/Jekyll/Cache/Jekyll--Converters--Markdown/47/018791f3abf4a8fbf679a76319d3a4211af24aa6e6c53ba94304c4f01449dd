I"’7<h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p>Covenantæ˜¯ä¸€ä¸ª.NETå¼€å‘çš„C2(command and control)æ¡†æ¶ï¼Œä½¿ç”¨.NET Coreçš„å¼€å‘ç¯å¢ƒï¼Œä¸ä»…æ”¯æŒLinuxï¼ŒMacOSå’ŒWindowsï¼Œè¿˜æ”¯æŒdockerå®¹å™¨ã€‚</p>

<p>æœ€ç‰¹åˆ«çš„åœ°æ–¹æ˜¯æ”¯æŒåŠ¨æ€ç¼–è¯‘ï¼Œèƒ½å¤Ÿå°†è¾“å…¥çš„C#ä»£ç ä¸Šä¼ è‡³C2 Serverï¼Œè·å¾—ç¼–è¯‘åçš„æ–‡ä»¶å¹¶ä½¿ç”¨Assembly.Load()ä»å†…å­˜è¿›è¡ŒåŠ è½½ã€‚</p>

<p>æœ¬æ–‡ä»…åœ¨æŠ€æœ¯ç ”ç©¶çš„è§’åº¦ï¼Œä»‹ç»Covenantçš„ç»†èŠ‚ï¼Œåˆ†æç‰¹ç‚¹ã€‚</p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<p>æœ¬æ–‡å°†è¦ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>Covenantçš„å¯åŠ¨æ–¹æ³•</li>
  <li>Covenantçš„åŠŸèƒ½ä»‹ç»</li>
  <li>Covenantçš„ä¼˜ç‚¹</li>
  <li>Covenantçš„æ£€æµ‹</li>
</ul>

<h2 id="0x02-covenantçš„å¯åŠ¨æ–¹æ³•">0x02 Covenantçš„å¯åŠ¨æ–¹æ³•</h2>
<hr />

<h3 id="1windowsç³»ç»Ÿ">1.Windowsç³»ç»Ÿ</h3>

<p>éœ€è¦è£…å¯¹åº”ç‰ˆæœ¬çš„.NET Coreã€ASP.NET Coreå’ŒSDK</p>

<p>ç»æµ‹è¯•ï¼ŒCovenantéœ€è¦.NET Core 2.2.0ã€ASP.NET Core 2.2.0å’ŒSDK 2.2.101ï¼Œå…¶ä»–ç‰ˆæœ¬ä¼šæŠ¥é”™</p>

<p>ä¸‹è½½åœ°å€ï¼š</p>

<p>https://dotnet.microsoft.com/download/thank-you/dotnet-sdk-2.2.101-windows-x64-installer</p>

<p>https://dotnet.microsoft.com/download/thank-you/dotnet-runtime-2.2.0-windows-x64-installer</p>

<p>https://dotnet.microsoft.com/download/thank-you/dotnet-runtime-2.2.0-windows-x64-asp.net-core-runtime-installer</p>

<p>å®‰è£…Git for Windows</p>

<p>https://github.com/git-for-windows/git/releases/download/v2.23.0.windows.1/Git-2.23.0-64-bit.exe</p>

<p>ä¸‹è½½å¹¶å¯åŠ¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone --recurse-submodules https://github.com/cobbr/Covenant
cd Covenant/Covenant
dotnet build
dotnet run
</code></pre></div></div>

<p>è®¿é—®https://localhost:7443è¿›å…¥æ§åˆ¶é¢æ¿ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶éœ€è¦æ³¨å†Œç”¨æˆ·</p>

<p>è¿™é‡Œå¯ä»¥æ³¨å†Œå¤šä¸ªç”¨æˆ·ï¼Œå®ç°å›¢é˜Ÿåä½œ</p>

<p><strong>æ³¨ï¼š</strong></p>

<p>Eliteæ˜¯ä¸CovenantæœåŠ¡å™¨è¿›è¡Œäº¤äº’çš„å‘½ä»¤è¡Œç¨‹åºï¼Œç›®å‰å·²ç»ä¸´æ—¶å¼ƒç”¨ï¼Œåœ°å€ï¼š</p>

<p>https://github.com/cobbr/Elite</p>

<h2 id="0x03-covenantçš„åŠŸèƒ½ä»‹ç»">0x03 Covenantçš„åŠŸèƒ½ä»‹ç»</h2>
<hr />

<p>Covenantæ”¯æŒçš„åŠŸèƒ½å¯å‚è€ƒï¼š</p>

<p>https://github.com/cobbr/Covenant/wiki</p>

<p>è¿™é‡Œåªä»‹ç»ä¸ªäººè®¤ä¸ºæ¯”è¾ƒé‡è¦çš„éƒ¨åˆ†</p>

<h3 id="1listeners">1.Listeners</h3>

<p>åªæ”¯æŒHTTPåè®®ï¼Œå¯ä»¥æŒ‡å®šurlå’Œé€šä¿¡æ¶ˆæ¯çš„æ ¼å¼</p>

<p>é€‰æ‹©<code class="language-plaintext highlighter-rouge">Listeners</code>-&gt;<code class="language-plaintext highlighter-rouge">Profiles</code>ï¼Œé»˜è®¤åŒ…æ‹¬ä¸¤ä¸ªé…ç½®æ¨¡æ¿ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-11-1/2-1.png" alt="Alt text" /></p>

<p>é…ç½®æ¨¡æ¿ä¸­å¯ä»¥è®¾ç½®å¤šä¸ªHttpUrlsï¼ŒGruntåœ¨å›è¿çš„æ—¶å€™ä¼šä»HttpUrlsä¸­éšæœºé€‰æ‹©</p>

<p><strong>æ³¨ï¼š</strong></p>

<p>Gruntç”¨ä½œéƒ¨ç½²åˆ°ç›®æ ‡ï¼Œä½œä¸ºè¢«æ§åˆ¶ç«¯</p>

<p>HttpRequestå’ŒHttpResponseçš„å†…å®¹éƒ½å¯ä»¥æŒ‡å®š</p>

<p>é…ç½®æ¨¡æ¿å¯¹åº”æºç æ–‡ä»¶çš„ä½ç½®ï¼š <code class="language-plaintext highlighter-rouge">.\Covenant\Covenant\Data\Profiles</code></p>

<h3 id="2launchers">2.Launchers</h3>

<p>ç”¨äºå¯åŠ¨Gruntï¼ŒåŒ…æ‹¬ä»¥ä¸‹9ç§å¯åŠ¨æ–¹å¼:</p>

<h4 id="1binary">(1)Binary</h4>

<p>.NETç¨‹åºé›†ï¼Œæ ¼å¼ä¸ºexeæ–‡ä»¶</p>

<h4 id="2powershell">(2)PowerShell</h4>

<p>å‘½ä»¤è¡Œä¸‹é€šè¿‡Powershellå¯åŠ¨Grunt</p>

<p>å°†.NETç¨‹åºé›†ä¿å­˜åœ¨æ•°ç»„ï¼Œé€šè¿‡Assembly.Load()åœ¨å†…å­˜è¿›è¡ŒåŠ è½½</p>

<p>ä»£ç ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Reflection.Assembly]::Load(Data).EntryPoint.Invoke(0,$a.ToArray())
</code></pre></div></div>

<h4 id="3msbuild">(3)MSBuild</h4>

<p>å‘½ä»¤è¡Œä¸‹é€šè¿‡msbuildå¯åŠ¨Grunt</p>

<p>å¯åŠ¨å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.exe GruntStager.xml
</code></pre></div></div>

<p>å°†.NETç¨‹åºé›†ä¿å­˜åœ¨æ•°ç»„ï¼Œé€šè¿‡Assembly.Load()åœ¨å†…å­˜è¿›è¡ŒåŠ è½½</p>

<p>ä»£ç ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>System.Reflection.Assembly.Load(oms.ToArray()).EntryPoint.Invoke(0, new object[] { new string[]{ } });
</code></pre></div></div>

<p>å…³äºmsbuildçš„ç”¨æ³•å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/Use-MSBuild-To-Do-More">ã€ŠUse MSBuild To Do Moreã€‹</a></p>

<h4 id="4installutil">(4)InstallUtil</h4>

<p>å‘½ä»¤è¡Œä¸‹é€šè¿‡InstallUtilå¯åŠ¨Grunt</p>

<p><strong>æ³¨ï¼š</strong></p>

<p>æˆ‘åœ¨æµ‹è¯•çš„æ—¶å€™è¿™é‡Œäº§ç”Ÿäº†bugï¼Œç”Ÿæˆçš„æ–‡ä»¶åç§°ä¸º<code class="language-plaintext highlighter-rouge">GruntStager.xml</code>ï¼Œé‡Œé¢ä¿å­˜äº†base64åŠ å¯†çš„.NETç¨‹åºé›†</p>

<p>æŒ‰ç…§æˆ‘ç†è§£çš„InstallUtilçš„ç”¨æ³•ï¼Œè¿™é‡Œåº”è¯¥ç”Ÿæˆä¸€ä¸ª.csæ–‡ä»¶</p>

<p>æŸ¥çœ‹Covenantçš„æºç ï¼Œç”Ÿæˆæ¨¡æ¿çš„æºç ä½ç½®ï¼š<code class="language-plaintext highlighter-rouge">.\Covenant\Covenant\Models\Launchers\InstallUtilLauncher.cs</code></p>

<p>å¯¹åº”çš„é“¾æ¥ï¼š</p>

<p>https://github.com/cobbr/Covenant/blob/master/Covenant/Models/Launchers/InstallUtilLauncher.cs</p>

<p>æ¨¡æ¿ä¸­åŒ…æ‹¬.csæ–‡ä»¶çš„å†…å®¹ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-11-1/2-2.png" alt="Alt text" /></p>

<p>è¿™é‡Œå¯ä»¥å°†<code class="language-plaintext highlighter-rouge">CodeTemplate</code>çš„å†…å®¹å¦å­˜ä¸º.csæ–‡ä»¶ï¼Œå¹¶æŠŠå…¶ä¸­çš„<code class="language-plaintext highlighter-rouge">""</code>æ›¿æ¢æˆbase64åŠ å¯†çš„.NETç¨‹åºé›†ï¼Œæœ€ç»ˆä¿å­˜æˆtest.cs</p>

<p>å¯åŠ¨å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /unsafe /out::file.dll test.cs
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe /logfile= /LogToConsole=false /U file.dll
</code></pre></div></div>

<h4 id="5wmic">(5)Wmic</h4>

<p>å¯åŠ¨å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wmic os get /format:"file.xsl"
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p>Covenantåœ¨æ­¤å¤„æç¤ºè¿™ä¸ªæ–¹æ³•ä¹Ÿè®¸æ— æ³•åœ¨Windows 10å’ŒWindows Server 2016ä¸‹ä½¿ç”¨</p>

<p>å°†.NETç¨‹åºé›†ä¿å­˜åœ¨æ•°ç»„ï¼Œé€šè¿‡DotNetToJScriptçš„æ–¹æ³•åœ¨å†…å­˜è¿›è¡ŒåŠ è½½</p>

<p>ä»£ç ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var o = delegate.DynamicInvoke(array.ToArray()).CreateInstance('Grunt.GruntStager');
</code></pre></div></div>

<p>å…³äºWmicçš„ç”¨æ³•å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/%E5%88%A9%E7%94%A8wmic%E8%B0%83%E7%94%A8xsl%E6%96%87%E4%BB%B6%E7%9A%84%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8">ã€Šåˆ©ç”¨wmicè°ƒç”¨xslæ–‡ä»¶çš„åˆ†æä¸åˆ©ç”¨ã€‹</a></p>

<h4 id="6regsvr32">(6)Regsvr32</h4>

<p>å¯åŠ¨å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>regsvr32 /u /s /i:file.sct scrobj.dll
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p>Covenantåœ¨æ­¤å¤„æç¤ºè¿™ä¸ªæ–¹æ³•ä¹Ÿè®¸æ— æ³•åœ¨Windows 10å’ŒWindows Server 2016ä¸‹ä½¿ç”¨</p>

<p>å°†.NETç¨‹åºé›†ä¿å­˜åœ¨æ•°ç»„ï¼Œé€šè¿‡DotNetToJScriptçš„æ–¹æ³•åœ¨å†…å­˜è¿›è¡ŒåŠ è½½</p>

<p>å…³äºRegsvr32çš„ç”¨æ³•å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« ã€ŠUse SCT to Bypass Application Whitelisting Protectionã€‹</p>

<h4 id="7mshta">(7)Mshta</h4>

<p>å¯åŠ¨å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mshta file.hta
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p>Covenantåœ¨æ­¤å¤„æç¤ºè¿™ä¸ªæ–¹æ³•ä¹Ÿè®¸æ— æ³•åœ¨Windows 10å’ŒWindows Server 2016ä¸‹ä½¿ç”¨</p>

<p>å°†.NETç¨‹åºé›†ä¿å­˜åœ¨æ•°ç»„ï¼Œé€šè¿‡DotNetToJScriptçš„æ–¹æ³•åœ¨å†…å­˜è¿›è¡ŒåŠ è½½</p>

<p>å…³äºMshtaçš„ç”¨æ³•å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E4%BB%8Egithub%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%9A%E7%A7%8D%E6%96%B9%E6%B3%95">ã€Šæ¸—é€æŠ€å·§â€”â€”ä»githubä¸‹è½½æ–‡ä»¶çš„å¤šç§æ–¹æ³•ã€‹</a></p>

<h4 id="8cscript">(8)Cscript</h4>

<p>å¯åŠ¨å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cscript file.js
</code></pre></div></div>

<p>è¿™é‡Œå€ŸåŠ©äº†DotNetToJScriptï¼Œå…¶ä»–å†…å®¹åŒä¸Š</p>

<h4 id="9wscript">(9)Wscript</h4>

<p>å¯åŠ¨å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wscript file.js
</code></pre></div></div>

<p>è¿™é‡Œå€ŸåŠ©äº†DotNetToJScriptï¼Œå…¶ä»–å†…å®¹åŒä¸Š</p>

<p>ä»¥ä¸Š9ç§å¯åŠ¨æ–¹å¼éƒ½å¯é€‰æ‹©ä»¥ä¸‹ä¸¤ä¸ªæ¨¡æ¿ï¼š</p>

<h4 id="1grunthttp">(1)GruntHTTP</h4>

<p>ä½¿ç”¨HTTPåè®®åŒC2 serverè¿›è¡Œé€šä¿¡</p>

<p>æ‰§è¡Œååå¼¹è¿æ¥è‡³C2 server</p>

<p>å¯è®¾ç½®ä»¥ä¸‹å‚æ•°ï¼š</p>

<ul>
  <li>ValidateCert</li>
  <li>UseCertPinning</li>
  <li>Delay</li>
  <li>JitterPercent</li>
  <li>ConnectAttempts</li>
  <li>KillDate</li>
  <li>DotNetFrameworkVersion</li>
</ul>

<h4 id="2gruntsmb">(2)GruntSMB</h4>

<p>ä½¿ç”¨å‘½åç®¡é“ï¼Œä¸ç›´æ¥åŒC2 serverè¿›è¡Œé€šä¿¡ï¼Œè€Œæ˜¯åœ¨å„ä¸ªGruntsä¹‹é—´è¿›è¡Œé€šä¿¡</p>

<p>æ‰§è¡Œååœ¨æœ¬æœºåˆ›å»ºå‘½åç®¡é“ï¼Œå¯é€šè¿‡å…¶ä»–çš„Gruntè¿›è¡Œè¿œç¨‹è¿æ¥</p>

<p>è¿™é‡Œå¤šäº†ä¸€ä¸ªé…ç½®å‚æ•°ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SMBPipeName
</code></pre></div></div>

<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>

<p>GruntSMBä¸ºå†…ç½‘ä½¿ç”¨ï¼Œå¯é€šè¿‡å…¶ä»–çš„Gruntè¿›è¡Œæ¿€æ´»ï¼Œæ¿€æ´»æ–¹å¼ï¼š</p>

<p><code class="language-plaintext highlighter-rouge">Grunt:&lt;id&gt;</code>-&gt;<code class="language-plaintext highlighter-rouge">Task</code>-&gt;<code class="language-plaintext highlighter-rouge">Connect</code></p>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-11-1/2-3.png" alt="Alt text" /></p>

<h3 id="3grunts">3.Grunts</h3>

<p>æ‰€æœ‰Gruntsçš„åˆ—è¡¨ï¼Œå¯å‘Gruntå‘é€æ§åˆ¶å‘½ä»¤</p>

<h4 id="1info">(1)Info</h4>

<p>åŒ…æ‹¬Gruntçš„åŸºæœ¬ä¿¡æ¯</p>

<h4 id="2interact">(2)Interact</h4>

<p>å‘½ä»¤è¡Œçš„æ§åˆ¶é¡µé¢</p>

<h4 id="3task">(3)Task</h4>

<p>Gruntæ”¯æŒçš„åŠŸèƒ½ï¼Œå†…ç½®äº†å¤šä¸ªå¼€æºå·¥å…·ï¼š</p>

<ul>
  <li><a href="https://github.com/GhostPack/Rubeus">Rubeus</a></li>
  <li><a href="https://github.com/GhostPack/Seatbelt">Seatbelt</a></li>
  <li><a href="https://github.com/GhostPack/SharpDPAPI">SharpDPAPI</a></li>
  <li><a href="https://github.com/GhostPack/SharpDump">SharpDump</a></li>
  <li><a href="https://github.com/cobbr/SharpSploit">SharpSploit</a></li>
  <li><a href="https://github.com/GhostPack/SharpUp">SharpUp</a></li>
  <li><a href="https://github.com/GhostPack/SharpWMI">SharpWMI</a></li>
</ul>

<h4 id="4taskings">(4)Taskings</h4>

<p>è®°å½•æ¯æ¡å‘½ä»¤çš„æ‰§è¡Œæƒ…å†µ</p>

<h3 id="4templates">4.Templates</h3>

<p>Gruntçš„æ¨¡æ¿æ–‡ä»¶ï¼Œé»˜è®¤åŒ…å«äº†GruntHTTPå’ŒGruntSMB</p>

<p>è¿™é‡Œå¯ä»¥ä¿®æ”¹æ¨¡æ¿æ–‡ä»¶æˆ–è€…æ·»åŠ æ–°çš„æ¨¡æ¿æ–‡ä»¶</p>

<h3 id="5tasks">5.Tasks</h3>

<p>Taskçš„æ¨¡æ¿æ–‡ä»¶ï¼Œä½œä¸ºGruntæ”¯æŒçš„åŠŸèƒ½ï¼Œå†…ç½®äº†å¤šä¸ªå¼€æºå·¥å…·ï¼š</p>

<ul>
  <li><a href="https://github.com/GhostPack/Rubeus">Rubeus</a></li>
  <li><a href="https://github.com/GhostPack/Seatbelt">Seatbelt</a></li>
  <li><a href="https://github.com/GhostPack/SharpDPAPI">SharpDPAPI</a></li>
  <li><a href="https://github.com/GhostPack/SharpDump">SharpDump</a></li>
  <li><a href="https://github.com/cobbr/SharpSploit">SharpSploit</a></li>
  <li><a href="https://github.com/GhostPack/SharpUp">SharpUp</a></li>
  <li><a href="https://github.com/GhostPack/SharpWMI">SharpWMI</a></li>
</ul>

<p>è¿™é‡Œå¯ä»¥ä¿®æ”¹æ¨¡æ¿æ–‡ä»¶æˆ–è€…æ·»åŠ æ–°çš„æ¨¡æ¿æ–‡ä»¶</p>

<h3 id="6taskings">6.Taskings</h3>

<p>è®°å½•æ‰€æœ‰Gruntsçš„å‘½ä»¤æ‰§è¡Œæƒ…å†µ</p>

<h3 id="7graph">7.Graph</h3>

<p>å›¾å½¢åŒ–é¡µé¢ï¼Œå±•ç¤ºGruntå’ŒListenerçš„è¿æ¥å…³ç³»</p>

<h3 id="8data">8.Data</h3>

<p>å±•ç¤ºä»Gruntè·å¾—çš„æœ‰ä»·å€¼ä¿¡æ¯</p>

<h3 id="9users">9.Users</h3>

<p>ç®¡ç†ç™»å½•ç”¨æˆ·ï¼Œç”¨ä½œå›¢é˜Ÿåä½œ</p>

<h2 id="0x04-covenantçš„ä¼˜ç‚¹">0x04 Covenantçš„ä¼˜ç‚¹</h2>
<hr />

<h3 id="1c2-serveræ”¯æŒå¤šå¹³å°">1.C2 Serveræ”¯æŒå¤šå¹³å°</h3>

<p>C2 Serverä¸ä»…æ”¯æŒLinuxï¼ŒMacOSå’ŒWindowsï¼Œè¿˜æ”¯æŒdockerå®¹å™¨</p>

<h3 id="2æ‰©å±•æ€§é«˜">2.æ‰©å±•æ€§é«˜</h3>

<p>å¯è‡ªå®šä¹‰é€šä¿¡åè®®ï¼Œè‡ªå®šä¹‰å¯åŠ¨æ–¹å¼ï¼Œè‡ªå®šä¹‰åŠŸèƒ½ç­‰</p>

<h3 id="3æ‰©å±•çš„åŠŸèƒ½å¯ç›´æ¥åœ¨å†…å­˜æ‰§è¡Œ">3.æ‰©å±•çš„åŠŸèƒ½å¯ç›´æ¥åœ¨å†…å­˜æ‰§è¡Œ</h3>

<p>é€šè¿‡åŠ¨æ€ç¼–è¯‘ï¼ŒC2 Serverèƒ½å¤Ÿå¯¹ä»£ç è¿›è¡ŒåŠ¨æ€ç¼–è¯‘åå‘é€è‡³ç›®æ ‡å¹¶ä½¿ç”¨Assembly.Load()ä»å†…å­˜è¿›è¡ŒåŠ è½½</p>

<h3 id="4æ”¯æŒå†…ç½‘é€šä¿¡ç»Ÿä¸€æµé‡å‡ºå£">4.æ”¯æŒå†…ç½‘é€šä¿¡ï¼Œç»Ÿä¸€æµé‡å‡ºå£</h3>

<p>åœ¨å†…ç½‘å„ä¸ªè¢«æ§åˆ¶ç«¯ä¹‹é—´é€šè¿‡å‘½åç®¡é“è¿›è¡Œé€šä¿¡ï¼Œç»Ÿä¸€æµé‡å‡ºå£ï¼Œéšè—é€šä¿¡é€šé“</p>

<h3 id="5ä¾¿äºå›¢é˜Ÿåä½œ">5.ä¾¿äºå›¢é˜Ÿåä½œ</h3>

<p>æ”¯æŒå¤šç”¨æˆ·ï¼Œèƒ½å¤Ÿå…±äº«èµ„æº</p>

<h2 id="0x05-covenantçš„æ£€æµ‹">0x05 Covenantçš„æ£€æµ‹</h2>
<hr />

<h3 id="1æ£€æµ‹netç¨‹åºé›†çš„è¿è¡Œ">1.æ£€æµ‹.NETç¨‹åºé›†çš„è¿è¡Œ</h3>

<p>å› ä¸ºéœ€è¦ä½¿ç”¨Rosyln Cï¼ƒç¼–è¯‘å™¨ï¼Œæ‰€ä»¥ä¼šå¼•ç”¨Microsoft.CodeAnalysisç¨‹åºé›†</p>

<p>è¿™é‡Œå¯ä»¥å°è¯•ä»æŒ‡å®šè¿›ç¨‹ä¸­æ”¶é›†.NETäº‹ä»¶ï¼Œå‚è€ƒè„šæœ¬ï¼š</p>

<p>https://gist.github.com/cobbr/1bab9e175ebbc6ff93cc5875c69ecc50</p>

<h3 id="2æ£€æµ‹å‘½åç®¡é“çš„ä½¿ç”¨">2.æ£€æµ‹å‘½åç®¡é“çš„ä½¿ç”¨</h3>

<p>æ£€æµ‹å‘½ä»¤ç®¡é“è¿œç¨‹è¿æ¥çš„æµé‡</p>

<p>å‘½ä»¤ç®¡é“è¿œç¨‹è¿æ¥ä¼šäº§ç”ŸEvent ID 18çš„æ—¥å¿—ï¼Œå‚è€ƒåœ°å€ï¼š</p>

<p>https://github.com/hunters-forge/OSSEM/blob/master/data_dictionaries/windows/sysmon/event-18.md</p>

<h3 id="3httpé€šä¿¡æµé‡">3.HTTPé€šä¿¡æµé‡</h3>

<p>é»˜è®¤çš„é€šä¿¡æ¨¡æ¿å­˜åœ¨ç‰¹å¾ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-11-1/3-1.png" alt="Alt text" /></p>

<h2 id="0x06-å°ç»“">0x06 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡ä»‹ç»äº†Covenantçš„ç»†èŠ‚ï¼Œåˆ†æç‰¹ç‚¹ï¼ŒCovenantçš„å¯æ‰©å±•æ€§å¾ˆé«˜ï¼Œèƒ½å¤Ÿå¾ˆæ–¹ä¾¿çš„åšäºŒæ¬¡å¼€å‘ã€‚</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET