I"¢/<h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p>åœ¨ä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/Exchange-Web-Service(EWS)%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%972-SOAP-XML-message">ã€ŠExchange Web Service(EWS)å¼€å‘æŒ‡å—2â€”â€”SOAP XML messageã€‹</a>ä»‹ç»äº†SOAP XML messageçš„ä½¿ç”¨ï¼Œé€šè¿‡Pythonå®ç°äº†åˆ©ç”¨hashå¯¹Exchangeèµ„æºçš„è®¿é—®ã€‚</p>

<p>å½“æˆ‘ä»¬é€šè¿‡SOAP XML messageè¯»å–é‚®ä»¶æ—¶ï¼Œå°å°ä¼šé‡åˆ°ä»¥ä¸‹éº»çƒ¦ï¼šç”±äºæ¯ä¸€å°é‚®ä»¶å¯¹åº”ä¸€ä»½åŸå§‹çš„XMLæ–‡ä»¶ï¼ŒåŸå§‹çš„XMLæ–‡ä»¶åŒ…å«å®Œæ•´çš„é‚®ä»¶ä¿¡æ¯ï¼Œäººå·¥åˆ†æé‚®ä»¶å°†è€—è´¹å¤§é‡ç²¾åŠ›ã€‚</p>

<p>äºæ˜¯ï¼Œæœ¬æ–‡å°†è¦ä»‹ç»ä¸€ç§SOAP XMLè§£æå™¨çš„å®ç°æ–¹æ³•ï¼Œç¼–å†™å·¥å…·å®ç°è‡ªåŠ¨æå–æœ‰ä»·å€¼çš„é‚®ä»¶ä¿¡æ¯ï¼Œæé«˜é˜…è¯»æ•ˆç‡ã€‚</p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<p>æœ¬æ–‡å°†è¦ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>é€‚ç”¨ç¯å¢ƒ</li>
  <li>è®¾è®¡æ€è·¯</li>
  <li>å¼€æºPythonå®ç°ä»£ç </li>
  <li>ä»£ç å¼€å‘ç»†èŠ‚</li>
</ul>

<h2 id="0x02-è®¾è®¡æ€è·¯">0x02 è®¾è®¡æ€è·¯</h2>
<hr />

<p>é€šè¿‡SOAP XML messageè¯»å–æ”¶ä»¶ç®±ä¸­çš„æ‰€æœ‰é‚®ä»¶ï¼Œéœ€è¦ä»¥ä¸‹æ­¥éª¤ï¼š</p>

<ol>
  <li>ä½¿ç”¨<a href="https://github.com/3gstudent/Homework-of-Python/blob/master/ewsManage.py">ewsManage.py</a>çš„listmailofinboxå‘½ä»¤è·å¾—æ¯ä¸€å°é‚®ä»¶çš„ItemIdå’ŒChangeKey</li>
  <li>å¾ªç¯ä½¿ç”¨<a href="https://github.com/3gstudent/Homework-of-Python/blob/master/ewsManage.py">ewsManage.py</a>çš„getmailå‘½ä»¤ï¼Œä¼ å…¥æ¯å°é‚®ä»¶å¯¹åº”çš„ItemIdå’ŒChangeKey</li>
  <li>åˆ†åˆ«å°†è¿”å›ç»“æœä¿å­˜ä¸ºXMLæ ¼å¼çš„æ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªXMLæ–‡ä»¶å¯¹åº”ä¸€å°é‚®ä»¶</li>
</ol>

<p>ä¸ºäº†ä¿è¯SOAP XMLè§£æå™¨çš„é€šç”¨æ€§ï¼Œèƒ½å¤Ÿé…åˆä¸åŒçš„å·¥å…·ï¼Œæ‰€ä»¥å°†SOAP XMLè§£æå™¨è®¾è®¡æˆäº†æ–‡ä»¶ç®¡ç†å™¨çš„ç»“æ„ï¼Œé€‰ä¸­XMLæ–‡ä»¶å°†ä¼šè‡ªåŠ¨è§£æï¼Œæå–æœ‰ä»·å€¼çš„ä¿¡æ¯å¹¶æ˜¾ç¤ºï¼Œåœ¨è®¾è®¡ä¸Šéµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>

<ul>
  <li>å¼€å‘è¯­è¨€é€‰ç”¨Pythonï¼Œä¸ºäº†æé«˜ä¾¿æ·æ€§ï¼Œå…¨éƒ¨ä½¿ç”¨Pythonçš„æ ‡å‡†åº“</li>
  <li>æ–‡ä»¶ç®¡ç†å™¨æ¶‰åŠåˆ°Pythonçš„ç•Œé¢å¼€å‘ï¼Œä½¿ç”¨æ ‡å‡†GUIåº“<code class="language-plaintext highlighter-rouge">Tkinter</code></li>
  <li>SOAP(Simple Object Access Protocol)åè®®åœ¨æœ¬è´¨ä¸Šä»ä¸ºXMLåè®®ï¼Œåœ¨è§£æä¸Šä½¿ç”¨æ ‡å‡†åº“<code class="language-plaintext highlighter-rouge">xml.dom.minidom</code></li>
</ul>

<p><strong>æ³¨ï¼š</strong></p>

<p>å¦‚æœä½¿ç”¨å­—ç¬¦ä¸²åŒ¹é…çš„æ–¹å¼å¯¹XMLæ–‡ä»¶è§£æï¼Œè¿˜éœ€è¦è€ƒè™‘è½¬ä¹‰å­—ç¬¦</p>

<h2 id="0x03-ç¨‹åºå®ç°">0x03 ç¨‹åºå®ç°</h2>
<hr />

<h3 id="1æ–‡ä»¶ç®¡ç†å™¨çš„å®ç°">1.æ–‡ä»¶ç®¡ç†å™¨çš„å®ç°</h3>

<p>Tkinterçš„ä½¿ç”¨ï¼š</p>

<p>https://docs.python.org/3/library/tk.html</p>

<p>è¿™é‡Œå¯ä»¥åŸºäºå¼€æºçš„<a href="https://github.com/yangsphp/file-manager-mask">file-manager-mask</a>è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œä¿®æ”¹å¦‚ä¸‹éƒ¨åˆ†ï¼š</p>

<ul>
  <li>å»æ‰å›¾ç‰‡æ˜¾ç¤ºåŠŸèƒ½</li>
  <li>å»æ‰ç¼–è¾‘æ–‡æœ¬çš„åŠŸèƒ½</li>
  <li>æ·»åŠ XMLæ–‡ä»¶è§£æçš„åŠŸèƒ½</li>
</ul>

<h3 id="2xmlæ–‡ä»¶è§£æ">2.XMLæ–‡ä»¶è§£æ</h3>

<p>xml.dom.minidomçš„ä½¿ç”¨ï¼š</p>

<p>https://docs.python.org/3/library/xml.dom.minidom.html</p>

<p>è¿™é‡Œéœ€è¦æå–ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>é‚®ä»¶æ ‡é¢˜</li>
  <li>å‘ä»¶äºº</li>
  <li>æ”¶ä»¶äºº</li>
  <li>æŠ„é€</li>
  <li>æ¥æ”¶æ—¶é—´</li>
  <li>é™„ä»¶åç§°</li>
  <li>æ­£æ–‡å†…å®¹</li>
</ul>

<p>åœ¨æ•°æ®æå–ä¸Šæœ‰ä»¥ä¸‹ä¸åŒçš„æƒ…å†µï¼š</p>

<p><strong>æ³¨ï¼š</strong></p>

<p>XMLæ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿ</p>

<h4 id="1æå–èŠ‚ç‚¹å±æ€§">(1)æå–èŠ‚ç‚¹å±æ€§</h4>

<p>å“åº”æ¶ˆæ¯çš„æ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;m:GetItemResponseMessage ResponseClass="Success"&gt;
</code></pre></div></div>

<p>æå–èŠ‚ç‚¹<code class="language-plaintext highlighter-rouge">"m:GetItemResponseMessage"</code>çš„å±æ€§<code class="language-plaintext highlighter-rouge">"ResponseClass"</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from xml.dom import minidom
dom = minidom.parse("TestMail.xml")
data_response = dom.getElementsByTagName("m:GetItemResponseMessage")
print(data_response[0].getAttribute("ResponseClass"))
</code></pre></div></div>

<h4 id="2ç›´æ¥æå–æ ‡ç­¾å¯¹ä¹‹é—´çš„æ•°æ®">(2)ç›´æ¥æå–æ ‡ç­¾å¯¹ä¹‹é—´çš„æ•°æ®</h4>

<p>é‚®ä»¶æ ‡é¢˜çš„æ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;t:Subject&gt;123&lt;/t:Subject&gt;
</code></pre></div></div>

<p>æ­£æ–‡å†…å®¹çš„æ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;t:Body BodyType="Text" IsTruncated="false"&gt;123&lt;/t:Body&gt;
</code></pre></div></div>

<p>æ¥æ”¶æ—¶é—´çš„æ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;t:DateTimeReceived&gt;2021-01-11T11:08:50Z&lt;/t:DateTimeReceived&gt;
</code></pre></div></div>

<p>æå–èŠ‚ç‚¹<code class="language-plaintext highlighter-rouge">"t:Subject"</code>çš„å†…å®¹ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from xml.dom import minidom
dom = minidom.parse("TestMail.xml")
data_subject = dom.getElementsByTagName("t:Subject")
print(data_subject[0].firstChild.data)
</code></pre></div></div>

<p>å‘ä»¶äººçš„æ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;t:Sender&gt;
	&lt;t:Mailbox&gt;
		&lt;t:Name&gt;test1&lt;/t:Name&gt;
		&lt;t:EmailAddress&gt;test1@test.com&lt;/t:EmailAddress&gt;
		&lt;t:RoutingType&gt;SMTP&lt;/t:RoutingType&gt;
		&lt;t:MailboxType&gt;Mailbox&lt;/t:MailboxType&gt;
	&lt;/t:Mailbox&gt;
&lt;/t:Sender&gt;
</code></pre></div></div>

<p>è¿™é‡Œéœ€è¦è€ƒè™‘çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹</p>

<p><strong>æ³¨ï¼š</strong></p>

<p>å‘ä»¶äººé€šå¸¸åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥ä¸éœ€è¦è€ƒè™‘å¾ªç¯æå–</p>

<p>æå–çˆ¶èŠ‚ç‚¹<code class="language-plaintext highlighter-rouge">"t:Sender"</code>çš„å­èŠ‚ç‚¹<code class="language-plaintext highlighter-rouge">"t:Name"</code>å†…å®¹ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from xml.dom import minidom
dom = minidom.parse("TestMail.xml")
data_from = dom.getElementsByTagName("t:Sender")
print(data_from[0].getElementsByTagName("t:Name")[0].firstChild.data)
</code></pre></div></div>

<h4 id="3å¾ªç¯æå–æ ‡ç­¾å¯¹ä¹‹é—´çš„æ•°æ®">(3)å¾ªç¯æå–æ ‡ç­¾å¯¹ä¹‹é—´çš„æ•°æ®</h4>

<p>æ”¶ä»¶äººçš„æ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;t:ToRecipients&gt;
	&lt;t:Mailbox&gt;
		&lt;t:Name&gt;test2&lt;/t:Name&gt;
		&lt;t:EmailAddress&gt;test2@test.com&lt;/t:EmailAddress&gt;
		&lt;t:RoutingType&gt;SMTP&lt;/t:RoutingType&gt;
		&lt;t:MailboxType&gt;Mailbox&lt;/t:MailboxType&gt;
	&lt;/t:Mailbox&gt;
	&lt;t:Mailbox&gt;
		&lt;t:Name&gt;test3&lt;/t:Name&gt;
		&lt;t:EmailAddress&gt;test3@test.com&lt;/t:EmailAddress&gt;
		&lt;t:RoutingType&gt;SMTP&lt;/t:RoutingType&gt;
		&lt;t:MailboxType&gt;Mailbox&lt;/t:MailboxType&gt;
	&lt;/t:Mailbox&gt;
&lt;/t:ToRecipients&gt;
</code></pre></div></div>

<p>æŠ„é€äººçš„æ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;t:CcRecipients&gt;
	&lt;t:Mailbox&gt;
		&lt;t:Name&gt;test2&lt;/t:Name&gt;
		&lt;t:EmailAddress&gt;test2@test.com&lt;/t:EmailAddress&gt;
		&lt;t:RoutingType&gt;SMTP&lt;/t:RoutingType&gt;
		&lt;t:MailboxType&gt;Mailbox&lt;/t:MailboxType&gt;
	&lt;/t:Mailbox&gt;
	&lt;t:Mailbox&gt;
		&lt;t:Name&gt;test3&lt;/t:Name&gt;
		&lt;t:EmailAddress&gt;test3@test.com&lt;/t:EmailAddress&gt;
		&lt;t:RoutingType&gt;SMTP&lt;/t:RoutingType&gt;
		&lt;t:MailboxType&gt;Mailbox&lt;/t:MailboxType&gt;
	&lt;/t:Mailbox&gt;
&lt;/t:CcRecipients&gt;
</code></pre></div></div>

<p>é™„ä»¶çš„æ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;t:Attachments&gt;
	&lt;t:FileAttachment&gt;
		&lt;t:AttachmentId Id="AAMk**1"/&gt;
		&lt;t:Name&gt;image1.jpg&lt;/t:Name&gt;
		&lt;t:ContentType&gt;image/jpeg&lt;/t:ContentType&gt;
		&lt;t:ContentId&gt;image1.jpg@11111111.11111111&lt;/t:ContentId&gt;
		&lt;t:Size&gt;1024&lt;/t:Size&gt;
		&lt;t:LastModifiedTime&gt;2021-01-01T01:01:01&lt;/t:LastModifiedTime&gt;
		&lt;t:IsInline&gt;true&lt;/t:IsInline&gt;
		&lt;t:IsContactPhoto&gt;false&lt;/t:IsContactPhoto&gt;
	&lt;/t:FileAttachment&gt;
	&lt;t:FileAttachment&gt;
		&lt;t:AttachmentId Id="AAMk**2"/&gt;
		&lt;t:Name&gt;image2.jpg&lt;/t:Name&gt;
		&lt;t:ContentType&gt;image/jpeg&lt;/t:ContentType&gt;
		&lt;t:ContentId&gt;image2.jpg@11111111.11111112&lt;/t:ContentId&gt;
		&lt;t:Size&gt;1024&lt;/t:Size&gt;
		&lt;t:LastModifiedTime&gt;2021-01-01T01:01:01&lt;/t:LastModifiedTime&gt;
		&lt;t:IsInline&gt;true&lt;/t:IsInline&gt;
		&lt;t:IsContactPhoto&gt;false&lt;/t:IsContactPhoto&gt;
		&lt;/t:FileAttachment&gt;
	&lt;/t:Attachments&gt;
</code></pre></div></div>

<p>è¿™é‡Œéœ€è¦è€ƒè™‘çˆ¶èŠ‚ç‚¹å’Œå…„å¼ŸèŠ‚ç‚¹</p>

<p>æå–çˆ¶èŠ‚ç‚¹<code class="language-plaintext highlighter-rouge">"t:ToRecipients"</code>çš„æ‰€æœ‰å­èŠ‚ç‚¹<code class="language-plaintext highlighter-rouge">"t:Name"</code>çš„å†…å®¹ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from xml.dom import minidom
dom = minidom.parse("TestMail.xml")
data_to = dom.getElementsByTagName("t:ToRecipients")
data_to_name = data_to[0].getElementsByTagName("t:Name")
for i in range(len(data_to_name)):
	print(data_to_name[i].firstChild.data)
</code></pre></div></div>

<p>ä»¥ä¸Šä»£ç è·³è¿‡äº†å¯¹èŠ‚ç‚¹<code class="language-plaintext highlighter-rouge">"t:Mailbox"</code>çš„åˆ¤æ–­ï¼Œå¦‚æœåŠ ä¸Šåˆ¤æ–­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from xml.dom import minidom
dom = minidom.parse("TestMail.xml")
data_to = dom.getElementsByTagName("t:ToRecipients")
data_to_mailbox = data_to[0].getElementsByTagName("t:Mailbox")
for i in range(len(data_to_mailbox)):
	print(data_to_mailbox[i].getElementsByTagName("t:Name")[0].firstChild.data)
</code></pre></div></div>

<p>å½“å®Œæˆäº†å¯¹XMLæ–‡ä»¶çš„æ•°æ®æå–åï¼Œéœ€è¦è€ƒè™‘å¦‚ä½•å°†æ•°æ®æ˜¾ç¤ºåˆ°æ–‡ä»¶ç®¡ç†å™¨çš„çª—å£ä¸Š</p>

<p>è¿™é‡Œè¦ç”¨åˆ°insertå‡½æ•°</p>

<p>å‚æ•°è¯´æ˜ï¼š</p>

<p>https://docs.python.org/3.8/library/tkinter.ttk.html?highlight=insert#tkinter.ttk.Notebook.insert</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>insert(pos, child, **kw)
Inserts a pane at the specified position.
</code></pre></div></div>

<p>å¯¹äºå‚æ•°<code class="language-plaintext highlighter-rouge">pos</code>,<code class="language-plaintext highlighter-rouge">END</code>ä»£è¡¨ä»æœ€åä¸€è¡Œæ’å…¥ï¼Œæ•°å­—ä»£è¡¨ä»æŒ‡å®šè¡Œæ’å…¥(ä¾‹å¦‚ç¬¬ä¸€è¡Œä¸º<code class="language-plaintext highlighter-rouge">1.0</code>)</p>

<p>å®Œæ•´çš„ä»£ç å·²ä¸Šä¼ è‡³Githubï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/3gstudent/Homework-of-Python/blob/master/Exchange_EWS_XML_Parser.py</p>

<p>ä»£ç æ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š</p>

<ul>
  <li>æ–‡ä»¶ç®¡ç†å™¨ï¼Œä¾¿äºæŸ¥çœ‹å¤šä¸ªæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡é”®ç›˜æ–¹å‘é”®å®ç°æ–‡ä»¶åˆ‡æ¢</li>
  <li>XMLæ–‡ä»¶è§£æï¼Œèƒ½å¤Ÿä»Exchange SOAP XML messageä¸­è‡ªåŠ¨æå–å‡ºæœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œæ ‡è®°ä¸ç¬¦åˆæ ¼å¼çš„XMLæ–‡ä»¶</li>
</ul>

<p>è¿è¡Œç•Œé¢å¦‚ä¸‹å›¾ï¼š</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2021-3-22/2-1.png" alt="Alt text" /></p>

<p>åç»­å¯ä»¥ç»“åˆ<a href="https://github.com/3gstudent/Homework-of-Python/blob/master/ewsManage.py">ewsManage.py</a>å¼€å‘å®Œæ•´çš„Exchangeç•Œé¢åŒ–å®¢æˆ·ç«¯ç¨‹åºï¼Œå®ç°åˆ©ç”¨hashè¯»å–Exchangeé‚®ä»¶</p>

<h2 id="0x04-å°ç»“">0x04 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§SOAP XMLè§£æå™¨çš„å®ç°æ–¹æ³•ï¼Œç¼–å†™å·¥å…·å®ç°è‡ªåŠ¨ä»Exchange SOAP XML messageä¸­æå–é‚®ä»¶ä¿¡æ¯ï¼Œå¼€æºPythonå®ç°ä»£ç ï¼Œåˆ†æä»£ç å¼€å‘ç»†èŠ‚</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET