I"€8<h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p><a href="https://github.com/GhostPack/Seatbelt">Seatbelt</a>æ˜¯ä¸€ä¸ªCï¼ƒé¡¹ç›®ï¼Œå¯ä»¥ç”¨æ¥å¯¹ä¸»æœºè¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œåœ¨è¿›æ”»å’Œé˜²å¾¡çš„è§’åº¦éƒ½èƒ½å‘æŒ¥ä½œç”¨ã€‚</p>

<p>é€šè¿‡ä¸€æ¡å‘½ä»¤ï¼Œå°±èƒ½å¤Ÿè·å¾—å½“å‰ä¸»æœºçš„å¤šé¡¹é…ç½®ä¿¡æ¯ï¼Œæ–¹ä¾¿å®ç”¨ã€‚</p>

<p>ä¸ºäº†èƒ½å¤Ÿæ‰©å±•Seatbeltçš„ä½¿ç”¨åœºæ™¯ï¼Œåœ¨ä¸ä¿®æ”¹Seatbeltä»»ä½•ä»£ç çš„å‰æä¸‹ï¼Œæœ¬æ–‡å°†è¦ä»‹ç»ä¸¤ç§é€šè¿‡å†…å­˜åŠ è½½Seatbeltçš„æ–¹æ³•(Assembly.Loadå’Œexecute-assembly)ï¼Œåˆ†åˆ«è¡¥å…¨å‘.NETç¨‹åºé›†çš„Mainå‡½æ•°ä¼ å…¥å‚æ•°çš„å®ç°ä»£ç ã€‚</p>

<p>ä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/%E4%BB%8E%E5%86%85%E5%AD%98%E5%8A%A0%E8%BD%BD.NET%E7%A8%8B%E5%BA%8F%E9%9B%86(Assembly.Load)%E7%9A%84%E5%88%A9%E7%94%A8%E5%88%86%E6%9E%90">ã€Šä»å†…å­˜åŠ è½½.NETç¨‹åºé›†(Assembly.Load)çš„åˆ©ç”¨åˆ†æã€‹</a>å’Œ<a href="https://3gstudent.github.io/%E4%BB%8E%E5%86%85%E5%AD%98%E5%8A%A0%E8%BD%BD.NET%E7%A8%8B%E5%BA%8F%E9%9B%86(execute-assembly)%E7%9A%84%E5%88%A9%E7%94%A8%E5%88%86%E6%9E%90">ã€Šä»å†…å­˜åŠ è½½.NETç¨‹åºé›†(execute-assembly)çš„åˆ©ç”¨åˆ†æã€‹</a>
åªä»‹ç»äº†å‘æŒ‡å®šç±»çš„æ–¹æ³•ä¼ å…¥å‚æ•°çš„å®ç°ä»£ç </p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<p>æœ¬æ–‡å°†è¦å°†ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>Seatbeltçš„ç¼–è¯‘å’Œä½¿ç”¨</li>
  <li>ä½¿ç”¨Assembly.LoadåŠ è½½Seatbeltå¹¶ä¼ å…¥å‚æ•°çš„æ–¹æ³•</li>
  <li>ä½¿ç”¨execute-assemblyåŠ è½½Seatbeltå¹¶ä¼ å…¥å‚æ•°çš„æ–¹æ³•</li>
  <li>Visual Studio2015åœ¨64ä½å¹³å°ä¸‹ä½¿ç”¨æ±‡ç¼–ä»£ç çš„æ–¹æ³•</li>
</ul>

<h2 id="0x02-seatbeltçš„ç¼–è¯‘å’Œä½¿ç”¨">0x02 Seatbeltçš„ç¼–è¯‘å’Œä½¿ç”¨</h2>
<hr />

<h3 id="1ç¼–è¯‘">1.ç¼–è¯‘</h3>

<p>å·¥ç¨‹åœ°å€ï¼š</p>

<p>https://github.com/GhostPack/Seatbelt</p>

<p>æ”¯æŒ.NET 3.5å’Œ4.0</p>

<p>éœ€è¦ä½¿ç”¨Visual Studio2017æˆ–è€…æ›´é«˜çš„ç‰ˆæœ¬è¿›è¡Œç¼–è¯‘</p>

<h3 id="2ä½¿ç”¨">2.ä½¿ç”¨</h3>

<p>éœ€è¦ä¼ å…¥å‚æ•°æŒ‡å®šå…·ä½“çš„å‘½ä»¤ï¼Œä¾‹å¦‚è¿è¡Œæ‰€æœ‰æ£€æŸ¥å¹¶è¿”å›æ‰€æœ‰è¾“å‡ºï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Seatbelt.exe -group=all -full
</code></pre></div></div>

<p>è¯¦ç»†çš„å‘½ä»¤å¯å‚è€ƒé¡¹ç›®çš„è¯´æ˜ï¼š</p>

<p>https://github.com/GhostPack/Seatbelt#command-line-usage</p>

<h2 id="0x03-ä½¿ç”¨assemblyloadåŠ è½½seatbeltå¹¶ä¼ å…¥å‚æ•°çš„æ–¹æ³•">0x03 ä½¿ç”¨Assembly.LoadåŠ è½½Seatbeltå¹¶ä¼ å…¥å‚æ•°çš„æ–¹æ³•</h2>
<hr />

<p>å®ç°è¯­è¨€ï¼šC#</p>

<p>å®ç°æ€è·¯ï¼š</p>

<p>å°†Seatbelt.exeä½œbase64ç¼–ç åä¿å­˜åˆ°æ•°ç»„ä¸­ï¼Œå†ä½¿ç”¨Assembly.Load()ä½œbaseè§£ç åè¿›è¡ŒåŠ è½½ï¼Œæœ€åå‘Mainå‡½æ•°ä¼ å…¥å‚æ•°</p>

<p>å®ç°ä»£ç ï¼š</p>

<h4 id="1å°†seatbeltexeä½œbase64ç¼–ç å¹¶è¿”å›ç»“æœ">1.å°†Seatbelt.exeä½œbase64ç¼–ç å¹¶è¿”å›ç»“æœ</h4>

<p>c#å®ç°ä»£ç ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>using System;
using System.Reflection;
namespace TestApplication
{
    public class Program
    {
        public static void Main()
        {

            byte[] buffer = System.IO.File.ReadAllBytes("Seatbelt.exe");
            string base64str = Convert.ToBase64String(buffer);
            Console.WriteLine(base64str);
        }
    }
}
</code></pre></div></div>

<p>å¯ä»¥ä½¿ç”¨Visual Studioæˆ–è€…ç›´æ¥ä½¿ç”¨csc.exeè¿›è¡Œç¼–è¯‘</p>

<p>.Net 3.5ä¸‹ä½¿ç”¨csc.exeç¼–è¯‘çš„å‘½ä»¤ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Windows\Microsoft.NET\Framework64\v3.5\csc.exe base64.cs
</code></pre></div></div>

<p>.Net 4.0ä¸‹ä½¿ç”¨csc.exeç¼–è¯‘çš„å‘½ä»¤ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe base64.cs
</code></pre></div></div>

<p>ç¼–è¯‘æˆåŠŸåç”Ÿæˆbase64.exeï¼Œæ‰§è¡Œåè·å¾—å¯¹Seatbelt.exeä½œbase64ç¼–ç åçš„å­—ç¬¦ä¸²</p>

<h4 id="2ä½¿ç”¨assemblyloadä½œbaseè§£ç åè¿›è¡ŒåŠ è½½æœ€åå‘mainå‡½æ•°ä¼ å…¥å‚æ•°">2.ä½¿ç”¨Assembly.Load()ä½œbaseè§£ç åè¿›è¡ŒåŠ è½½ï¼Œæœ€åå‘Mainå‡½æ•°ä¼ å…¥å‚æ•°</h4>

<p>c#å®ç°ä»£ç ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>using System;
using System.Reflection;
namespace TestApplication
{
    public class Program
    {
        public static void Main(string[] args)
        {

            string base64str = "&lt;base64 string&gt;";

            byte[] buffer = Convert.FromBase64String(base64str);           
            object[] commands = args;
            Assembly assembly = Assembly.Load(buffer);   
            try
            {       
                assembly.EntryPoint.Invoke(null, new object[] { commands });
            }
            catch
            {
                MethodInfo method = assembly.EntryPoint;
                if (method != null)
                {
                    object o = assembly.CreateInstance(method.Name);                    
                    method.Invoke(o, null);
                }
            }
        }
    }
}
</code></pre></div></div>

<p>å°†Seatbelt.exeä½œbase64ç¼–ç åçš„å­—ç¬¦ä¸²æ›¿æ¢ä»¥ä¸Šä»£ç ä¸­çš„<code class="language-plaintext highlighter-rouge">&lt;base64 string&gt;</code></p>

<p>åŒæ ·ï¼Œä»¥ä¸Šä»£ç å¯ä»¥ä½¿ç”¨Visual Studioæˆ–è€…ç›´æ¥ä½¿ç”¨csc.exeè¿›è¡Œç¼–è¯‘</p>

<h2 id="0x04-ä½¿ç”¨execute-assemblyåŠ è½½seatbeltå¹¶ä¼ å…¥å‚æ•°çš„æ–¹æ³•">0x04 ä½¿ç”¨execute-assemblyåŠ è½½Seatbeltå¹¶ä¼ å…¥å‚æ•°çš„æ–¹æ³•</h2>
<hr />
<p>å®ç°è¯­è¨€ï¼šC++</p>

<p>å®ç°æ€è·¯ï¼š</p>

<p>å°†Seatbelt.exeçš„å†…å®¹ä¿å­˜åœ¨æ•°ç»„ä¸­ï¼Œè¯»å–åä½¿ç”¨<code class="language-plaintext highlighter-rouge">Load_3</code>(â€¦)åŠ è½½.NETç¨‹åºé›†ï¼Œæœ€åå‘Mainå‡½æ•°ä¼ å…¥å‚æ•°</p>

<p>ä¸ºäº†å»é™¤Seatbelt.exeçš„ç‰¹å¾ç ï¼Œå¯ä»¥å°†Seatbelt.exeä¸­é€ä¸ªå­—ç¬¦ä½œå¼‚æˆ–è¿ç®—åå†ä¿å­˜åˆ°æ•°ç»„ä¸­</p>

<p>è¿™é‡Œä½¿ç”¨<a href="https://github.com/etormadiv/HostingCLR">HostingCLR</a>ä½œä¸ºä»£ç å¼€å‘çš„æ¨¡æ¿</p>

<p><a href="https://github.com/etormadiv/HostingCLR">HostingCLR</a>çš„ä»£ç æœªè§£å†³å‚æ•°ä¼ é€’çš„é—®é¢˜ï¼Œæ— æ³•å‘.NETç¨‹åºé›†çš„Mainå‡½æ•°ä¼ å…¥å‚æ•°ï¼Œä»£ç ä½ç½®ï¼š</p>

<p>https://github.com/etormadiv/HostingCLR/blob/master/HostingCLR/HostingCLR.cpp#L218</p>

<p>æˆ‘çš„ä»£ç è§£å†³äº†å‚æ•°ä¼ é€’çš„é—®é¢˜ï¼Œå¹¶ä¸”é€šè¿‡å°†Seatbelt.exeä¸­é€ä¸ªå­—ç¬¦ä½œå¼‚æˆ–è¿ç®—åå†ä¿å­˜åˆ°æ•°ç»„ä¸­çš„æ–¹å¼å»é™¤Seatbelt.exeçš„ç‰¹å¾ç </p>

<p>å®ç°ä»£ç ï¼š</p>

<h4 id="1å°†exeæ–‡ä»¶ä¸­é€ä¸ªå­—ç¬¦ä½œå¼‚æˆ–è¿ç®—åå†ä¿å­˜ä¸ºæ–°çš„æ–‡ä»¶">1.å°†exeæ–‡ä»¶ä¸­é€ä¸ªå­—ç¬¦ä½œå¼‚æˆ–è¿ç®—åå†ä¿å­˜ä¸ºæ–°çš„æ–‡ä»¶</h4>

<p>c++å®ç°ä»£ç ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int main(int argc, char* argv[])
{
	if (argc != 3)
	{
		printf("File_XOR_generator\n");
		printf("Usage:\n");
		printf("%s &lt;file path&gt; &lt;XOR inputs&gt;\n", argv[0]);
		printf("Eg:\n");
		printf("%s test.exe 0x01\n", argv[0]);

		return 0;
	}

	int x;
	sscanf_s(argv[2], "%x", &amp;x);

	FILE* fp;
	int err = fopen_s(&amp;fp, argv[1], "ab+");
	if (err != 0)
	{
		printf("\n[!]Open file error");
		return 0;
	}
	fseek(fp, 0, SEEK_END);
	int len = ftell(fp);
	unsigned char *buf = new unsigned char[len];
	fseek(fp, 0, SEEK_SET);
	fread(buf, len, 1, fp);
	fclose(fp);
	printf("[*] file name:%s\n", argv[1]);
	printf("[*] file size:%d\n", len);

	for (int i = 0; i &lt; len; i++)
	{
		buf[i] = buf[i]^ x;
	}
	char strNew[256] = {0};
	snprintf(strNew, 256, "xor_%s", argv[1]);

	FILE* fp2;
	err = fopen_s(&amp;fp2, strNew, "wb+");
	if (err != 0)
	{
		printf("\n[!]createfile error!");
		return 0;
	}
	fwrite(buf, len, 1, fp2);
	fclose(fp2);	
	printf("[*] XOR file name:%s\n", strNew);
	printf("[*] XOR file size:%d\n", len);
}
</code></pre></div></div>

<p>è¿™é‡Œå°†Seatbelt.exeä¸­é€ä¸ªå­—ç¬¦åŒ<code class="language-plaintext highlighter-rouge">0x01</code>ä½œå¼‚æˆ–è¿ç®—ï¼Œå‘½ä»¤è¡Œå‚æ•°å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>File_XOR_generator.exe Seatbelt.exe 0x01
</code></pre></div></div>

<p>ç”Ÿæˆæ–‡ä»¶xor_Seatbelt.exe</p>

<p>ä½¿ç”¨<a href="https://mh-nexus.de/en/hxd/">hxd</a>æ‰“å¼€xor_Seatbelt.exe</p>

<p>å°†æ–‡ä»¶å†…å®¹å¤åˆ¶æˆCä»£ç çš„æ ¼å¼ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-8-11/2-1.png" alt="Alt text" /></p>

<h4 id="2ä½¿ç”¨load_3åŠ è½½netç¨‹åºé›†æœ€åå‘mainå‡½æ•°ä¼ å…¥å‚æ•°">2.ä½¿ç”¨<code class="language-plaintext highlighter-rouge">Load_3</code>(â€¦)åŠ è½½.NETç¨‹åºé›†ï¼Œæœ€åå‘Mainå‡½æ•°ä¼ å…¥å‚æ•°</h4>

<p>å®Œæ•´ä»£ç å·²ä¸Šä¼ è‡³githubï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/3gstudent/Homework-of-C-Language/blob/master/HostingCLR_with_arguments_XOR.cpp</p>

<p>åœ¨ä½¿ç”¨æ—¶éœ€è¦ä¿®æ”¹ä»£ç ä»¥ä¸‹ä½ç½®ï¼š</p>

<ul>
  <li>æ›¿æ¢æ•°ç»„rawDataä¸­çš„å†…å®¹</li>
  <li>å®šä¹‰mscorlibPathçš„è·¯å¾„</li>
  <li>å®šä¹‰runtimeVersionçš„ç‰ˆæœ¬</li>
</ul>

<p>ä»£ç ä¼šå¯¹æ•°ç»„rawDataä¸­çš„å†…å®¹é€ä¸ªå­—ç¬¦åŒ<code class="language-plaintext highlighter-rouge">0x01</code>ä½œå¼‚æˆ–è¿ç®—ï¼Œè¿˜åŸå‡ºSeatbelt.exeçš„æ–‡ä»¶å†…å®¹ï¼Œå†è¿›è¡ŒåŠ è½½å¹¶å‘Mainå‡½æ•°ä¼ å…¥å‚æ•°</p>

<p>ç¼–è¯‘åç”Ÿæˆæ–‡ä»¶HostingCLR_with_arguments_XOR.exeï¼Œæµ‹è¯•å‘½ä»¤å®ä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HostingCLR_with_arguments_XOR.exe -group=all
</code></pre></div></div>

<p>ä½¿ç”¨Process ExploreræŸ¥çœ‹è¿›ç¨‹HostingCLR_with_arguments_XOR.exeçš„<code class="language-plaintext highlighter-rouge">.NET Assemblies</code>é¡¹ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-8-11/3-1.png" alt="Alt text" /></p>

<p>èƒ½å¤Ÿè·å¾—.NETç¨‹åºé›†çš„åç§°</p>

<p>å¦‚æœæƒ³è¦éšè—.NETç¨‹åºé›†çš„åç§°ï¼Œéœ€è¦ç»•è¿‡ETWçš„æ£€æµ‹</p>

<h4 id="3ç»•è¿‡etwçš„æ£€æµ‹">3.ç»•è¿‡ETWçš„æ£€æµ‹</h4>

<p>è¿™é‡Œå‚è€ƒä»£ç https://github.com/outflanknl/TamperETW/</p>

<p>å¼•å…¥å…¶ä¸­ç»•è¿‡EWTçš„ä»£ç ï¼Œä»£ç å·²ä¸Šä¼ è‡³githubï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/3gstudent/Homework-of-C-Language/blob/master/HostingCLR_with_arguments_XOR_TamperETW.cpp</p>

<p>è¿™é‡Œè¿˜éœ€è¦æ·»åŠ asmæ–‡ä»¶<code class="language-plaintext highlighter-rouge">Syscalls.asm</code>ï¼Œå®ç°å¯¹æ±‡ç¼–æ–‡ä»¶çš„è°ƒç”¨</p>

<p>æ–°å»ºé¡¹ï¼Œé€‰æ‹©<code class="language-plaintext highlighter-rouge">C++æ–‡ä»¶</code>ï¼Œè¾“å…¥æ–‡ä»¶åSyscalls.asmï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.code

; Reference: https://j00ru.vexillium.org/syscalls/nt/64/

; Windows 7 SP1 / Server 2008 R2 specific syscalls

ZwProtectVirtualMemory7SP1 proc
		mov r10, rcx
		mov eax, 4Dh
		syscall
		ret
ZwProtectVirtualMemory7SP1 endp

ZwWriteVirtualMemory7SP1 proc
		mov r10, rcx
		mov eax, 37h
		syscall
		ret
ZwWriteVirtualMemory7SP1 endp

ZwReadVirtualMemory7SP1 proc
		mov r10, rcx
		mov eax, 3Ch
		syscall
		ret
ZwReadVirtualMemory7SP1 endp

; Windows 8 / Server 2012 specific syscalls

ZwProtectVirtualMemory80 proc
		mov r10, rcx
		mov eax, 4Eh
		syscall
		ret
ZwProtectVirtualMemory80 endp

ZwWriteVirtualMemory80 proc
		mov r10, rcx
		mov eax, 38h
		syscall
		ret
ZwWriteVirtualMemory80 endp

ZwReadVirtualMemory80 proc
		mov r10, rcx
		mov eax, 3Dh
		syscall
		ret
ZwReadVirtualMemory80 endp

; Windows 8.1 / Server 2012 R2 specific syscalls

ZwProtectVirtualMemory81 proc
		mov r10, rcx
		mov eax, 4Fh
		syscall
		ret
ZwProtectVirtualMemory81 endp

ZwWriteVirtualMemory81 proc
		mov r10, rcx
		mov eax, 39h
		syscall
		ret
ZwWriteVirtualMemory81 endp

ZwReadVirtualMemory81 proc
		mov r10, rcx
		mov eax, 3Eh
		syscall
		ret
ZwReadVirtualMemory81 endp

; Windows 10 / Server 2016 specific syscalls
 
ZwProtectVirtualMemory10 proc
		mov r10, rcx
		mov eax, 50h
		syscall
		ret
ZwProtectVirtualMemory10 endp

ZwWriteVirtualMemory10 proc
		mov r10, rcx
		mov eax, 3Ah
		syscall
		ret
ZwWriteVirtualMemory10 endp

ZwReadVirtualMemory10 proc
		mov r10, rcx
		mov eax, 3Fh
		syscall
		ret
ZwReadVirtualMemory10 endp

end
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p>Syscalls.asmçš„ä»£ç æ¥è‡ªäºhttps://github.com/outflanknl/TamperETW/blob/master/TamperETW/UnmanagedCLR/Syscalls.asm</p>

<p>Visual Studio2015åœ¨64ä½å¹³å°ä¸‹ä½¿ç”¨æ±‡ç¼–ä»£ç è¿˜éœ€è¦ä½œä»¥ä¸‹è®¾ç½®ï¼š</p>

<p>(1)é¼ æ ‡å³é”®é€‰ä¸­<code class="language-plaintext highlighter-rouge">å·¥ç¨‹</code>-&gt;<code class="language-plaintext highlighter-rouge">ç”Ÿæˆä¾èµ–é¡¹</code>(Build Dependencies)-&gt;<code class="language-plaintext highlighter-rouge">ç”Ÿæˆè‡ªå®šä¹‰</code>(Build Customizations)ï¼Œå‹¾é€‰<code class="language-plaintext highlighter-rouge">masm</code></p>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-8-11/3-2.png" alt="Alt text" /></p>

<p>(2)é¼ æ ‡å³é”®é€‰ä¸­æ–‡ä»¶<code class="language-plaintext highlighter-rouge">Syscalls.asm</code>-&gt;<code class="language-plaintext highlighter-rouge">å±æ€§</code>ï¼Œå°†<code class="language-plaintext highlighter-rouge">é¡¹ç±»å‹</code>(Item Type)è®¾ç½®ä¸º<code class="language-plaintext highlighter-rouge">Microsoft Macro Assembler</code></p>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-8-11/3-3.png" alt="Alt text" /></p>

<p>ç¼–è¯‘åç”Ÿæˆæ–‡ä»¶HostingCLR_with_arguments_XOR_TamperETW.exe</p>

<p>æµ‹è¯•å‘½ä»¤å®ä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HostingCLR_with_arguments_XOR_TamperETW.exe -group=all
</code></pre></div></div>

<p>ä½¿ç”¨Process ExploreræŸ¥çœ‹è¿›ç¨‹HostingCLR_with_arguments_XOR_TamperETW.exeçš„<code class="language-plaintext highlighter-rouge">.NET Assemblies</code>é¡¹ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-8-11/3-4.png" alt="Alt text" /></p>

<p>æˆåŠŸéšè—.NETç¨‹åºé›†çš„åç§°</p>

<h2 id="0x05-å°ç»“">0x05 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡ä»‹ç»äº†ä¸¤ç§é€šè¿‡å†…å­˜åŠ è½½Seatbeltçš„æ–¹æ³•(Assembly.Loadå’Œexecute-assembly)ï¼Œåˆ†åˆ«è¡¥å…¨å‘.NETç¨‹åºé›†çš„Mainå‡½æ•°ä¼ å…¥å‚æ•°çš„å®ç°ä»£ç ã€‚è§£å†³<a href="https://github.com/etormadiv/HostingCLR">HostingCLR</a>çš„å‚æ•°ä¼ é€’é—®é¢˜ï¼Œå¼•å…¥<a href="https://github.com/outflanknl/TamperETW/">TamperETW</a>çš„ä»£ç å®ç°äº†ç»•è¿‡ETWï¼Œä»‹ç»äº†Visual Studio2015åœ¨64ä½å¹³å°ä¸‹ä½¿ç”¨æ±‡ç¼–ä»£ç çš„æ–¹æ³•ã€‚</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET