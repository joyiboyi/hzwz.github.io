I"™><h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p>åœ¨ä¸Šç¯‡æ–‡ç« <a href="https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E5%88%A9%E7%94%A8GPO%E4%B8%AD%E7%9A%84%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C">ã€ŠåŸŸæ¸—é€â€”â€”åˆ©ç”¨GPOä¸­çš„è®¡åˆ’ä»»åŠ¡å®ç°è¿œç¨‹æ‰§è¡Œã€‹</a>ä»‹ç»äº†åˆ©ç”¨GPOä¸­çš„è®¡åˆ’ä»»åŠ¡å®ç°è¿œç¨‹æ‰§è¡Œçš„æ–¹æ³•ï¼Œåˆ†æåˆ©ç”¨æ€è·¯ï¼Œé€šè¿‡å‘½ä»¤è¡Œå®ç°äº†GPOå’Œè®¡åˆ’ä»»åŠ¡çš„åˆ›å»ºã€ä¿®æ”¹å’Œåˆ é™¤ã€‚</p>

<p>è¿™ç¯‡æ–‡ç« å°†è¦è¯¦ç»†ä»‹ç»å‘½ä»¤è¡Œå®ç°çš„åŸç†å’Œè„šæœ¬çš„å¼€å‘ç»†èŠ‚ï¼Œè®°å½•å®šä½é—®é¢˜å’Œè§£å†³é—®é¢˜çš„è¿‡ç¨‹ã€‚</p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<p>æœ¬æ–‡å°†è¦ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>å®šä½é—®é¢˜</li>
  <li>è§£å†³æ€è·¯</li>
  <li>è„šæœ¬å®ç°ç»†èŠ‚</li>
</ul>

<h2 id="0x02-å®šä½é—®é¢˜">0x02 å®šä½é—®é¢˜</h2>
<hr />

<p>æµ‹è¯•ç¯å¢ƒ:Windows Server 2008 R2</p>

<p>domain:test.com</p>

<h3 id="æµ‹è¯•1">æµ‹è¯•1</h3>

<p>é€šè¿‡Group Policy Management Console (GPMC) åˆ›å»ºGPOï¼Œæ·»åŠ è®¡åˆ’ä»»åŠ¡(Immediate Task)</p>

<p>æˆåŠŸå®ç°è®¡åˆ’ä»»åŠ¡çš„è¿œç¨‹æ‰§è¡Œ</p>

<h3 id="æµ‹è¯•2">æµ‹è¯•2ï¼š</h3>

<p>ä½¿ç”¨å‘½ä»¤è¡Œå®ç°åˆ›å»ºGPOå¹¶æ·»åŠ è®¡åˆ’ä»»åŠ¡(Immediate Task)ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>

<h4 id="1åˆ›å»ºä¸€ä¸ªgpo">1ã€åˆ›å»ºä¸€ä¸ªGPO</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>new-gpo -name TestGPO1 | new-gplink -Target "dc=test,dc=com"
</code></pre></div></div>

<p>GpoIdä¸º<code class="language-plaintext highlighter-rouge">d7dacd95-883c-402f-9238-9e2643f8f309</code>ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2018-11-24/2-1.png" alt="Alt text" /></p>

<h4 id="2åˆ›å»ºè®¡åˆ’ä»»åŠ¡çš„é…ç½®æ–‡ä»¶scheduledtasksxml">2ã€åˆ›å»ºè®¡åˆ’ä»»åŠ¡çš„é…ç½®æ–‡ä»¶ScheduledTasks.xml</h4>

<p>è·¯å¾„ä¸º:<code class="language-plaintext highlighter-rouge">\\test.com\SYSVOL\test.com\Policies\{D7DACD95-883C-402F-9238-9E2643F8F309}\User\Preferences\ScheduledTasks</code></p>

<p>ScheduledTasks.xmlçš„å†…å®¹å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ScheduledTasks clsid="{CC63F200-7309-4ba0-B154-A71CD118DBCC}"&gt;
&lt;ImmediateTaskV2 clsid="{9756B581-76EC-4169-9AFC-0CA8D43ADB5F}" name="debug" image="0" changed="2018-12-11 11:11:11" uid="{92272F3D-762C-460A-94FA-F3E3B9EBACF0}" userContext="0" removePolicy="0"&gt;
&lt;Properties action="C" name="debug" runAs="%LogonDomain%\%LogonUser%" logonType="InteractiveToken"&gt;
&lt;Task version="1.2"&gt;
&lt;RegistrationInfo&gt;
&lt;Author&gt;NT AUTHORITY\System&lt;/Author&gt;
&lt;Description/&gt;
&lt;/RegistrationInfo&gt;
&lt;Principals&gt;
&lt;Principal id="Author"&gt;
&lt;UserId&gt;%LogonDomain%\%LogonUser%&lt;/UserId&gt;
&lt;LogonType&gt;InteractiveToken&lt;/LogonType&gt;
&lt;RunLevel&gt;HighestAvailable&lt;/RunLevel&gt;
&lt;/Principal&gt;
&lt;/Principals&gt;
&lt;Settings&gt;
&lt;IdleSettings&gt;
&lt;Duration&gt;PT5M&lt;/Duration&gt;
&lt;WaitTimeout&gt;PT1H&lt;/WaitTimeout&gt;
&lt;StopOnIdleEnd&gt;false&lt;/StopOnIdleEnd&gt;
&lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;
&lt;/IdleSettings&gt;
&lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;
&lt;DisallowStartIfOnBatteries&gt;false&lt;/DisallowStartIfOnBatteries&gt;
&lt;StopIfGoingOnBatteries&gt;false&lt;/StopIfGoingOnBatteries&gt;
&lt;AllowHardTerminate&gt;false&lt;/AllowHardTerminate&gt;
&lt;StartWhenAvailable&gt;true&lt;/StartWhenAvailable&gt;
&lt;AllowStartOnDemand&gt;false&lt;/AllowStartOnDemand&gt;
&lt;Enabled&gt;true&lt;/Enabled&gt;
&lt;Hidden&gt;true&lt;/Hidden&gt;
&lt;ExecutionTimeLimit&gt;PT0S&lt;/ExecutionTimeLimit&gt;
&lt;Priority&gt;7&lt;/Priority&gt;
&lt;DeleteExpiredTaskAfter&gt;PT0S&lt;/DeleteExpiredTaskAfter&gt;
&lt;/Settings&gt;
&lt;Triggers&gt;
&lt;TimeTrigger&gt;
&lt;StartBoundary&gt;%LocalTimeXmlEx%&lt;/StartBoundary&gt;
&lt;EndBoundary&gt;%LocalTimeXmlEx%&lt;/EndBoundary&gt;
&lt;Enabled&gt;true&lt;/Enabled&gt;
&lt;/TimeTrigger&gt;
&lt;/Triggers&gt;
&lt;Actions&gt;
&lt;Exec&gt;
&lt;Command&gt;powershell&lt;/Command&gt;
&lt;Arguments&gt;-c "123 | Out-File C:\test\debug.txt"&lt;/Arguments&gt;
&lt;/Exec&gt;
&lt;/Actions&gt;
&lt;/Task&gt;
&lt;/Properties&gt;
&lt;/ImmediateTaskV2&gt;
&lt;/ScheduledTasks&gt;
</code></pre></div></div>

<h4 id="3é€šè¿‡group-policy-management-console-gpmc-æŸ¥çœ‹gpoçš„é…ç½®">3ã€é€šè¿‡Group Policy Management Console (GPMC) æŸ¥çœ‹GPOçš„é…ç½®</h4>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2018-11-24/2-2.png" alt="Alt text" /></p>

<p>å¯ä»¥å‘ç°ï¼Œåªè¦åˆ›å»ºæ–‡ä»¶ScheduledTasks.xmlï¼Œå°±å¯ä»¥åœ¨Group Policy Management Console (GPMC)ä¸­çš„Scheduled Tasksæ˜¾ç¤ºæ·»åŠ çš„è®¡åˆ’ä»»åŠ¡</p>

<p>ä½†æ˜¯ï¼Œæ­¤æ—¶å¹¶ä¸èƒ½å®ç°è®¡åˆ’ä»»åŠ¡çš„è¿œç¨‹æ‰§è¡Œ</p>

<p>ç»è¿‡ä»¥ä¸‹æ“ä½œè¯æ˜äº†è¿˜ç¼ºå°‘è®¡åˆ’ä»»åŠ¡çš„æ³¨å†Œæ“ä½œï¼š</p>

<p>è¿›å…¥Group Policy Management Console (GPMC)ä¸­çš„Scheduled Tasks</p>

<p>ä¿®æ”¹ä»»æ„ä¸€é¡¹é…ç½®</p>

<p>é€‰æ‹©Apply</p>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2018-11-24/2-3.png" alt="Alt text" /></p>

<p>å†æ¬¡æµ‹è¯•ï¼Œå‘ç°åˆ›å»ºçš„è®¡åˆ’ä»»åŠ¡èƒ½å¤Ÿå®ç°è¿œç¨‹æ‰§è¡Œ</p>

<h4 id="ç»“è®º">ç»“è®ºï¼š</h4>

<p>åˆ›å»ºè®¡åˆ’ä»»åŠ¡çš„é…ç½®æ–‡ä»¶<code class="language-plaintext highlighter-rouge">ScheduledTasks.xml</code>åï¼Œè¿˜éœ€è¦æ³¨å†Œæ“ä½œæ‰èƒ½ä½¿æ–°æ·»åŠ çš„Scheduled Tasksç”Ÿæ•ˆ</p>

<h2 id="0x03-è§£å†³æ€è·¯">0x03 è§£å†³æ€è·¯</h2>
<hr />

<p>GPOæ”¯æŒçš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>

<p>https://docs.microsoft.com/en-us/powershell/module/grouppolicy/?view=win10-ps</p>

<p>ç›®å‰ï¼Œæˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°å…³äºæ³¨å†Œè®¡åˆ’ä»»åŠ¡çš„æ–¹æ³•</p>

<p>ä½†æˆ‘æœ‰ä¸€äº›çŒœæµ‹ï¼š</p>

<p>å¤‡ä»½GPOçš„æ—¶å€™ä¼šä¸ä¼šä¿å­˜æ³¨å†Œä¿¡æ¯ï¼Ÿå¦‚æœä¼šï¼Œé‚£ä¹ˆå…ˆå¤‡ä»½GPOï¼Œå‘å¤‡ä»½æ–‡ä»¶ä¸­æ·»åŠ æ³¨å†Œä¿¡æ¯ï¼Œå†è¿˜åŸGPOï¼Œèƒ½å¦å˜ç›¸å®ç°GPOçš„æ³¨å†Œï¼Ÿ</p>

<p>å¼€å§‹æ¥ä¸‹æ¥çš„æµ‹è¯•ï¼š</p>

<h4 id="1å¤‡ä»½gpo">1ã€å¤‡ä»½GPO</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Backup-Gpo -Name TestGPO1 -Path C:\test
</code></pre></div></div>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2018-11-24/3-1.png" alt="Alt text" /></p>

<p>Idä¸º<code class="language-plaintext highlighter-rouge">28f36a77-298c-4b0a-a1c8-62832fd44cde</code>ï¼Œå¯¹åº”çš„æ–‡ä»¶å¤¹ä¸º<code class="language-plaintext highlighter-rouge">{28f36a77-298c-4b0a-a1c8-62832fd44cde}</code></p>

<p>æ–‡ä»¶å¤¹ä¸­çš„å†…å®¹å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2018-11-24/3-2.png" alt="Alt text" /></p>

<p>æ–‡ä»¶å¤¹<code class="language-plaintext highlighter-rouge">DomainSysvol</code>ä¸­çš„å†…å®¹åŒ<code class="language-plaintext highlighter-rouge">\\test.com\SYSVOL\test.com\Policies\{D7DACD95-883C-402F-9238-9E2643F8F309}</code>ä¸­çš„å†…å®¹ä¿æŒä¸€è‡´</p>

<p>çŒœæµ‹Backup.xmlå’Œgpreport.xmlä¿å­˜æœ‰è®¡åˆ’ä»»åŠ¡çš„æ³¨å†Œä¿¡æ¯</p>

<p>åˆ†åˆ«å¤‡ä»½æµ‹è¯•1å’Œæµ‹è¯•2çš„GPOï¼Œå¯¹æ¯”æ–‡ä»¶Backup.xmlå’Œgpreport.xml</p>

<h4 id="2æ¯”è¾ƒæ–‡ä»¶">2ã€æ¯”è¾ƒæ–‡ä»¶</h4>

<p>æ–‡ä»¶å­˜åœ¨å·®å¼‚ï¼Œä¸åŒçš„åœ°æ–¹å°±æ˜¯è®¡åˆ’ä»»åŠ¡çš„æ³¨å†Œä¿¡æ¯</p>

<p>å¯¹äºBackup.xmlï¼Œä¸åŒçš„ä½ç½®å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2018-11-24/3-3.png" alt="Alt text" /></p>

<p>æ ‡çº¢çš„éƒ¨åˆ†å°±æ˜¯è®¡åˆ’ä»»åŠ¡çš„æ³¨å†Œä¿¡æ¯</p>

<p>å¯¹äºgpreport.xmlï¼Œä¸åŒçš„ä½ç½®å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2018-11-24/3-4.png" alt="Alt text" /></p>

<p>æ ‡ç­¾<code class="language-plaintext highlighter-rouge">&lt;ExtensionData&gt;</code>ä¿å­˜æ³¨å†Œä¿¡æ¯(æœªæ³¨å†Œä¸å­˜åœ¨æ­¤æ ‡ç­¾)ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    &lt;ExtensionData&gt;
      &lt;Extension xmlns:q1="http://www.microsoft.com/GroupPolicy/Settings/ScheduledTasks" xsi:type="q1:ScheduledTasksSettings"&gt;
        &lt;q1:ScheduledTasks clsid="{CC63F200-7309-4ba0-B154-A71CD118DBCC}"&gt;
          &lt;q1:ImmediateTaskV2 clsid="{9756B581-76EC-4169-9AFC-0CA8D43ADB5F}" name="debug" image="0" changed="2018-11-11 11:11:11" uid="{C30BC793-8944-4332-97FF-9FDFCAB1191A}" userContext="0" removePolicy="0"&gt;
            &lt;q1:GPOSettingOrder&gt;1&lt;/q1:GPOSettingOrder&gt;
            &lt;q1:Properties action="C" name="debug" runAs="NT AUTHORITY\System" logonType="InteractiveToken"&gt;
              &lt;q1:Task version="1.2"&gt;
                &lt;q1:RegistrationInfo&gt;
                  &lt;q1:Author&gt;TEST\a&lt;/q1:Author&gt;
                  &lt;q1:Description /&gt;
                &lt;/q1:RegistrationInfo&gt;
                &lt;q1:Triggers&gt;
                  &lt;q1:TimeTrigger&gt;
                    &lt;q1:Enabled&gt;true&lt;/q1:Enabled&gt;
                    &lt;q1:StartBoundary&gt;%LocalTimeXmlEx%&lt;/q1:StartBoundary&gt;
                    &lt;q1:EndBoundary&gt;%LocalTimeXmlEx%&lt;/q1:EndBoundary&gt;
                  &lt;/q1:TimeTrigger&gt;
                &lt;/q1:Triggers&gt;
                &lt;q1:Settings&gt;
                  &lt;q1:AllowStartOnDemand&gt;false&lt;/q1:AllowStartOnDemand&gt;
                  &lt;q1:DisallowStartIfOnBatteries&gt;false&lt;/q1:DisallowStartIfOnBatteries&gt;
                  &lt;q1:StopIfGoingOnBatteries&gt;false&lt;/q1:StopIfGoingOnBatteries&gt;
                  &lt;q1:AllowHardTerminate&gt;false&lt;/q1:AllowHardTerminate&gt;
                  &lt;q1:StartWhenAvailable&gt;true&lt;/q1:StartWhenAvailable&gt;
                  &lt;q1:Enabled&gt;true&lt;/q1:Enabled&gt;
                  &lt;q1:Hidden&gt;true&lt;/q1:Hidden&gt;
                  &lt;q1:DeleteExpiredTaskAfter&gt;PT0S&lt;/q1:DeleteExpiredTaskAfter&gt;
                  &lt;q1:MultipleInstancesPolicy&gt;IgnoreNew&lt;/q1:MultipleInstancesPolicy&gt;
                  &lt;q1:Priority&gt;7&lt;/q1:Priority&gt;
                  &lt;q1:ExecutionTimeLimit&gt;PT0S&lt;/q1:ExecutionTimeLimit&gt;
                  &lt;q1:IdleSettings&gt;
                    &lt;q1:Duration&gt;PT5M&lt;/q1:Duration&gt;
                    &lt;q1:WaitTimeout&gt;PT1H&lt;/q1:WaitTimeout&gt;
                    &lt;q1:StopOnIdleEnd&gt;false&lt;/q1:StopOnIdleEnd&gt;
                    &lt;q1:RestartOnIdle&gt;false&lt;/q1:RestartOnIdle&gt;
                  &lt;/q1:IdleSettings&gt;
                &lt;/q1:Settings&gt;
                &lt;q1:Principals&gt;
                  &lt;q1:Principal id="Author"&gt;
                    &lt;q1:UserId&gt;NT AUTHORITY\System&lt;/q1:UserId&gt;
                    &lt;q1:LogonType&gt;InteractiveToken&lt;/q1:LogonType&gt;
                    &lt;q1:RunLevel&gt;HighestAvailable&lt;/q1:RunLevel&gt;
                  &lt;/q1:Principal&gt;
                &lt;/q1:Principals&gt;
                &lt;q1:Actions&gt;
                  &lt;q1:Exec&gt;
                    &lt;q1:Command&gt;powershell&lt;/q1:Command&gt;
                    &lt;q1:Arguments&gt;-c "123 | Out-File C:\test\debug.txt"&lt;/q1:Arguments&gt;
                  &lt;/q1:Exec&gt;
                &lt;/q1:Actions&gt;
              &lt;/q1:Task&gt;
            &lt;/q1:Properties&gt;
            &lt;q1:Filters /&gt;
          &lt;/q1:ImmediateTaskV2&gt;
        &lt;/q1:ScheduledTasks&gt;
      &lt;/Extension&gt;
      &lt;Name&gt;Scheduled Tasks&lt;/Name&gt;
    &lt;/ExtensionData&gt;
</code></pre></div></div>

<p>æ¥ä¸‹æ¥ï¼Œé€šè¿‡æµ‹è¯•æ¥éªŒè¯çŒœæµ‹</p>

<h3 id="æµ‹è¯•3">æµ‹è¯•3</h3>

<h4 id="1åˆ›å»ºä¸€ä¸ªgpo-1">1ã€åˆ›å»ºä¸€ä¸ªGPO</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>new-gpo -name TestGPO1 | new-gplink -Target "dc=test,dc=com"
</code></pre></div></div>

<h4 id="2å¤‡ä»½gpo">2ã€å¤‡ä»½GPO</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Backup-Gpo -Name TestGPO1 -Path C:\test
</code></pre></div></div>

<h4 id="3ä¿®æ”¹æ–‡ä»¶backupxmlå’Œgpreportxml">3ã€ä¿®æ”¹æ–‡ä»¶Backup.xmlå’Œgpreport.xml</h4>

<p>ä½ç½®ï¼š<code class="language-plaintext highlighter-rouge">C:\test\{&lt;Id&gt;}\</code></p>

<p>æ·»åŠ æ³¨å†Œä¿¡æ¯</p>

<h4 id="4åˆ›å»ºscheduledtasksxml">4ã€åˆ›å»ºScheduledTasks.xml</h4>

<p>ä½ç½®ï¼š<code class="language-plaintext highlighter-rouge">C:\test\{&lt;Id&gt;}\DomainSysvol\GPO\User\Preferences\ScheduledTasks</code></p>

<h4 id="5è¿˜åŸgpo">5ã€è¿˜åŸGPO</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Import-GPO -Name TestGPO1 -Path C:\test
</code></pre></div></div>

<p>æµ‹è¯•æˆåŠŸï¼Œï¼Œå®ç°è®¡åˆ’ä»»åŠ¡çš„è¿œç¨‹æ‰§è¡Œ</p>

<h2 id="0x04-è„šæœ¬å®ç°">0x04 è„šæœ¬å®ç°</h2>
<hr />

<p>æµç¨‹å¦‚ä¸‹ï¼š</p>

<ol>
  <li>å¤‡ä»½GPO</li>
  <li>ä¿®æ”¹æ–‡ä»¶Backup.xmlå’Œgpreport.xml</li>
  <li>åˆ›å»ºScheduledTasks.xml</li>
  <li>è¿˜åŸGPO</li>
</ol>

<p>ä½¿ç”¨powershellå®ç°ï¼Œåˆ›å»ºScheduledTasks.xmlè¿™éƒ¨åˆ†å‚è€ƒäº†harmj0yçš„ä»£ç ï¼š</p>

<p>https://github.com/PowerShellMafia/PowerSploit/blob/26a0757612e5654b4f792b012ab8f10f95d391c9/Recon/PowerView.ps1#L5907-L6122</p>

<p>æˆ‘æ·»åŠ äº†å¤‡ä»½GPOï¼Œä¿®æ”¹æ–‡ä»¶Backup.xmlå’Œgpreport.xmlä»¥åŠè¿˜åŸGPOçš„åŠŸèƒ½</p>

<p>éœ€è¦æ³¨æ„çš„ç»†èŠ‚ï¼š</p>

<h4 id="1å¤‡ä»½gpoæ—¶çš„å‘½ä»¤è¡Œç»“æœ">1ã€å¤‡ä»½GPOæ—¶çš„å‘½ä»¤è¡Œç»“æœ</h4>

<p><code class="language-plaintext highlighter-rouge">Id</code>å¯¹åº”ä¿å­˜çš„æ–‡ä»¶å¤¹åç§°ï¼Œ<code class="language-plaintext highlighter-rouge">GpoId</code>åœ¨Backup.xmlä¸­ä¼šç”¨åˆ°</p>

<h4 id="2ä¿®æ”¹æ–‡ä»¶backupxmlå’Œgpreportxmlçš„æ–¹æ³•">2ã€ä¿®æ”¹æ–‡ä»¶Backup.xmlå’Œgpreport.xmlçš„æ–¹æ³•</h4>

<p>ç”±äºæ·»åŠ çš„å†…å®¹è¾ƒå¤šï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰æŒ‰ç…§xmlçš„æ ¼å¼è¿›è¡Œæ·»åŠ </p>

<p>æˆ‘è¿™é‡Œå¤šæ¬¡ä½¿ç”¨äº†replaceæ–¹æ³•</p>

<p>å…ˆå®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²ä¿å­˜æ³¨å†Œä¿¡æ¯æ¨¡æ¿ï¼Œå†ç”¨replaceæ–¹æ³•æ›¿æ¢å¯¹åº”çš„å±æ€§å€¼</p>

<h4 id="3backupxmlä¸­çš„userextensionguidsæ ‡ç­¾">3ã€Backup.xmlä¸­çš„<code class="language-plaintext highlighter-rouge">&lt;UserExtensionGuids&gt;</code>æ ‡ç­¾</h4>

<p>æ·»åŠ è®¡åˆ’ä»»åŠ¡åï¼Œæ ‡ç­¾çš„å€¼å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;UserExtensionGuids&gt;&lt;![CDATA[[{00000000-0000-0000-0000-000000000000}{CAB54552-DEEA-4691-817E-ED4A4D1AFC72}][{AADCED64-746C-4633-A97C-D61349046527}{CAB54552-DEEA-4691-817E-ED4A4D1AFC72}]]]&gt;&lt;/UserExtensionGuids&gt;
</code></pre></div></div>

<p>å…¶ä¸­çš„guidå‡ä¸ºå›ºå®šå€¼</p>

<h4 id="4scheduledtasksxmlä¿å­˜çš„ä½ç½®">4ã€ScheduledTasks.xmlä¿å­˜çš„ä½ç½®</h4>

<p>æˆ‘çš„è„šæœ¬ä½¿ç”¨çš„ä½ç½®ä¸º<code class="language-plaintext highlighter-rouge">\GPO\User\Preferences\ScheduledTasks</code></p>

<p>ä¹Ÿå¯ä»¥ä½¿ç”¨å¦ä¸€ä½ç½®<code class="language-plaintext highlighter-rouge">GPO\Machine\Preferences\ScheduledTasks</code></p>

<h4 id="5è¿˜åŸgpoæ—¶éœ€è¦æŒ‡å®šid">5ã€è¿˜åŸGpoæ—¶éœ€è¦æŒ‡å®šId</h4>

<p>è¿™æ ·èƒ½é¿å…å½“å‰æ–‡ä»¶å¤¹å­˜åœ¨å¤šä¸ªå¤‡ä»½æ–‡ä»¶å¯¼è‡´è¿˜åŸå¤±è´¥çš„é—®é¢˜</p>

<h4 id="6è„šæœ¬åŠŸèƒ½">6ã€è„šæœ¬åŠŸèƒ½</h4>

<p>ç›®å‰è¯¥è„šæœ¬ä»…æ”¯æŒæ·»åŠ Immediate Taskï¼Œå‚ç…§è¿™ä¸ªè„šæœ¬çš„æ¨¡æ¿å¯ä»¥æ”¯æŒæ›´å¤šçš„åŠŸèƒ½</p>

<h4 id="7æ”¯æŒserver2008">7ã€æ”¯æŒServer2008</h4>

<p>Server2008é»˜è®¤Powershellç‰ˆæœ¬ä¸º2.0</p>

<p>ä¸æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$content = Get-Content 'C:\test\1.txt'
$content.replace('1','2')
</code></pre></div></div>

<p>è§£å†³æ–¹æ³•ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$content = [IO.file]::ReadAllText('C:\test\1.txt')
$content.replace('1','2')
</code></pre></div></div>

<h2 id="0x05-å°ç»“">0x05 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡è¯¦ç»†è®°å½•äº†å®šä½é—®é¢˜å’Œè§£å†³é—®é¢˜çš„è¿‡ç¨‹ï¼Œä»‹ç»äº†è„šæœ¬å¼€å‘çš„ç»†èŠ‚ï¼Œä¾¿äºè¯»è€…å¯¹è„šæœ¬åšæ–°çš„æ”¹è¿›ã€‚</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET