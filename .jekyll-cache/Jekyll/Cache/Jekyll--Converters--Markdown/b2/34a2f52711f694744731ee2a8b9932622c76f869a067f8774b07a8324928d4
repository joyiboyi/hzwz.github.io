I"Ç<<h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p>Autodiscoveræ˜¯Exchangeçš„ä¸€ä¸ªæœåŠ¡ï¼Œç”¨æ¥ç®€åŒ–å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºçš„é…ç½®æµç¨‹ã€‚ç”¨æˆ·åªéœ€è¦è¾“å…¥è‡ªå·±çš„ç”µå­é‚®ä»¶åœ°å€å’Œå¯†ç ï¼Œå°±èƒ½å¤Ÿé€šè¿‡AutodiscoveræœåŠ¡è·å–è¿è¡Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæ‰€éœ€çš„é…ç½®ä¿¡æ¯ã€‚</p>

<p>åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œå½“æˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªé‚®ä»¶ç”¨æˆ·çš„å‡­æ®ï¼Œèƒ½å¤Ÿé€šè¿‡AutodiscoveræœåŠ¡æŒ–æ˜å‡ºæ›´å¤šæœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚</p>

<p>æœ¬æ–‡å°†è¦ä»‹ç»é€šè¿‡AutodiscoveræœåŠ¡è¯»å–é…ç½®ä¿¡æ¯çš„æ–¹æ³•ï¼Œå¼€æºå®ç°ä»£ç ï¼Œåˆ†äº«åˆ©ç”¨æ€è·¯ã€‚</p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<p>æœ¬æ–‡å°†è¦ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>é€šè¿‡Autodiscoverè¿›è¡Œå£ä»¤çˆ†ç ´çš„æ–¹æ³•</li>
  <li>é€šè¿‡Autodiscoverè¯»å–é…ç½®ä¿¡æ¯çš„æ–¹æ³•</li>
  <li>é€šè¿‡Autodiscoverè®¿é—®Exchangeé‚®ä»¶èµ„æºçš„æ–¹æ³•</li>
</ul>

<h2 id="0x02-é€šè¿‡autodiscoverè¿›è¡Œå£ä»¤çˆ†ç ´çš„æ–¹æ³•">0x02 é€šè¿‡Autodiscoverè¿›è¡Œå£ä»¤çˆ†ç ´çš„æ–¹æ³•</h2>
<hr />

<p>å¯¹åº”çš„URLï¼š<code class="language-plaintext highlighter-rouge">https://&lt;domain&gt;/autodiscover/autodiscover.xml</code></p>

<p>éªŒè¯æ–¹å¼ï¼šNTLM Over HTTP Protocol(åˆ†åˆ«æ”¯æŒæ˜æ–‡å’ŒNTLM hashç™»å½•)</p>

<p>ç™»å½•å¤±è´¥è¿”å›401</p>

<p>ç™»å½•æˆåŠŸè¿”å›200ï¼Œå†…å®¹ç¤ºä¾‹:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/responseschema/2006"&gt;
  &lt;Response&gt;
    &lt;Error Time="01:37:11.6638388" Id="2403276782"&gt;
      &lt;ErrorCode&gt;600&lt;/ErrorCode&gt;
      &lt;Message&gt;Invalid Request&lt;/Message&gt;
      &lt;DebugData /&gt;
    &lt;/Error&gt;
  &lt;/Response&gt;
&lt;/Autodiscover&gt;
</code></pre></div></div>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒAutodiscoverçš„éªŒè¯æµç¨‹åŒEWSåŸºæœ¬ç›¸åŒï¼Œæ‰€ä»¥åœ¨ä»£ç å®ç°ä¸Šä¹Ÿå¯ä»¥å‚ç…§ä¹‹å‰çš„ä»£ç <a href="https://github.com/3gstudent/Homework-of-Python/blob/master/checkEWS.py">checkEWS.py</a></p>

<p>è¿™é‡Œä¸å†é‡å¤ä»‹ç»ï¼Œå…·ä½“ç»†èŠ‚å¯å‚è€ƒä¹‹å‰çš„æ–‡ç« ã€Šæ¸—é€æŠ€å·§â€”â€”Pass the Hash with Exchange Web Serviceã€‹</p>

<p>å®ç°ä»£ç å¯å‚ç…§<a href="https://github.com/3gstudent/Homework-of-Python/blob/master/checkAutodiscover.py">checkAutodiscover.py</a>ä¸­çš„checkautodiscoveråŠŸèƒ½</p>

<h2 id="0x03-é€šè¿‡autodiscoverè¯»å–é…ç½®ä¿¡æ¯çš„æ–¹æ³•">0x03 é€šè¿‡Autodiscoverè¯»å–é…ç½®ä¿¡æ¯çš„æ–¹æ³•</h2>
<hr />

<p>ç›´æ¥é€šè¿‡æµè§ˆå™¨è®¿é—®<code class="language-plaintext highlighter-rouge">https://&lt;domain&gt;/autodiscover/autodiscover.xml</code></p>

<p>æ— æ³•è·å¾—é…ç½®ä¿¡æ¯ï¼Œæµè§ˆå™¨è¿”å›çš„å†…å®¹ç¤ºä¾‹:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/responseschema/2006"&gt;
  &lt;Response&gt;
    &lt;Error Time="01:37:11.6638388" Id="2403276782"&gt;
      &lt;ErrorCode&gt;600&lt;/ErrorCode&gt;
      &lt;Message&gt;Invalid Request&lt;/Message&gt;
      &lt;DebugData /&gt;
    &lt;/Error&gt;
  &lt;/Response&gt;
&lt;/Autodiscover&gt;
</code></pre></div></div>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-7-17/2-1.png" alt="Alt text" /></p>

<p>ä¸ºäº†èƒ½å¤Ÿè¯»å–é…ç½®ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹æ“ä½œï¼š</p>

<p>1.å‘é€GETåŒ…ï¼ŒHeaderä¸­åŠ å…¥NTMLè®¤è¯ä¿¡æ¯ï¼Œç¤ºä¾‹ï¼š<code class="language-plaintext highlighter-rouge">Authorization: NTLM xxxxxxxxxxx</code></p>

<p>URLä¸º<code class="language-plaintext highlighter-rouge">/autodiscover/autodiscover.xml</code></p>

<p>æŒ‡å®šç¼–ç æ ¼å¼ä¸ºgzipï¼Œæ ¼å¼å¦‚ä¸‹:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Accept-Encoding: gzip
</code></pre></div></div>

<p>2.æ¥æ”¶è¿”å›ç»“æœ</p>

<p>æç¤º<code class="language-plaintext highlighter-rouge">401 Unauthorized</code></p>

<p>3.å‘é€POSTåŒ…</p>

<p>åœ¨Headerä¸­å®ŒæˆNTMLè®¤è¯ï¼ŒåŒæ—¶Headerè¿˜éœ€è¦é¢å¤–æ·»åŠ ä»¥ä¸‹ä¿¡æ¯(X-Anchormailbox)ï¼ŒæŒ‡å®šå½“å‰ç”¨æˆ·çš„é‚®ç®±åœ°å€ï¼Œç¤ºä¾‹ï¼š<code class="language-plaintext highlighter-rouge">X-Anchormailbox: test1@test.com</code></p>

<p>POSTçš„å†…å®¹æ ¼å¼å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/requestschema/2006"&gt;
&lt;Request&gt;&lt;EMailAddress&gt;{EMailAddress}&lt;/EMailAddress&gt;
&lt;AcceptableResponseSchema&gt;http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a&lt;/AcceptableResponseSchema&gt;
&lt;/Request&gt;&lt;/Autodiscover&gt;
</code></pre></div></div>

<p>å…¶ä¸­ï¼Œ<code class="language-plaintext highlighter-rouge">{EMailAddress}</code>ä¸ºå½“å‰ç”¨æˆ·çš„é‚®ç®±åœ°å€</p>

<p>å®Œæ•´æ•°æ®åŒ…ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /autodiscover/autodiscover.xml HTTP/1.1
Host: 192.168.1.1
Content-Length: 351
Authorization: NTLM TlRMTVNTUAADAAAAGAAYAHYAAACuAK4AjgAAABYAFgBAAAAACgAKAFYAAAAWABYAYAAAAAAAAAA8AQAABQKIoDEAOQAyAC4AMQA4ADgALgAxAC4AMQB0AGUAcwB0ADEAMQA5ADIALgAxADYAOAAuADEALgAxABlZOdtFpFcfJQY7ysotO0RJVlczdGVrae1Bq6PIhSQWZ5F4VJTTyL8BAQAAAAAAAOiYz4Q0XtYBSVZXM3Rla2kAAAAAAgAIAFQARQBTAFQAAQAGAEQAQwAxAAQAEABAAGUAcwB0AC5AYwBvAG0AAwAYAGQAYwAxAC5AdABlAHMAdAAuAGMAbwBtAAUAEAB0AGUAcwB0AC4AYwBvAG0ABwAIAOiYz3Q0XtYBCQAQAGMAaQBmAHMALwBEAEMAMQAAAAAAAAAAAA==
Content-type: text/xml
X-Anchormailbox: test1@test.com
X-Mapihttpcapability: 1
Accept-Encoding: gzip

&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/requestschema/2006"&gt;
&lt;Request&gt;&lt;EMailAddress&gt;test1@test.com&lt;/EMailAddress&gt;
&lt;AcceptableResponseSchema&gt;http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a&lt;/AcceptableResponseSchema&gt;
&lt;/Request&gt;&lt;/Autodiscover&gt;
</code></pre></div></div>

<p>4.æ¥æ”¶è¿”å›ç»“æœ</p>

<p>æç¤º<code class="language-plaintext highlighter-rouge">200 OK</code></p>

<p>è¿”å›çš„Bodyå†…å®¹ä¸ºgzipå‹ç¼©æ ¼å¼ï¼Œéœ€è¦è¿›è¡Œè§£ç </p>

<p>ä¸åŒç‰ˆæœ¬çš„Exchangeè·å¾—çš„å†…å®¹æœ‰æ‰€ä¸åŒï¼Œéƒ¨åˆ†é€šç”¨çš„å†…å®¹å¦‚ä¸‹ï¼š</p>

<ul>
  <li>DisplayName</li>
  <li>LegacyDN</li>
  <li>AutoDiscoverSMTPAddress</li>
</ul>

<p>å…¶ä¸­å€¼å¾—æ³¨æ„çš„æ˜¯<code class="language-plaintext highlighter-rouge">AD</code>ï¼Œä»£è¡¨åŸŸæ§åˆ¶å™¨çš„è®¡ç®—æœºåï¼Œåœ¨Exchange 2013åŠæ›´è€çš„ç‰ˆæœ¬èƒ½å¤Ÿè·å¾—<code class="language-plaintext highlighter-rouge">AD</code>çš„ä¿¡æ¯ï¼ŒExchange2016æ— æ³•è·å–</p>

<p>ä»¥ä¸Šçš„å®ç°ä»£ç å¯å‚ç…§<a href="https://github.com/3gstudent/Homework-of-Python/blob/master/checkAutodiscover.py">checkAutodiscover.py</a>ä¸­çš„checkautodiscoveråŠŸèƒ½</p>

<p>åœ¨ä¹‹å‰çš„æ–‡ç« ã€Šæ¸—é€æŠ€å·§â€”â€”é€šè¿‡Exchange ActiveSyncè®¿é—®å†…éƒ¨æ–‡ä»¶å…±äº«ã€‹ä»‹ç»äº†é€šè¿‡Exchange ActiveSyncè®¿é—®åŸŸå†…å…±äº«ç›®å½•SYSVOLçš„æ–¹æ³•ï¼Œè¿™é‡Œçš„è·¯å¾„éœ€è¦æŒ‡å®šåŸŸæ§åˆ¶å™¨çš„è®¡ç®—æœºå</p>

<p>æ­£ç¡®çš„å†™æ³•ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\\dc1\SYSVOL\test.com\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\GPT.INI
</code></pre></div></div>

<p>é”™è¯¯çš„å†™æ³•ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\\test.com\SYSVOL\test.com\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\GPT.INI
</code></pre></div></div>

<p>å°†ä»¥ä¸Šä¸¤ç‚¹è¿›è¡Œç»“åˆï¼Œå°±èƒ½å¤Ÿå®Œæ•´çš„å®ç°è¯»å–åŸŸå†…å…±äº«ç›®å½•SYSVOLçš„æ–‡ä»¶</p>

<p>ä¸ºäº†èƒ½å¤Ÿæ”¯æŒExchange2016ï¼Œè¿™é‡Œä»‹ç»ä¸€ç§æ›´ä¸ºé€šç”¨ï¼ˆæ”¯æŒæ‰€æœ‰ç‰ˆæœ¬ï¼‰è·å–åŸŸæ§åˆ¶å™¨è®¡ç®—æœºåçš„æ–¹æ³•ï¼šé€šè¿‡EWSè¯»å–å½“å‰ç”¨æˆ·çš„é…ç½®ä¿¡æ¯ï¼Œè¿›è€Œè·å¾—åŸŸæ§åˆ¶å™¨çš„è®¡ç®—æœºå</p>

<p>å‚è€ƒèµ„æ–™ï¼š</p>

<p>https://docs.microsoft.com/en-us/exchange/client-developer/exchange-web-services/how-to-get-user-settings-from-exchange-by-using-autodiscover</p>

<p>è¿™é‡Œéœ€è¦æ³¨æ„è¯·æ±‚çš„urlä¸º<code class="language-plaintext highlighter-rouge">/autodiscover/autodiscover.svc</code>ï¼Œè€Œä¸æ˜¯<code class="language-plaintext highlighter-rouge">/EWS/Exchange.asmx</code></p>

<p>å‘é€çš„SOAPæ ¼å¼ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;soap:Envelope xmlns:a="http://schemas.microsoft.com/exchange/2010/Autodiscover" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"&gt;
  &lt;soap:Header&gt;
    &lt;a:RequestedServerVersion&gt;Exchange2013_SP1&lt;/a:RequestedServerVersion&gt;
    &lt;wsa:Action&gt;http://schemas.microsoft.com/exchange/2010/Autodiscover/Autodiscover/GetUserSettings&lt;/wsa:Action&gt;
    &lt;wsa:To&gt;https://{domain}/autodiscover/autodiscover.svc&lt;/wsa:To&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body&gt;
    &lt;a:GetUserSettingsRequestMessage xmlns:a="http://schemas.microsoft.com/exchange/2010/Autodiscover"&gt;
      &lt;a:Request&gt;
        &lt;a:Users&gt;
          &lt;a:User&gt;
            &lt;a:Mailbox&gt;{mail}&lt;/a:Mailbox&gt;
          &lt;/a:User&gt;
        &lt;/a:Users&gt;
        &lt;a:RequestedSettings&gt;
          &lt;a:Setting&gt;UserDisplayName&lt;/a:Setting&gt;
          &lt;a:Setting&gt;UserDN&lt;/a:Setting&gt;
          &lt;a:Setting&gt;UserDeploymentId&lt;/a:Setting&gt;
          &lt;a:Setting&gt;InternalMailboxServer&lt;/a:Setting&gt;
          &lt;a:Setting&gt;MailboxDN&lt;/a:Setting&gt;
          &lt;a:Setting&gt;PublicFolderServer&lt;/a:Setting&gt;
          &lt;a:Setting&gt;ActiveDirectoryServer&lt;/a:Setting&gt;
          &lt;a:Setting&gt;ExternalMailboxServer&lt;/a:Setting&gt;
          &lt;a:Setting&gt;EcpDeliveryReportUrlFragment&lt;/a:Setting&gt;
          &lt;a:Setting&gt;EcpPublishingUrlFragment&lt;/a:Setting&gt;
          &lt;a:Setting&gt;EcpTextMessagingUrlFragment&lt;/a:Setting&gt;
          &lt;a:Setting&gt;ExternalEwsUrl&lt;/a:Setting&gt;
          &lt;a:Setting&gt;CasVersion&lt;/a:Setting&gt;
          &lt;a:Setting&gt;EwsSupportedSchemas&lt;/a:Setting&gt;
          &lt;a:Setting&gt;GroupingInformation&lt;/a:Setting&gt;
        &lt;/a:RequestedSettings&gt;
      &lt;/a:Request&gt;
    &lt;/a:GetUserSettingsRequestMessage&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</code></pre></div></div>

<p>è¿™é‡Œéœ€è¦æ³¨æ„<code class="language-plaintext highlighter-rouge">{domain}</code>å¿…é¡»ä¸ºåŸŸåï¼Œä¸èƒ½æ˜¯IP</p>

<p>è¿”å›çš„ç»“æœä¸­ï¼Œ<code class="language-plaintext highlighter-rouge">ActiveDirectoryServer</code>è¡¨ç¤ºåŸŸæ§åˆ¶å™¨çš„è®¡ç®—æœºåï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-7-17/2-2.png" alt="Alt text" /></p>

<p>å®ç°ä»£ç å¯å‚ç…§<a href="https://github.com/3gstudent/Homework-of-Python/blob/master/checkAutodiscover.py">checkAutodiscover.py</a>ä¸­çš„getusersettingåŠŸèƒ½</p>

<h2 id="0x04-é€šè¿‡autodiscoverè®¿é—®exchangeé‚®ä»¶èµ„æºçš„æ–¹æ³•">0x04 é€šè¿‡Autodiscoverè®¿é—®Exchangeé‚®ä»¶èµ„æºçš„æ–¹æ³•</h2>
<hr />

<p>é€šè¿‡Autodiscoverå®Œæˆèº«ä»½è®¤è¯ä»¥åï¼Œå¯ä»¥ä½¿ç”¨MAPI OVER HTTPè®¿é—®Exchangeé‚®ä»¶èµ„æº</p>

<p><strong>æ³¨ï¼š</strong></p>

<p>MAPI OVER HTTPæ˜¯OutlookåŒExchange2016ä¹‹é—´é»˜è®¤çš„é€šä¿¡åè®®</p>

<p>MAPI OVER HTTPæ˜¯Exchange Server 2013 Service Pack 1 (SP1)ä¸­å®ç°çš„æ–°ä¼ è¾“åè®®ï¼Œç”¨æ¥æ›¿ä»£RPC OVER HTTP(ä¹Ÿç§°ä½œOutlook Anywhere)</p>

<p>Exchange2013é»˜è®¤æ²¡æœ‰å¯ç”¨MAPI OVER HTTPï¼ŒOutlookåŒExchangeä¹‹é—´çš„é€šä¿¡åè®®ä½¿ç”¨RPC OVER HTTP</p>

<p>MAPI OVER HTTPçš„èµ„æ–™å¯å‚è€ƒï¼š</p>

<p>https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxcmapihttp/d502edcf-0b22-42f2-8500-019f00d60245</p>

<p>https://interoperability.blob.core.windows.net/files/MS-OXCMAPIHTTP/%5BMS-OXCMAPIHTTP%5D.pdf</p>

<p><a href="https://github.com/sensepost/ruler">ruler</a>ä¹Ÿæ”¯æŒMAPI OVER HTTPçš„éƒ¨åˆ†åŠŸèƒ½ï¼Œå¯ä»¥ä½œä¸ºå‚è€ƒ</p>

<h3 id="1æ‰§è¡Œå‘½ä»¤">1.æ‰§è¡Œå‘½ä»¤</h3>

<p>æµç¨‹ï¼š</p>

<ol>
  <li>connect</li>
  <li>execute</li>
  <li>disconnect</li>
</ol>

<h3 id="2é€šè¿‡offline-address-book-oabè¯»å–globaladdresslist">2.é€šè¿‡Offline Address Book (OAB)è¯»å–GlobalAddressList</h3>

<p>ä½¿ç”¨<a href="https://github.com/3gstudent/Homework-of-Python/blob/master/checkAutodiscover.py">checkAutodiscover.py</a></p>

<h4 id="1é€šè¿‡autodiscoverè·å¾—oaburl">(1)é€šè¿‡Autodiscoverè·å¾—OABUrl</h4>

<p>å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python checkAutodiscover.py 192.168.1.1 443 plaintext test1@test.com DomainUser123! checkautodiscover
</code></pre></div></div>

<p>ç»“æœå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-7-17/3-1.png" alt="Alt text" /></p>

<p>è·å¾—OABUrlä¸º<code class="language-plaintext highlighter-rouge">https://dc1.test.com/OAB/9e3fa457-ebf1-40e4-b265-21d09a62872b/</code></p>

<h4 id="2è®¿é—®oaburlä»ä¸­æ‰¾åˆ°default-global-addresså¯¹åº”çš„lzxæ–‡ä»¶å">(2)è®¿é—®OABUrlï¼Œä»ä¸­æ‰¾åˆ°Default Global Addresså¯¹åº”çš„lzxæ–‡ä»¶å</h4>

<p>å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python checkAutodiscover.py 192.168.1.1 443 plaintext test1@test.com DomainUser123! checkoab
</code></pre></div></div>

<p>ç»“æœå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-7-17/3-2.png" alt="Alt text" /></p>

<p>è·å¾—Default Global Addressä¸º<code class="language-plaintext highlighter-rouge">4667c322-5c08-4cda-844a-253ff36b4a6a-data-5.lzx</code></p>

<h4 id="3ä¸‹è½½lxzæ–‡ä»¶">(3)ä¸‹è½½lxzæ–‡ä»¶</h4>

<p>å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python checkAutodiscover.py 192.168.1.1 443 plaintext test1@test.com DomainUser123! downloadlzx
</code></pre></div></div>

<p>ç»“æœå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-7-17/3-3.png" alt="Alt text" /></p>

<h4 id="4å¯¹lxzæ–‡ä»¶è¿›è¡Œè§£ç ">(4)å¯¹lxzæ–‡ä»¶è¿›è¡Œè§£ç </h4>

<p>ä½¿ç”¨å·¥å…·<a href="https://github.com/kyz/libmspack">oabextract</a></p>

<p>ä¸‹è½½åéœ€è¦è¿›è¡Œå®‰è£…</p>

<p>ç¼–è¯‘å¥½å¯åœ¨Kaliä¸‹ç›´æ¥ä½¿ç”¨çš„ç‰ˆæœ¬ä¸‹è½½åœ°å€ï¼šhttp://x2100.icecube.wisc.edu/downloads/python/python2.6.Linux-x86_64.gcc-4.4.4/bin/oabextract</p>

<p>å°†lzxæ–‡ä»¶è½¬æ¢ä¸ºoabæ–‡ä»¶çš„å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oabextract 4667c322-5c08-4cda-844a-253ff36b4a6a-data-5.lzx gal.oab
</code></pre></div></div>

<p>æå–å‡ºGALçš„å‘½ä»¤ç¤ºä¾‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>strings gal.oab|grep SMTP
</code></pre></div></div>

<p>ç»“æœå¦‚å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2020-7-11/3-2.png" alt="Alt text" /></p>

<h2 id="0x05-å°ç»“">0x05 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡ä»‹ç»äº†é€šè¿‡Autodiscoverè¿›è¡Œå£ä»¤çˆ†ç ´ã€è¯»å–é…ç½®ä¿¡æ¯å’Œè®¿é—®Exchangeé‚®ä»¶èµ„æºçš„æ–¹æ³•ï¼Œå¼€æºå®ç°ä»£ç ï¼Œåˆ†äº«åˆ©ç”¨æ€è·¯ã€‚</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET